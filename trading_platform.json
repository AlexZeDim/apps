{
    "name": "Trading Platform",
    "data": [
        {
            "Name": "lots_block_info",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "If(GetVar(Id)){\r\n    DBFind(lots_blocks).Where(\"id=#Id#\").Vars(b)\r\n}\r\n\r\nIf(#b_id#>0){\r\n    If(GetVar(left_col)){}.Else{SetVar(left_col,\"col-md-3\")}\r\n    If(GetVar(right_col)){}.Else{SetVar(right_col,\"col-md-9\")}\r\n    Div(row){\r\n        Div(#left_col# mt-sm text-right){\r\n            Strong(\"Номер лота\")\r\n        }\r\n        Div(#right_col# text-left){\r\n            #b_lot_id#\r\n        }\r\n    }\r\n    Div(row){\r\n        Div(#left_col# mt-sm text-right){\r\n            Strong(\"Номер блока\")\r\n        }\r\n        Div(#right_col# text-left){\r\n            #b_block_id#\r\n        }\r\n    }\r\n    Div(row){\r\n        Div(#left_col# mt-sm text-right){\r\n            Strong(\"Время блока\")\r\n        }\r\n        Div(#right_col# text-left){\r\n            DateTime(#b_block_time#, Format: \"YYYY-MM-DD HH:MI:SS\")\r\n        }\r\n    }\r\n    Div(row){\r\n        Div(#left_col# mt-sm text-right){\r\n            Strong(\"Хэш\")\r\n        }\r\n        Div(#right_col# text-left){\r\n            #b_txhash#\r\n        }\r\n    }\r\n    Div(row){\r\n        Div(#left_col# mt-sm text-right){\r\n            Strong(\"Имя контракта\")\r\n        }\r\n        Div(#right_col# text-left){\r\n            #b_contract_name#\r\n        }\r\n    }\r\n    Div(row){\r\n        Div(#left_col# mt-sm text-right){\r\n            Strong(\"Параметры контракта\")\r\n        }\r\n        JsonToSource(params, #b_contract_params#)\r\n        Div(#right_col# text-left){\r\n            ForList(params){\r\n                Div(){\r\n                    Strong(#key#): #value#\r\n                }\r\n            }\r\n        }\r\n    }\r\n}.Else{\r\n    Div(){\r\n        Span(\"Не найдено\", text-muted)\r\n    }\r\n}",
            "Type": "blocks"
        },
        {
            "Name": "lots_count_block",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "If(GetVar(left_col)){}.Else{SetVar(left_col,\"col-md-3\")}\r\nIf(GetVar(right_col)){}.Else{SetVar(right_col,\"col-md-9\")}\r\nDiv(#left_col# mt-sm text-right){\r\n    Label(For:Count){LangRes(lots_count)}\r\n}\r\nIf(#isMobile# == 0){\r\n    Div(#right_col# text-left){\r\n        If(And(GetVar(TypeId),GetVar(lot_unit_count))){\r\n            Input(Name:Count, Type:number, Value:#lot_unit_count#)\r\n        }.ElseIf(GetVar(lot_unit_count)){\r\n            Div(mt-sm){\r\n                #lot_unit_count#\r\n            }\r\n        }.Else{\r\n            Input(Name:Count, Type:number)\r\n        }\r\n    }\r\n}\r\nIf(#isMobile# == 1){\r\n    Div(Class: form-group){\r\n        If(And(GetVar(TypeId),GetVar(lot_unit_count))){\r\n            Input(Name:Count, Type:number, Value:#lot_unit_count#)\r\n        }.ElseIf(GetVar(lot_unit_count)){\r\n            #lot_unit_count#\r\n        }.Else{\r\n            Input(Name:Count, Type:number)\r\n        }\r\n    }\r\n}",
            "Type": "blocks"
        },
        {
            "Name": "lots_dimensions_block",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "If(GetVar(left_col)){}.Else{SetVar(left_col,\"col-md-3\")}\r\nIf(GetVar(right_col)){}.Else{SetVar(right_col,\"col-md-9\")}\r\nIf(#lot_length_decimal#>#lot_length#){\r\n    SetVar(lot_length,#lot_length_decimal#)\r\n}\r\nIf(#lot_height_decimal#>#lot_height#){\r\n    SetVar(lot_height,#lot_height_decimal#)\r\n}\r\nIf(#lot_width_decimal#>#lot_width#){\r\n    SetVar(lot_width,#lot_width_decimal#)\r\n}\r\nIf(#isMobile# == 0){ \r\n    Div(Class: col-md-4 col-xs-4 mt-sm text-right text-bold){ \r\n        Span(){LangRes(lots_dimensions):} \r\n    }    \r\n}\r\nIf(#isMobile# == 1){\r\n    Div(Class: text-center text-bold){\r\n        Label(){LangRes(lots_dimensions)}\r\n    }\r\n}\r\n\r\nIf(#isMobile# == 0){\r\n    Div(Class: col-md-12 col-xs-12 text-center){\r\n        Div(row){\r\n            Div(Class: col-md-4 col-xs-4 mt-sm text-right text-bold){\r\n                Span(For:Length){LangRes(lots_length)}\r\n            }\r\n            Div(Class: col-md-8 col-xs-8 text-left){\r\n                If(And(GetVar(TypeId),GetVar(lot_length))){\r\n                    Input(Name:Length, Type:number, Value:#lot_length#)\r\n                }.ElseIf(GetVar(lot_length)){\r\n                    Div(Class: mt-sm){\r\n                        #lot_length#\r\n                    }\r\n                }.Else{\r\n                    Input(Name:Length, Type:number)\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nIf(#isMobile# == 1){\r\n    Div(Class: col-md-12 col-xs-12 text-center){\r\n        Div(Class: form-group){\r\n            Div(text-center){\r\n                Span(For:Length){LangRes(lots_length)}\r\n            }\r\n            Div(Class: text-center){\r\n                If(And(GetVar(TypeId),GetVar(lot_length))){\r\n                    Input(Name:Length, Type:number, Value:#lot_length#)\r\n                }.ElseIf(GetVar(lot_length)){\r\n                    #lot_length#\r\n                }.Else{\r\n                    Input(Name:Length, Type:number)\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nIf(#isMobile# == 0){\r\n    Div(Class: col-md-12 col-xs-12 text-center){\r\n        Div(row){\r\n            Div(Class: col-md-4 col-xs-4 mt-sm text-right text-bold){\r\n                Span(For:Height){LangRes(lots_height)}\r\n            }\r\n            Div(Class: col-md-8 col-xs-8 text-left){\r\n                If(And(GetVar(TypeId),GetVar(lot_height))){\r\n                    Input(Name:Height, Type:number, Value:#lot_height#)\r\n                }.ElseIf(GetVar(lot_height)){\r\n                    Div(mt-sm){\r\n                        #lot_height#\r\n                    }\r\n                }.Else{\r\n                    Input(Name:Height, Type:number)\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nIf(#isMobile# == 1){\r\n    Div(Class: col-md-12 col-xs-12 text-center){\r\n        Div(Class: form-group){\r\n            Div(text-center){\r\n                Span(For:Height){LangRes(lots_height)}\r\n            }\r\n            Div(text-center){\r\n                If(And(GetVar(TypeId),GetVar(lot_height))){\r\n                    Input(Name:Height, Type:number, Value:#lot_height#)\r\n                }.ElseIf(GetVar(lot_height)){\r\n                    #lot_height#\r\n                }.Else{\r\n                    Input(Name:Height, Type:number)\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nIf(#isMobile# == 0){\r\n    Div(Class: col-md-12 col-xs-12 text-center){\r\n        Div(Class: row){\r\n            Div(Class: col-md-4 col-xs-4 mt-sm text-right text-bold){\r\n                Span(For:Width){LangRes(lots_width)}\r\n            }\r\n            Div(Class: col-md-8 col-xs-8 text-left){\r\n                If(And(GetVar(TypeId),GetVar(lot_width))){\r\n                    Input(Name:Width, Type:number, Value:#lot_width#)\r\n                }.ElseIf(GetVar(lot_width)){\r\n                    Div(mt-sm){\r\n                        #lot_width#\r\n                    }\r\n                }.Else{\r\n                    Input(Name:Width, Type:number)\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nIf(#isMobile# == 1){\r\n    Div(Class: col-md-12 col-xs-12 text-center){\r\n        Div(Class: form-group){\r\n            Div(text-center){\r\n                Span(For:Width){LangRes(lots_width)}\r\n            }\r\n            Div(text-center){\r\n                If(And(GetVar(TypeId),GetVar(lot_width))){\r\n                    Input(Name:Width, Type:number, Value:#lot_width#)\r\n                }.ElseIf(GetVar(lot_width)){\r\n                    #lot_width#\r\n                }.Else{\r\n                    Input(Name:Width, Type:number)\r\n                }\r\n            }\r\n        }\r\n    }\r\n}",
            "Type": "blocks"
        },
        {
            "Name": "lots_weight2_block",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "If(GetVar(left_col)){}.Else{SetVar(left_col,\"col-md-3\")}\r\nIf(GetVar(right_col)){}.Else{SetVar(right_col,\"col-md-9\")}\r\nAppParam(App:#application_id#,Name:lots_weight_types, Source: weight_types)\r\nIf(#lot_weight_decimal#>#lot_weight#){\r\n    SetVar(lot_weight,#lot_weight_decimal#)\r\n}\r\nIf(#isMobile# == 0){\r\n    Div(#left_col# mt-sm text-right){\r\n        Label(For:Weight){LangRes(lots_weight)}\r\n    }\r\n    Div(#right_col# text-left){\r\n        Div(row){\r\n            If(And(GetVar(TypeId),GetVar(lot_weight))){\r\n                Div(col-sm-8){\r\n                    Input(Name:Weight, Type:number, Value:#lot_weight#)\r\n                }\r\n                Div(col-sm-4){\r\n                    Select(Name:WeightType, Source:weight_types, NameColumn:name, ValueColumn:id, Value:#lot_weight_type#)\r\n                }\r\n            }.ElseIf(GetVar(lot_weight)){\r\n                Div(col-sm-12 mt-sm){\r\n                    Span(#lot_weight#,mr-sm)\r\n                    AppParam(App:#application_id#,Name:lots_weight_types, Index: #lot_weight_type#)\r\n                }\r\n            }.Else{\r\n                Div(col-sm-8){\r\n                    Input(Name:Weight, Type:number)\r\n                }\r\n                Div(col-sm-4){\r\n                    Select(Name:WeightType, Source:weight_types, NameColumn:name, ValueColumn:id)\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nIf(#isMobile# == 1){\r\n    Div(Class: form-group){\r\n        Div(Class: text-bold text-center){\r\n            Label(For:Weight){LangRes(lots_weight)}\r\n        }\r\n        Div(Class: text-center){\r\n            If(And(GetVar(TypeId),GetVar(lot_weight))){\r\n                Input(Name:Weight, Type:number, Value:#lot_weight#)\r\n                Select(Name:WeightType, Source:weight_types, NameColumn:name, ValueColumn:id, Value:#lot_weight_type#)\r\n            }.ElseIf(GetVar(lot_weight)){\r\n                Span(#lot_weight#,mr-sm)\r\n                AppParam(App:#application_id#,Name:lots_weight_types, Index: #lot_weight_type#)\r\n            }.Else{\r\n                Input(Name:Weight, Type:number)\r\n                Select(Name:WeightType, Source:weight_types, NameColumn:name, ValueColumn:id)\r\n            }\r\n        }\r\n    }\r\n}",
            "Type": "blocks"
        },
        {
            "Name": "lots_weight_block",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "If(GetVar(left_col)){}.Else{SetVar(left_col,\"col-md-3 col-xs-3\")}\r\nIf(GetVar(right_col)){}.Else{SetVar(right_col,\"col-md-9 col-xs-9\")}\r\nData(weight_types, \"id,name\"){\r\n    1,$lots_kg$\r\n    2,$lots_ton$\r\n}\r\n\r\nIf(#lot_weight_decimal#>#lot_weight#){\r\n    SetVar(lot_weight,#lot_weight_decimal#)\r\n}\r\nIf(#isMobile# == 0){\r\n    Div(#left_col# mt-sm text-right){\r\n        Label(For:Weight){LangRes(lots_weight)}\r\n    }\r\n    Div(#right_col# text-left){\r\n        Div(row){\r\n            If(And(GetVar(TypeId),GetVar(lot_weight))){\r\n                Div(col-sm-4){\r\n                    Input(Name:Weight, Type:number, Value:#lot_weight#)\r\n                }\r\n                Div(col-sm-8){\r\n                    Select(Name:WeightType, Source:weight_types, NameColumn:name, ValueColumn:id, Value:#lot_weight_type#)\r\n                }\r\n            }.ElseIf(GetVar(lot_weight)){\r\n                Div(col-md-4 col-xs-4 mt-sm){\r\n                    Span(#lot_weight#, mr-sm)\r\n                    AppParam(App:#application_id#,Name:lots_weight_types, Index: #lot_weight_type#)\r\n                }\r\n            }.Else{\r\n                Div(col-sm-4){\r\n                    Input(Name:Weight, Type:number)\r\n                }\r\n                Div(col-sm-8){\r\n                    Select(Name:WeightType, Source:weight_types, NameColumn:name, ValueColumn:id)\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nIf(#isMobile# == 1){\r\n    Div(Class: form-group){\r\n        Div(text-bold text-center){\r\n            Label(For:Weight){LangRes(lots_weight)}\r\n        }\r\n        Div(text-center){\r\n            If(And(GetVar(TypeId),GetVar(lot_weight))){\r\n                Input(Name:Weight, Type:number, Value:#lot_weight#)\r\n                Select(Name:WeightType, Source:weight_types, NameColumn:name, ValueColumn:id, Value:#lot_weight_type#)\r\n            }.ElseIf(GetVar(lot_weight)){\r\n                Span(#lot_weight#)\r\n                AppParam(App:#application_id#,Name:lots_weight_types, Index: #lot_weight_type#)\r\n            }.Else{\r\n                Input(Name:Weight, Type:number)\r\n                Select(Name:WeightType, Source:weight_types, NameColumn:name, ValueColumn:id)\r\n            }\r\n        }\r\n    }\r\n}",
            "Type": "blocks"
        },
        {
            "Name": "default_menu",
            "Conditions": "ContractAccess(\"@1EditMenu\")",
            "Value": "MenuItem(Title:Профиль, Page:profile_view, Icon:\"icon-wallet\")\r\nMenuItem(Title:Торги, Page: lots_list, Icon:\"icon-list\")\r\nMenuItem(Title:Уведомления, Page:notifications_list, Icon:\"icon-flag\")\r\nIf(#role_id#==1){\r\n    MenuItem(Title:Пользователи, Page:members_list, Icon:\"fa icon-people\")\r\n    MenuItem(Title:Роли, Page:roles_list, Icon:\"fa fa-list-ul\")\r\n}\r\nIf(#isMobile#==1){\r\n    MenuItem(Title:Мои торги, Page:mobile_my_lots, Icon:\"icon-list\")\r\n}",
            "Type": "menu"
        },
        {
            "Name": "amount_final",
            "Trans": "{\"ru\":\"Цена\"}",
            "Type": "languages"
        },
        {
            "Name": "amount_starting",
            "Trans": "{\"ru\":\"Стартовая цена\"}",
            "Type": "languages"
        },
        {
            "Name": "buyer",
            "Trans": "{\"ru\":\"Покупатель\"}",
            "Type": "languages"
        },
        {
            "Name": "date_creation",
            "Trans": "{\n    \"ru\": \"Дата создания\"\n}",
            "Type": "languages"
        },
        {
            "Name": "editing_profile",
            "Trans": "{\"en\":\"Editing profile\",\"ru\":\"Редактирование профиля\"}",
            "Type": "languages"
        },
        {
            "Name": "lot_deleted",
            "Trans": "{\n    \"ru\": \"Лот удалён\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lot_edit",
            "Trans": "{\n    \"ru\": \"Редактировать\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lot_next",
            "Trans": "{\n    \"ru\": \"Далее\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_amount_max",
            "Trans": "{\n    \"ru\": \"Текущая максимальная сумма\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_back",
            "Trans": "{\n    \"ru\": \"Назад\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_bets",
            "Trans": "{\"ru\":\"Ставки\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_bid",
            "Trans": "{\n    \"ru\": \"Сделать ставку\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_bidding",
            "Trans": "{\"ru\":\"Открыты\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_cat",
            "Trans": "{\n    \"ru\": \"Категория\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_cat01",
            "Trans": "{\"ru\":\"Запорная арматура\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_cat02",
            "Trans": "{\"ru\":\"Трубная продукция\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_cat03",
            "Trans": "{\"ru\":\"Блочное и технологическое оборудование\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_cat04",
            "Trans": "{\"ru\":\"Нефтепромысловое оборудование\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_cat05",
            "Trans": "{\"ru\":\"Металлопрокат\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_cat06",
            "Trans": "{\"ru\":\"КИП и А\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_cat07",
            "Trans": "{\"ru\":\"Химическая продукция и сопутствующие материалы\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_cat08",
            "Trans": "{\"ru\":\"Кабельная продукция\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_cat09",
            "Trans": "{\"ru\":\"Транспорт\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_cat10",
            "Trans": "{\"ru\":\"Материалы административно-хозяйственного назначения\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_cat11",
            "Trans": "{\"ru\":\"Строительные материалы\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_cat12",
            "Trans": "{\"ru\":\"Спецодежда, СИЗ, противопожарное оборудование и материалы\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_cat13",
            "Trans": "{\"ru\":\"Прочее\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_close",
            "Trans": "{\"ru\":\"Закрыть\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_condition",
            "Trans": "{\n    \"ru\": \"Состояние\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_contract",
            "Trans": "{\n    \"ru\": \"Договор\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_count",
            "Trans": "{\n    \"ru\": \"Количество\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_create",
            "Trans": "{\n    \"ru\": \"Создать лот\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_date_end",
            "Trans": "{\n    \"ru\": \"Дата окончания торгов\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_date_start",
            "Trans": "{\n    \"ru\": \"Дата начала торгов\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_delete",
            "Trans": "{\n    \"ru\": \"Удалить лот\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_delete_auction",
            "Trans": "{\n    \"ru\": \"Вы действительно хотите удалить аукцион?\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_description",
            "Trans": "{\n    \"ru\": \"Описание\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_dimensions",
            "Trans": "{\n    \"ru\": \"Габариты\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_edit",
            "Trans": "{\n    \"ru\": \"Редактирование лота\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_height",
            "Trans": "{\n    \"ru\": \"Высота\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_kg",
            "Trans": "{\n    \"ru\": \"килограмм\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_length",
            "Trans": "{\n    \"ru\": \"Длина\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_list",
            "Trans": "{\n    \"ru\": \"Список лотов\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_liter",
            "Trans": "{\n    \"ru\": \"литр\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_location",
            "Trans": "{\n    \"ru\": \"Местонахождение\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_name",
            "Trans": "{\"ru\":\"Название лота\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_new",
            "Trans": "{\n    \"ru\": \"новое\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_no",
            "Trans": "{\n    \"ru\": \"Нет\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_not_found",
            "Trans": "{\n    \"ru\": \"Лоты не найдены\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_old",
            "Trans": "{\n    \"ru\": \"б/у\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_photo",
            "Trans": "{\n    \"ru\": \"Фотография\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_rejected",
            "Trans": "{\"ru\":\"Отклонен\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_save",
            "Trans": "{\n    \"ru\": \"Сохранить\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_select_cat",
            "Trans": "{\n    \"ru\": \"Выбор категории\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_select_type",
            "Trans": "{\n    \"ru\": \"Выбор вида\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_signed",
            "Trans": "{\"ru\":\"Закрыт\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_status",
            "Trans": "{\n    \"ru\": \"Статус\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_subscribe",
            "Trans": "{\n    \"ru\": \"Подписаться\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_ton",
            "Trans": "{\n    \"ru\": \"тонна\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_type",
            "Trans": "{\n    \"ru\": \"Вид\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_type01",
            "Trans": "{\"ru\":\"АРМАТУРА ПРОМЫШЛЕННАЯ ТРУБОПРОВОДНАЯ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type02",
            "Trans": "{\"ru\":\"ДЕТАЛИ ТРУБОПРОВОДОВ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type03",
            "Trans": "{\"ru\":\"ПРОДУКЦИЯ ТРУБНАЯ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type04",
            "Trans": "{\"ru\":\"З/Ч И КОМПЛЕКТУЮЩИЕ К ОБОР. ТЕХНОЛОГИЧ.\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type05",
            "Trans": "{\"ru\":\"ОБОРУДОВАНИЕ БЛОЧНОЕ НЕФТЕПРОМЫСЛОВОЕ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type06",
            "Trans": "{\"ru\":\"ОБОРУДОВАНИЕ ТЕХНОЛОГИЧЕСКОЕ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type07",
            "Trans": "{\"ru\":\"З/Ч К БУРОВОМУ ОБОРУДОВАНИЮ, ИНСТРУМЕНТУ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type08",
            "Trans": "{\"ru\":\"З/Ч К НЕФТЕПРОМЫСЛОВОМУ И ПОГРУЖ.ОБОРУД.\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type09",
            "Trans": "{\"ru\":\"ИНСТРУМЕНТ ЛОВИЛЬНЫЙ, КРС И З/Ч К НЕМУ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type10",
            "Trans": "{\"ru\":\"ОБОРУД-НИЕ И ИНСТР.БУРОВОЙ, ТЕХ.ОСНАСТКА\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type11",
            "Trans": "{\"ru\":\"ОБОРУД-НИЕ НЕФТЕПРОМЫСЛОВОЕ, НЕФТЕПОГРУЖ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type12",
            "Trans": "{\"ru\":\"ОБОРУДОВАНИЕ И ЗАПЧАСТИ ДЛЯ ГЕОФИЗИКИ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type13",
            "Trans": "{\"ru\":\"ЗАПЧАСТИ И КОМПЛЕКТУЮЩИЕ К ТЕХНИКЕ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type14",
            "Trans": "{\"ru\":\"МЕТАЛЛОИЗДЕЛИЯ ПРОМЫШЛЕННОГО НАЗНАЧЕНИЯ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type15",
            "Trans": "{\"ru\":\"ПРОКАТ ЦВЕТНЫХ МЕТАЛЛОВ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type16",
            "Trans": "{\"ru\":\"ПРОКАТ ЧЕРНЫХ МЕТАЛЛОВ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type17",
            "Trans": "{\"ru\":\"ОБЕСПЕЧЕНИЕ ПРОГРАММНОЕ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type18",
            "Trans": "{\"ru\":\"СРЕДСТВА АСУТП\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type19",
            "Trans": "{\"ru\":\"СРЕДСТВА КОММУНИКАЦИИ И СВЯЗИ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type20",
            "Trans": "{\"ru\":\"ПРИБОРЫ И СРЕДСТВА АВТОМАТИЗАЦИИ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type21",
            "Trans": "{\"ru\":\"ТЕХНИКА ВЫЧИСЛИТЕЛЬНАЯ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type22",
            "Trans": "{\"ru\":\"ОБОРУДОВАНИЕ, ПРИБОРЫ, ЛАБОРАТОРНЫЕ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type23",
            "Trans": "{\"ru\":\"ПОЛИМЕРЫ, ПЛАСТИЧ. МАССЫ, ХИМИЧ. ВОЛОКНА\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type24",
            "Trans": "{\"ru\":\"ПОСУДА, МАТЕРИАЛЫ ВСПОМ-НЫЕ ЛАБОРАТОРНЫЕ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type25",
            "Trans": "{\"ru\":\"РЕАКТИВЫ ХИМИЧЕСКИЕ ДЛЯ АНАЛИЗОВ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type26",
            "Trans": "{\"ru\":\"ХИМПРОДУКЦИЯ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type27",
            "Trans": "{\"ru\":\"ПРОДУКЦИЯ КАБЕЛЬНАЯ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type28",
            "Trans": "{\"ru\":\"ТЕХНИКА ТРАНСПОРТНАЯ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type29",
            "Trans": "{\"ru\":\"ИЗД. КУЛЬТУРНО-БЫТ. НАЗН. И ХОЗ. ОБИХОДА\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type30",
            "Trans": "{\"ru\":\"КАНЦТОВАРЫ, ОФИСНАЯ ТЕХН., ПРОД.БУМАЖНАЯ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type31",
            "Trans": "{\"ru\":\"МЕБЕЛЬ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type32",
            "Trans": "{\"ru\":\"ПРОДУКЦИЯ ПОЛИГРАФИЧЕСКОЙ ПРОМЫШЛЕННОСТИ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type33",
            "Trans": "{\"ru\":\"ИНСТРУМЕНТ, МАТЕРИАЛЫ АБРАЗИВНЫЕ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type34",
            "Trans": "{\"ru\":\"КРЕПЕЖНЫЕ ИЗДЕЛИЯ ОБЩЕМАШИНОСТРОИТЕЛЬН.\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type35",
            "Trans": "{\"ru\":\"МАТЕРИАЛЫ ОГНЕУП., ТЕРМОИЗОЛЯЦ., СТРОИТ.\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type36",
            "Trans": "{\"ru\":\"ОБОРУДОВАНИЕ ПРОТИВОПОЖАРНОЕ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type37",
            "Trans": "{\"ru\":\"СПЕЦОДЕЖДА, СПЕЦОБУВЬ И ДРУГИЕ СИЗ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type38",
            "Trans": "{\"ru\":\"СРЕДСТВА АВАРИЙНО-СПАСАТ. И МЕДИЦИНСКИЕ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type39",
            "Trans": "{\"ru\":\"МАШИНЫ ЭЛЕКТРИЧЕСКИЕ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type40",
            "Trans": "{\"ru\":\"ОБОРУД-ИЕ И МАТЕРИАЛЫ ЭЛЕКТРОТЕХНИЧЕСКИЕ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type41",
            "Trans": "{\"ru\":\"ЗАПЧАСТИ К ОБОРУДОВАНИЮ МЕХАНИЧЕСКОМУ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type42",
            "Trans": "{\"ru\":\"ОБОРУДОВАНИЕ МЕХАНИЧЕСКОЕ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type43",
            "Trans": "{\"ru\":\"ПОДШИПНИКИ КАЧЕНИЯ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type44",
            "Trans": "{\"ru\":\"ПРОДУКЦИЯ РЕЗИНОТЕХНИЧЕСКАЯ И АСБЕСТОВАЯ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_type45",
            "Trans": "{\"ru\":\"ПРОДУКЦИЯ ТЕКСТИЛЬН. - ТКАНИ И МАТЕРИАЛЫ\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_unsubscribe",
            "Trans": "{\"ru\":\"Отписаться\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_view",
            "Trans": "{\n    \"ru\": \"Просмотр лота\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_view_info",
            "Trans": "{\"ru\":\"Больше информации\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_waiting_approval",
            "Trans": "{\"ru\":\"Проверка\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_waiting_for_sign",
            "Trans": "{\"ru\":\"Подписание контракта\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_waiting_for_start",
            "Trans": "{\"ru\":\"Ожидание начала\"}",
            "Type": "languages"
        },
        {
            "Name": "lots_weight",
            "Trans": "{\n    \"ru\": \"Вес\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_width",
            "Trans": "{\n    \"ru\": \"Ширина\"\n}",
            "Type": "languages"
        },
        {
            "Name": "lots_yes",
            "Trans": "{\n    \"ru\": \"Да\"\n}",
            "Type": "languages"
        },
        {
            "Name": "no",
            "Trans": "{\"en\":\"No\",\"ru\":\"Нет\"}",
            "Type": "languages"
        },
        {
            "Name": "order_max",
            "Trans": "{\"ru\":\"Максимальный шаг\"}",
            "Type": "languages"
        },
        {
            "Name": "order_min",
            "Trans": "{\"ru\":\"Минимальный шаг\"}",
            "Type": "languages"
        },
        {
            "Name": "photo",
            "Trans": "{\n    \"ru\": \"Фото\"\n}",
            "Type": "languages"
        },
        {
            "Name": "platform_requests",
            "Trans": "{\"ru\":\"Запросы на регистрацию\"}",
            "Type": "languages"
        },
        {
            "Name": "platform_session",
            "Trans": "{\"ru\":\"Вы уже вошли как участник торгов!\"}",
            "Type": "languages"
        },
        {
            "Name": "platform_singup",
            "Trans": "{\"ru\":\"Регистрация\"}",
            "Type": "languages"
        },
        {
            "Name": "roles",
            "Trans": "{\"en\":\"Roles\",\"ru\":\"Роли\"}",
            "Type": "languages"
        },
        {
            "Name": "seller",
            "Trans": "{\"ru\":\"Продавец\"}",
            "Type": "languages"
        },
        {
            "Name": "show_all",
            "Trans": "{\"en\":\"Show all\",\"ru\":\"Показать всё\"}",
            "Type": "languages"
        },
        {
            "Name": "user_info",
            "Trans": "{\"en\":\"Member information\",\"ru\":\"Информация о пользователе\"}",
            "Type": "languages"
        },
        {
            "Name": "buyers",
            "Columns": "[{\"conditions\":\"true\",\"name\":\"buyer_id\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"rate_date\",\"type\":\"datetime\"},{\"conditions\":\"true\",\"name\":\"percentrate\",\"type\":\"money\"},{\"conditions\":\"true\",\"name\":\"amount\",\"type\":\"money\"},{\"conditions\":\"true\",\"name\":\"lot_id\",\"type\":\"number\"},{\"conditions\":\"ContractAccess(\\\"lots_Sign\\\")\",\"name\":\"status\",\"type\":\"number\"}]",
            "Permissions": "{\"insert\": \"true\", \"update\": \"true\", \"new_column\": \"true\"}",
            "Type": "tables"
        },
        {
            "Name": "cron_test",
            "Columns": "[{\"conditions\":\"true\",\"name\":\"ff\",\"type\":\"text\"},{\"conditions\":\"true\",\"name\":\"ts\",\"type\":\"number\"}]",
            "Permissions": "{\"insert\": \"ContractConditions(\\\"MainCondition\\\")\", \"update\": \"ContractConditions(\\\"MainCondition\\\")\", \"new_column\": \"ContractConditions(\\\"MainCondition\\\")\"}",
            "Type": "tables"
        },
        {
            "Name": "dep_user_list",
            "Columns": "[{\"conditions\":\"true\",\"name\":\"amount\",\"type\":\"money\"},{\"conditions\":\"true\",\"name\":\"lot_id\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"member_id\",\"type\":\"number\"}]",
            "Permissions": "{\"insert\": \"true\", \"update\": \"true\", \"new_column\": \"ContractConditions(\\\"MainCondition\\\")\"}",
            "Type": "tables"
        },
        {
            "Name": "lots",
            "Columns": "[{\"conditions\":\"true\",\"name\":\"contract_text\",\"type\":\"text\"},{\"conditions\":\"true\",\"name\":\"amount_starting\",\"type\":\"money\"},{\"conditions\":\"true\",\"name\":\"location\",\"type\":\"text\"},{\"conditions\":\"true\",\"name\":\"order_max\",\"type\":\"money\"},{\"conditions\":\"true\",\"name\":\"weight_decimal\",\"type\":\"double\"},{\"conditions\":\"true\",\"name\":\"photo\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"lots_type_id\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"category\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"buyer_pub\",\"type\":\"varchar\"},{\"conditions\":\"true\",\"name\":\"amount_max\",\"type\":\"money\"},{\"conditions\":\"true\",\"name\":\"buyer_sign\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"amount_final\",\"type\":\"money\"},{\"conditions\":\"true\",\"name\":\"date_creation\",\"type\":\"datetime\"},{\"conditions\":\"true\",\"name\":\"height\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"weight\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"height_decimal\",\"type\":\"double\"},{\"conditions\":\"true\",\"name\":\"length\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"date_sign\",\"type\":\"datetime\"},{\"conditions\":\"true\",\"name\":\"date_start\",\"type\":\"datetime\"},{\"conditions\":\"true\",\"name\":\"unit_count\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"type_bargain\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"name\",\"type\":\"text\"},{\"conditions\":\"true\",\"name\":\"buyer\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"date_end\",\"type\":\"datetime\"},{\"conditions\":\"true\",\"name\":\"width_decimal\",\"type\":\"double\"},{\"conditions\":\"true\",\"name\":\"width\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"deleted\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"condition\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"seller_pub\",\"type\":\"varchar\"},{\"conditions\":\"true\",\"name\":\"description\",\"type\":\"text\"},{\"conditions\":\"true\",\"name\":\"length_decimal\",\"type\":\"double\"},{\"conditions\":\"true\",\"name\":\"seller\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"status\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"map_location\",\"type\":\"json\"},{\"conditions\":\"true\",\"name\":\"contract_hash\",\"type\":\"varchar\"},{\"conditions\":\"true\",\"name\":\"contract_id\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"seller_sign\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"weight_type\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"comment\",\"type\":\"text\"},{\"conditions\":\"true\",\"name\":\"order_min\",\"type\":\"money\"}]",
            "Permissions": "{\"insert\": \"true\", \"update\": \"true\", \"new_column\": \"true\"}",
            "Type": "tables"
        },
        {
            "Name": "lots_blocks",
            "Columns": "[\n    {\n        \"conditions\": \"true\",\n        \"name\": \"block_id\",\n        \"type\": \"number\"\n    },\n    {\n        \"conditions\": \"true\",\n        \"name\": \"block_time\",\n        \"type\": \"number\"\n    },\n    {\n        \"conditions\": \"true\",\n        \"name\": \"txhash\",\n        \"type\": \"varchar\"\n    },\n    {\n        \"conditions\": \"true\",\n        \"name\": \"contract_name\",\n        \"type\": \"varchar\"\n    },\n    {\n        \"conditions\": \"true\",\n        \"name\": \"contract_params\",\n        \"type\": \"json\"\n    },\n    {\n        \"conditions\": \"true\",\n        \"name\": \"lot_id\",\n        \"type\": \"number\"\n    }\n]",
            "Permissions": "{\"insert\":\"true\",\"update\":\"true\",\"new_column\":\"true\"}",
            "Type": "tables"
        },
        {
            "Name": "lots_tracks",
            "Columns": "[{\"conditions\":\"true\",\"name\":\"key_id\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"lot_id\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"deleted\",\"type\":\"number\"}]",
            "Permissions": "{\"insert\": \"true\", \"update\": \"true\", \"new_column\": \"ContractConditions(\\\"MainCondition\\\")\"}",
            "Type": "tables"
        },
        {
            "Name": "lots_types",
            "Columns": "[{\"conditions\":\"true\",\"name\":\"deleted\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"category\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"lots_params\",\"type\":\"varchar\"},{\"conditions\":\"true\",\"name\":\"resource_name\",\"type\":\"varchar\"}]",
            "Permissions": "{\"insert\": \"true\", \"update\": \"true\", \"new_column\": \"true\"}",
            "Type": "tables"
        },
        {
            "Name": "platform_requests",
            "Columns": "[{\"conditions\":\"true\",\"name\":\"company_name\",\"type\":\"text\"},{\"conditions\":\"true\",\"name\":\"status\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"member_id\",\"type\":\"number\"},{\"conditions\":\"true\",\"name\":\"name_first\",\"type\":\"text\"},{\"conditions\":\"true\",\"name\":\"member_name\",\"type\":\"text\"},{\"conditions\":\"true\",\"name\":\"role\",\"type\":\"text\"},{\"conditions\":\"true\",\"name\":\"name_last\",\"type\":\"text\"},{\"conditions\":\"true\",\"name\":\"name_middle\",\"type\":\"text\"},{\"conditions\":\"true\",\"name\":\"company_position\",\"type\":\"text\"}]",
            "Permissions": "{\"insert\": \"ContractConditions(\\\"platform_Singup\\\")\", \"update\": \"ContractConditions(\\\"MainCondition\\\")\", \"new_column\": \"ContractConditions(\\\"MainCondition\\\")\"}",
            "Type": "tables"
        },
        {
            "Name": "bargain_type",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "Торг с повышением цен,Торг с фиксированной ценой",
            "Type": "app_params"
        },
        {
            "Name": "lots_categories",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "lots_cat01,lots_cat02,lots_cat03,lots_cat04,lots_cat05,lots_cat06,lots_cat07,lots_cat08,lots_cat09,lots_cat10,lots_cat11,lots_cat12,lots_cat13",
            "Type": "app_params"
        },
        {
            "Name": "lots_condition",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "lots_new,lots_old",
            "Type": "app_params"
        },
        {
            "Name": "lots_params",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "lots_dimensions_block,lots_weight_block,lots_weight2_block,lots_count_block",
            "Type": "app_params"
        },
        {
            "Name": "lots_status",
            "Conditions": "true",
            "Value": "lots_waiting_approval,lots_waiting_for_start,lots_bidding,lots_waiting_for_sign,lots_signed,lots_rejected",
            "Type": "app_params"
        },
        {
            "Name": "lots_status_classes",
            "Conditions": "true",
            "Value": "text-muted,text-warning,text-success,text-info,text-bold,text-danger",
            "Type": "app_params"
        },
        {
            "Name": "lots_weight_types",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "lots_kg,lots_ton,lots_liter",
            "Type": "app_params"
        },
        {
            "Name": "lots_blocks_list",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "SetVar(this_page,lots_blocks_list)\r\nSetVar(Where,\"id>0\")\r\nIf(GetVar(Search)){\r\n    SetVar(Where,\"lot_id='#Search#'\")\r\n}.Else{\r\n    SetVar(Search,)\r\n}\r\n\r\nIf(#Action#==\"info\"){\r\n    Include(lots_block_info)\r\n    Div(){\r\n        Button(Body: Назад, Page: #this_page#)\r\n    }\r\n}.Else{\r\n    Div(content-wrapper){\r\n        SetTitle(Просмотр истории блоков)\r\n\r\n        Form(panel panel-primary){\r\n            Div(panel-body){\r\n                Div(row){\r\n                    Div(col-md-12 col-xs-12){\r\n                        Div(input-group){\r\n                            Div(input-group-addon){\r\n                                \"Номер лота\"\r\n                            }\r\n                            Input(Name: Search, Type: number, Value: #Search#)\r\n                            Div(input-group-btn){\r\n                                Button(Class: btn btn-default, Page: #this_page#, PageParams: \"Search=Val(Search)\"){\r\n                                    Em(Class: fa fa-search)\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                DBFind(lots_blocks, src_blocks).Where(\"#Where#\").Count(blocks_count).Limit(25).Order(\"id DESC\").Custom(_hash){\r\n                    Button(Body: #txhash#, Page: #this_page#, Class: btn btn-link, PageParams: \"Id=#id#,Action=info\").Popup(50, \"Подробная информация\")\r\n                }\r\n                Div(row){\r\n                    Div(col-md-12){\r\n                        If(#blocks_count#>0){\r\n                            Div(table-responsive){\r\n                                Table(src_blocks)\r\n                            }\r\n                        }.Else{\r\n                            Div(text-center h3){\r\n                                Не найдено\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                If(GetVar(Search)){\r\n                    Div(row){\r\n                        Div(col-md-12 mt-lg){\r\n                            Div(text-center){\r\n                                Button(Body: LangRes(show_all), Class: btn btn-primary, Page: #this_page#)\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }.Style(\r\n                th,td {text-align:center;}\r\n                .img-circle {height: 30px;width: 30px; border: 1px solid #5A5D63;}\r\n                .center {display:flex; align-items:center;}\r\n                .photo {height: 80px; max-width: 120px;}\r\n            )\r\n        }\r\n    }\r\n}",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "lots_edit",
            "Conditions": "true",
            "Value": "DBFind(applications).Columns(\"id\").Where(\"name='Trading Platform' AND deleted=0\").Vars(application)\r\nSetVar(title, $lots_create$).(name,).(description,).(amount_starting,).(order_min,).(order_max,).(date_start,).(date_end,).(time_start,).(time_end,).(contract_text,).(unit_count,).(weight,).(weight_type,).(length,).(width,).(height,).(condition,)\r\nSetVar(location,`{\"zoom\":8, \"center\":{\"lat\":55.452376,\"lng\":37.372236}}`)\r\nDBFind(buffer_data).Where(\"member_id=#key_id# and key='last_uploaded_image'\").Columns(\"value->id,value->lot_id\").Vars(image)\r\nIf(#image_value_id#>0){\r\n    SetVar(PhotoId,#image_value_id#)\r\n}.Else{\r\n    SetVar(PhotoId,0)\r\n}\r\nIf(#lot_length_decimal#>#lot_length#){\r\n    SetVar(lot_length,#lot_length_decimal#)\r\n}\r\nIf(#lot_height_decimal#>#lot_height#){\r\n    SetVar(lot_height,#lot_height_decimal#)\r\n}\r\nIf(#lot_width_decimal#>#lot_width#){\r\n    SetVar(lot_width,#lot_width_decimal#)\r\n}\r\nAppParam(App:#application_id#,Name:lots_weight_types, Source: weight_types)\r\nIf(#lot_weight_decimal#>#lot_weight#){\r\n    SetVar(lot_weight,#lot_weight_decimal#)\r\n}\r\nData(weight_types, \"id,name\"){\r\n    1,$lots_kg$\r\n    2,$lots_ton$\r\n}\r\n\r\nSetVar(Action,\"create\").(BtnBody,LangRes(lots_create))\r\nIf(GetVar(Id)){\r\n    SetVar(Action,\"edit\").(BtnBody,LangRes(lots_save))\r\n\r\n    DBFind(lots, src_lots).Where(\"id=#Id#\").Vars(lot)\r\n    SetVar(title, $lots_edit$)\r\n    SetVar(name, #lot_name#)\r\n    SetVar(description, #lot_description#)\r\n    SetVar(amount_starting, Money(#lot_amount_starting#))\r\n    SetVar(order_min, Money(#lot_order_min#))\r\n    SetVar(order_max, Money(#lot_order_max#))\r\n    SetVar(date_start, DateTime(#lot_date_start#, YYYY-MM-DD))\r\n    SetVar(date_end, DateTime(#lot_date_end#, YYYY-MM-DD))\r\n    SetVar(time_start, DateTime(#lot_date_start#, HH:MI))\r\n    SetVar(time_end, DateTime(#lot_date_end#, HH:MI))\r\n    SetVar(contract_text,Binary().ById(#lot_contract_id#))\r\n    SetVar(unit_count,#lot_unit_count#)\r\n    SetVar(weight,#lot_weight#)\r\n    SetVar(weight_type,#lot_weight_type#)\r\n    SetVar(length,#lot_length#)\r\n    SetVar(width,#lot_width#)\r\n    SetVar(height,#lot_height#)\r\n    SetVar(location,#lot_map_location#)\r\n    SetVar(condition,#lot_condition#)\r\n    SetVar(type_bargain,#lot_type_bargain#)\r\n    SetVar(TypeId,#lot_lots_type_id#)\r\n    SetVar(CatId,#lot_category#)\r\n    If(#image_value_lot_id#==#Id#){}.Else{\r\n        SetVar(PhotoId,#lot_photo#)\r\n    }\r\n}.Else{\r\n    SetVar(Id,)\r\n}\r\n\r\nDiv(content-wrapper){\r\n    If(GetVar(TypeId)){\r\n        SetTitle(#title#)\r\n        Div(breadcrumb){\r\n            LinkPage($lots_list$, lots_list)\r\n            Span(/,mh)\r\n            Span(Class: text-muted, Body: #title#)\r\n        }\r\n\r\n        Div(row){\r\n            Div(col-sm-10 col-sm-offset-1 col-lg-8 col-lg-offset-2){\r\n                Form(panel panel-primary){\r\n                    DBFind(lots_types,src_type).Where(\"deleted=0 and id=#TypeId#\").Vars(type)\r\n\r\n                    Div(panel-heading){#title#}\r\n                    Div(panel-body){\r\n                        If(GetVar(Id)) {\r\n                            Input(Name: Id, Type: hidden, Value: #Id#)\r\n                        }\r\n                        Div(form-group){\r\n                            Div(list-group-item){\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-3 col-xs-3 mt-sm text-right){\r\n                                        Strong(LangRes(lots_cat))\r\n                                    }\r\n                                    Div(col-md-9 text-left mt-sm){\r\n                                        AppParam(App: #application_id#, Name: lots_categories, Index: #CatId#)\r\n                                    }\r\n                                }\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-3 col-xs-3 mt-sm text-right){\r\n                                        Strong(LangRes(lots_type))\r\n                                    }\r\n                                    Div(col-md-9 text-left mt-sm){\r\n                                        ForList(src_type){\r\n                                            LangRes(#resource_name#)\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        Div(form-group){\r\n                            Div(list-group-item){\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-3 col-xs-3 mt-sm text-right){\r\n                                        Label(For: Photo){LangRes(lots_photo)}\r\n                                    }\r\n                                    Div(col-md-9 text-left){\r\n                                        If(#PhotoId#>0){\r\n                                            Image(Src:Binary().ById(#PhotoId#), Class: big_photo)\r\n                                        }.Else{\r\n                                            Image(Src:\"\", Class: hidden)\r\n                                        }\r\n                                        Div(mt-sm){\r\n                                            SetVar(textUpload,\"Загрузить изображение\")\r\n                                            If(#PhotoId#>0){\r\n                                                SetVar(textUpload,\"Загрузить другое изображение\")\r\n                                            }\r\n                                            Button(Body: #textUpload#, Page: lots_upload_photo, Class: btn btn-link p0 #hiddenFirst#, PageParams: \"Id=#Id#,TypeId=#TypeId#,CatId=#CatId#\").Popup(45, \"Загрузка изображения\")\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        If(#isMobile# == 0){\r\n                            Div(list-group-item){\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-3 col-xs-3 mt-sm text-right){\r\n                                        Label(For: Name){LangRes(lots_name)}\r\n                                    }\r\n                                    Div(col-md-9 text-left){\r\n                                        Input(Name: Name, Value: #name#)\r\n                                    }\r\n                                }\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-3 col-xs-3 mt-lg text-right){\r\n                                        Label(For: Description){LangRes(lots_description)}\r\n                                    }\r\n                                    Div(col-md-9 text-left){\r\n                                        Input(Name: Description, Type: textarea, Value: #description#)\r\n                                    }\r\n                                }\r\n                                If(#lot_contract_id#>0){\r\n                                    Div(row mt-sm){\r\n                                        Div(col-md-3 col-xs-3 mt-sm text-right){\r\n                                            Label(For: LotContract){LangRes(lots_contract)}\r\n                                        }\r\n                                        Div(col-md-9 mt-sm text-left){\r\n                                            #contract_text#\r\n                                        }\r\n                                    }\r\n                                }\r\n\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-3 col-xs-3 mt-sm text-right){\r\n                                        Label(For:Location){LangRes(lots_location)}\r\n                                    }\r\n                                    Div(col-md-9 text-left){\r\n                                        InputMap(Type:polygon, Name: Location, Value: #location#, MapType:satellite)\r\n                                    }\r\n                                }\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-3 col-xs-3 mt-lg text-right){\r\n                                        Label(For:Condition){LangRes(lots_condition)}\r\n                                    }\r\n                                    Div(col-md-9 text-left){\r\n                                        AppParam(App:#application_id#, Name:lots_condition, Source:src_condition)\r\n                                        RadioGroup(Name: Condition, Value:#condition#, ValueColumn: id, NameColumn: name, Source: src_condition)\r\n                                    }\r\n                                }\r\n                                ArrayToSource(type_blocks, [#type_lots_params#])\r\n                                Div(row mt-sm){\r\n                                    ForList(type_blocks){\r\n                                        SetVar(block,AppParam(App:#application_id#, Name:lots_params, Index:#value#))\r\n                                        If(#block#==\"lots_count_block\"){\r\n                                            Include(lots_count_block)\r\n                                        }.ElseIf(#block#==\"lots_dimensions_block\"){\r\n                                            Include(lots_dimensions_block)\r\n                                        }.ElseIf(#block#==\"lots_weight_block\"){\r\n                                            Include(lots_weight_block)\r\n                                        }.ElseIf(#block#==\"lots_weight2_block\"){\r\n                                            Include(lots_weight2_block)\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                            Div(list-group-item){\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-3 col-xs-3 mt-sm text-right){\r\n                                        Label(For: DateStart){LangRes(lots_date_start)}\r\n                                    }\r\n                                    Div(col-md-9 text-left){\r\n                                        Div(row){\r\n                                            Div(col-md-6){\r\n                                                Input(Name: DateStart, Type: date, Value: #date_start#)\r\n                                            }\r\n                                            Div(col-md-6){\r\n                                                Input(Name: TimeStart, Type: time, Value: #time_start#)\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-3 col-xs-3 mt-sm text-right){\r\n                                        Label(For: DateEnd){LangRes(lots_date_end)}\r\n                                    }\r\n                                    Div(col-md-9 text-left){\r\n                                        Div(row){\r\n                                            Div(col-md-6){\r\n                                                Input(Name: DateEnd, Type: date, Value: #date_end#)\r\n                                            }\r\n                                            Div(col-md-6){\r\n                                                Input(Name: TimeEnd, Type: time, Value: #time_end#)\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                            Div(list-group-item){\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-3 col-xs-3 mt-lg text-right){\r\n                                        Label(For:){\"Тип торга\"}\r\n                                    }\r\n                                    Div(col-md-9 text-left){\r\n                                        AppParam(App:#application_id#, Name:bargain_type, Source:src_bargain_type)\r\n                                        RadioGroup(Name:TypeBargain,Value:#type_bargain#,NameColumn:name,ValueColumn:id,Source: src_bargain_type)\r\n                                    }\r\n                                }\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-3 col-xs-3 mt-sm text-right){\r\n                                        Label(For: AmountStarting){LangRes(amount_starting)}\r\n                                    }\r\n                                    Div(col-md-9 text-left){\r\n                                        Input(Name: AmountStarting, Type: number, Value: #amount_starting#)\r\n                                    }\r\n                                }\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-3 col-xs-3 mt-sm text-right){\r\n                                        Label(For: OrderMin){LangRes(order_min)}\r\n                                        P(Class: text-muted,Body: \"Только для торгов с повышением цен\"\r\n                                    }\r\n                                    Div(col-md-9 text-left){\r\n                                        Input(Name: OrderMin, Type: number, Value: #order_min#)\r\n                                    }.Style(padding-top:20px;)\r\n                                }\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-3 col-xs-3  mt-sm text-right){\r\n                                        Label(For: OrderMax){LangRes(order_max)}\r\n                                        P(Class: text-muted,Body: \"Только для торгов с повышением цен\"\r\n                                    }\r\n                                    Div(col-md-9 text-left){\r\n                                        Input(Name: OrderMax, Type: number, Value: #order_max#)\r\n                                    }.Style(padding-top:20px;)\r\n                                }\r\n                            }\r\n                        }\r\n                        If(#isMobile# == 1){\r\n                            Div(form-group){\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-12 col-xs-12 text-center text-bold){\r\n                                        Label(For: Name){LangRes(lots_name)}\r\n                                    }\r\n                                    Div(col-md-12 col-xs-12 text-center){\r\n                                        Input(Name: Name, Value: #name#)\r\n                                    }\r\n                                }\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-12 col-xs-12 text-center text-bold){\r\n                                        Label(For: Description){LangRes(lots_description)}\r\n                                    }\r\n                                    Div(col-md-12 col-xs-12 text-center){\r\n                                        Input(Name: Description, Type: textarea, Value: #description#)\r\n                                    }\r\n                                }\r\n                                If(#lot_contract_id#>0){\r\n                                    Div(row mt-sm){\r\n                                        Div(col-md-12 col-xs-12 text-center text-bold){\r\n                                            Label(For: LotContract){LangRes(lots_contract)}\r\n                                        }\r\n                                        Div(col-md-12 col-xs-12 text-center){\r\n                                            #contract_text#\r\n                                        }\r\n                                    }\r\n                                }\r\n\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-12 col-xs-12 text-center text-bold){\r\n                                        Label(For:Location){LangRes(lots_location)}\r\n                                    }\r\n                                    Div(col-md-12 col-xs-12 text-center){\r\n                                        InputMap(Type:polygon, Name: Location, Value: #location#, MapType:satellite)\r\n                                    }\r\n                                }\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-12 col-xs-12 text-center text-bold){\r\n                                        Label(For:Condition){LangRes(lots_condition)}\r\n\r\n                                    }\r\n                                    Div(col-md-12 col-xs-12 text-center){\r\n                                        AppParam(App:#application_id#, Name:lots_condition, Source:src_condition)\r\n                                        RadioGroup(Name: Condition, Value:#condition#, ValueColumn: id, NameColumn: name, Source: src_condition)\r\n                                    }\r\n                                }\r\n                                If(#isMobile# == 0){\r\n                                    ArrayToSource(type_blocks, [#type_lots_params#])\r\n                                    ForList(type_blocks){\r\n                                        Div(row mt-sm){\r\n                                            Div(col-md-12 col-xs-12 text-center){\r\n                                                SetVar(block,AppParam(App:#application_id#, Name:lots_params, Index:#value#))\r\n                                                If(#block#==\"lots_count_block\"){\r\n                                                    Include(lots_count_block)\r\n                                                }.ElseIf(#block#==\"lots_dimensions_block\"){\r\n                                                    Include(lots_dimensions_block)\r\n                                                }.ElseIf(#block#==\"lots_weight_block\"){\r\n                                                    Include(lots_weight_block)\r\n                                                }.ElseIf(#block#==\"lots_weight2_block\"){\r\n                                                    Include(lots_weight2_block)\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                                If(#isMobile# == 1){\r\n                                    Div(row mt-sm){\r\n                                        Div(Class: form-group){\r\n                                            If(And(GetVar(TypeId),GetVar(lot_unit_count))){\r\n                                                Input(Name:Count, Type:number, Value:#lot_unit_count#)\r\n                                            }.ElseIf(GetVar(lot_unit_count)){\r\n                                                #lot_unit_count#\r\n                                            }.Else{\r\n                                                Input(Name:Count, Type:number)\r\n                                            }\r\n                                        }\r\n                                        Div(Class: text-center text-bold){\r\n                                            Label(){LangRes(lots_dimensions)}\r\n                                        }\r\n                                        Div(Class: col-md-12 col-xs-12 text-center){\r\n                                            Div(Class: form-group){\r\n                                                Div(text-center){\r\n                                                    Span(For:Length){LangRes(lots_length)}\r\n                                                }\r\n                                                Div(Class: text-center){\r\n                                                    If(And(GetVar(TypeId),GetVar(lot_length))){\r\n                                                        Input(Name:Length, Type:number, Value:#lot_length#)\r\n                                                    }.ElseIf(GetVar(lot_length)){\r\n                                                        #lot_length#\r\n                                                    }.Else{\r\n                                                        Input(Name:Length, Type:number)\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                         Div(Class: col-md-12 col-xs-12 text-center){\r\n                                            Div(Class: form-group){\r\n                                                Div(text-center text-bold){\r\n                                                    Span(For:Width){LangRes(lots_width)}\r\n                                                }\r\n                                                Div(text-center){\r\n                                                    If(And(GetVar(TypeId),GetVar(lot_width))){\r\n                                                        Input(Name:Width, Type:number, Value:#lot_width#)\r\n                                                    }.ElseIf(GetVar(lot_width)){\r\n                                                        #lot_width#\r\n                                                    }.Else{\r\n                                                        Input(Name:Width, Type:number)\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                        Div(Class: form-group){\r\n                                            Div(Class: text-bold text-center){\r\n                                                Label(For:Weight){LangRes(lots_weight)}\r\n                                            }\r\n                                            Div(Class: text-center){\r\n                                                If(And(GetVar(TypeId),GetVar(lot_weight))){\r\n                                                    Input(Name:Weight, Type:number, Value:#lot_weight#)\r\n                                                    Select(Name:WeightType, Source:weight_types, NameColumn:name, ValueColumn:id, Value:#lot_weight_type#)\r\n                                                }.ElseIf(GetVar(lot_weight)){\r\n                                                    Span(#lot_weight#,mr-sm)\r\n                                                    AppParam(App:#application_id#,Name:lots_weight_types, Index: #lot_weight_type#)\r\n                                                }.Else{\r\n                                                    Input(Name:Weight, Type:number)\r\n                                                    Select(Name:WeightType, Source:weight_types, NameColumn:name, ValueColumn:id)\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                        Div(Class: form-group){\r\n                                            Div(text-bold text-center){\r\n                                                Label(For:Weight){LangRes(lots_weight)}\r\n                                            }\r\n                                            Div(text-center){\r\n                                                If(And(GetVar(TypeId),GetVar(lot_weight))){\r\n                                                    Input(Name:Weight, Type:number, Value:#lot_weight#)\r\n                                                    Select(Name:WeightType, Source:weight_types, NameColumn:name, ValueColumn:id, Value:#lot_weight_type#)\r\n                                                }.ElseIf(GetVar(lot_weight)){\r\n                                                    Span(#lot_weight#)\r\n                                                    AppParam(App:#application_id#,Name:lots_weight_types, Index: #lot_weight_type#)\r\n                                                }.Else{\r\n                                                    Input(Name:Weight, Type:number)\r\n                                                    Select(Name:WeightType, Source:weight_types, NameColumn:name, ValueColumn:id)\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                            Div(form-group){\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-12 col-xs-12 text-center text-bold){\r\n                                        Label(For: DateStart){LangRes(lots_date_start)}\r\n                                    }\r\n                                    Div(col-md-12 col-xs-12 text-center){\r\n                                        Input(Name: DateStart, Type: date, Value: #date_start#)\r\n                                        Input(Name: TimeStart, Type: time, Value: #time_start#)\r\n                                    }\r\n                                    \r\n                                }\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-12 col-xs-12 text-center text-bold){\r\n                                        Label(For: DateEnd){LangRes(lots_date_end)}\r\n                                    }\r\n                                    Div(col-md-12 col-xs-12 text-center){\r\n                                        Input(Name: DateEnd, Type: date, Value: #date_end#)\r\n                                        Input(Name: TimeEnd, Type: time, Value: #time_end#)\r\n                                    }\r\n                                }\r\n                            }\r\n                            Div(form-group){\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-12 col-xs-12 text-center){\r\n                                        Label(For:){\"Тип торга\"}\r\n                                        AppParam(App:#application_id#, Name:bargain_type, Source:src_bargain_type)\r\n                                        RadioGroup(Name:TypeBargain,Value:#type_bargain#,NameColumn:name,ValueColumn:id,Source: src_bargain_type)\r\n                                    }\r\n                                }\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-12 col-xs-12 text-center){\r\n                                        Label(For: AmountStarting){LangRes(amount_starting)}\r\n                                        Input(Name: AmountStarting, Type: number, Value: #amount_starting#)\r\n                                    }\r\n                                }\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-12 col-xs-12 mt-sm text-right){\r\n                                        Label(For: OrderMin){LangRes(order_min)}\r\n                                        P(Class: text-muted,Body: \"Только для торгов с повышением цен\"\r\n                                    }\r\n                                    Div(col-md-12 text-left){\r\n                                        Input(Name: OrderMin, Type: number, Value: #order_min#)\r\n                                    }.Style(padding-top:20px;)\r\n                                }\r\n                                Div(row mt-sm){\r\n                                    Div(col-md-12 col-xs-12  mt-sm text-right){\r\n                                        Label(For: OrderMax){LangRes(order_max)}\r\n                                        P(Class: text-muted,Body: \"Только для торгов с повышением цен\"\r\n                                    }\r\n                                    Div(col-md-12 text-left){\r\n                                        Input(Name: OrderMax, Type: number, Value: #order_max#)\r\n                                    }.Style(padding-top:20px;)\r\n                                }\r\n                            }\r\n                        }\r\n                        Div(panel-footer text-left){\r\n                            Div(Class: col-xs-12){\r\n                                If(GetVar(Id)){\r\n                                    If(And(#image_value_id#>0,#image_value_lot_id#==#Id#)){\r\n                                        Button(Body: $lots_back$, Class: btn btn-default btn-block, Page: lots_list, Contract: @1buffer_Manager, Params: \"Action=clean,Key=last_uploaded_image\")\r\n                                    }.Else{\r\n                                        Button(Body: $lots_back$, Class: btn btn-default btn-block, Page: lots_list)\r\n                                    }\r\n                                }.Else{\r\n                                    Button(Body: $lots_back$, Class: btn btn-default btn-block, Page: lots_edit, PageParams: \"CatId=#CatId#\").Popup(Width: 45, Header: \"Выбор вида\")\r\n                                }\r\n                                Button(Body: #BtnBody#, Class: btn btn-primary btn-block pull-right, Contract: lots_SellerAction, Page: lots_list, Params: \"Action=#Action#,TypeId=#TypeId#,PhotoId=#PhotoId#\")\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }.Else{\r\n        If(GetVar(CatId)){\r\n            SetVar(Cat,AppParam(App: #application_id#, Name: lots_categories, Index: #CatId#))\r\n            DBFind(lots_types,src_types).Where(\"deleted=0 and category=#CatId#\")\r\n            Div(text-center form-group){\r\n                ForList(src_types){\r\n                    Button(Body: LangRes(#resource_name#), Class: btn btn-primary btn-block mr-sm mb-sm, Page: lots_edit, PageParams: \"TypeId=#id#,CatId=#CatId#\")\r\n                }\r\n            }\r\n            Div(text-left){\r\n                Button(Body: $lots_back$, Class: btn btn-default, Page: lots_edit).Popup(Width: 45, Header: \"Выбор категории\")\r\n            }\r\n        }.Else{\r\n            AppParam(App: #application_id#, Name: lots_categories, Source: src_cats)\r\n            Div(text-center form-group){\r\n                ForList(src_cats){\r\n                    Button(Body: #name#, Class: btn btn-primary btn-block mr-sm mb-sm, Page: lots_edit, PageParams: \"CatId=#id#\").Popup(Width: 45, Header: \"Выбор вида\")\r\n                }\r\n            }\r\n            Div(text-left){\r\n                Button(Body: $lots_back$, Class: btn btn-default, Page: lots_list)\r\n            }\r\n        }\r\n    }\r\n}.Style(\r\n    .big_photo {height: 300px; max-width: 100%;}\r\n)",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "lots_list",
            "Conditions": "true",
            "Value": "DBFind(applications).Columns(\"id\").Where(\"name='Trading Platform' AND deleted=0\").Vars(application)\r\nDBFind(roles).Where(\"id=#role_id#\").Columns(\"role_name\").Vars(r)\r\nSetTitle(Торги)\r\nIf(#isMobile# == 1){\r\n    Div(Class: list-group-item){\r\n        Button(Body: Dev Button, Class: btn btn-primary, Page: testtest)\r\n    }\r\n    Div(Class: list-group-item){\r\n        Button(Body: Dev Button 2, Class: btn btn-primary, Page: lots_mobile)\r\n    }\r\n    Div(Class: list-group-item){\r\n        Button(Body: Обновить список лотов, Class: btn btn-primary, Page: lots_list)\r\n    }\r\n}\r\n\r\nDiv(content-wrapper){\r\n    Span(){\r\n        If(#isMobile# == 0){\r\n            If(#r_role_name#==\"Seller\"){\r\n                Button(Body: Em(Class:icon-plus) $lots_create$, Page: lots_edit, Class: btn btn-link pull-right).Popup(Width: 50, Header: \"Выбор категории\")  \r\n            }\r\n        }\r\n    }\r\n    SetVar(Where,\"deleted=0\").(rejected_status,5)\r\n    If(GetVar(Search)){\r\n        If(GetVar(Status)){\r\n            SetVar(Where,\"deleted=0 and name='#Search#' and status=#Status#\")\r\n        }.Else{\r\n            SetVar(Where,\"deleted=0 and name='#Search#'\")\r\n        }\r\n    }.Else{\r\n        If(GetVar(Status)){\r\n            SetVar(Where,\"deleted=0 and status=#Status#\")\r\n        }\r\n        SetVar(Search,)\r\n    }\r\n    \r\n    Div(text-right){\r\n        Data(status_icons, \"Icon\"){\r\n            fa fa-hourglass-start\r\n            fa fa-hourglass-half\r\n            fa fa-hourglass-end\r\n            fa fa-check\r\n            fa fa-times\r\n        }\r\n\r\n        If(#isMobile# == 0){\r\n            If(GetVar(Status)!=\"\"){\r\n                Button(Class: fa fa-times mr-sm btn bg-danger, Page: lots_list)\r\n            }\r\n            ForList(status_icons){\r\n                SetVar(status,Calculate(#status_icons_index#))\r\n                If(#Status#==#status#){\r\n                    Button(Class: #Icon# mr-sm btn bg-gray-lighter, Page: lots_list, PageParams: \"Status=#status#,Search=#Search#\")\r\n                }.Else{\r\n                    Button(Class: #Icon# mr-sm btn bg-gray, Page: lots_list, PageParams: \"Status=#status#,Search=#Search#\")\r\n                }\r\n            }\r\n        }.Else{\r\n            Div(Class: form-group){ \r\n                Div(Class: row){\r\n                    Div(Class: list-group-item){\r\n                        Div(Class: text-center){ \r\n                            Div(Class: row mt-sm t4){ \r\n                                Div(Class: col-xs-12){\r\n                                    Button(Class:btn btn-default, Page: lots_list, PageParams: \"Status=1,Search=#Search#\"){Em(Class:fa fa-hourglass-start)}\r\n                                    Button(Class:btn btn-default, Page: lots_list, PageParams: \"Status=2,Search=#Search#\"){Em(Class:fa fa-hourglass-half)}\r\n                                    Button(Class:btn btn-default, Page: lots_list, PageParams: \"Status=3,Search=#Search#\"){Em(Class:fa fa-hourglass-end)}\r\n                                    Button(Class:btn btn-default, Page: lots_list, PageParams: \"Status=4,Search=#Search#\"){Em(Class:fa fa-check)}\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(Class: list-group-item text-center){ \r\n                        Div(Class: row mt-sm t4 text-center){ \r\n                            Div(Class: col-xs-12 text-center){\r\n                                Div(Class: text-center){\r\n                                    Button(Class:btn btn-default, Page: lots_list, PageParams: \"Status=5,Search=#Search#\"){Em(Class:fa fa-times)}\r\n                                    If(GetVar(Status)!=\"\"){\r\n                                        Button(Class:btn btn-danger, Page: lots_list){Em(Class:fa fa-times)}\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n    }.Style(div {display:inline-block;})\r\n    Form(panel panel-primary){\r\n        Div(panel-body){\r\n            Div(row){\r\n                Div(col-md-12 col-xs-12){\r\n                    Div(input-group){\r\n                        Div(input-group-addon){\r\n                            \"Название\"\r\n                        }\r\n                        Input(Name: Search, Value: #Search#)\r\n                        Div(input-group-btn){\r\n                            Button(Class:  btn btn-default, Page: lots_list, PageParams: \"Search=Val(Search)\"){\r\n                                Em(Class: fa fa-search)\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            DBFind(lots, src_lots).Where(\"#Where#\").Count(lots_count).Limit(10).Custom(_name){\r\n                Div(text-left){\r\n                    LinkPage(Class: text-primary h4 text-bold, Page: lots_view, PageParams: \"Id=#id#\", Body: #name#)\r\n                }\r\n            }.Custom(_photo){\r\n                Image(Src: Binary().ById(#photo#), Class:photo)\r\n            }.Custom(_seller){\r\n                Div(text-nowrap){\r\n                    DBFind(members).Columns(\"id,member_name,image_id\").Where(\"id=#seller#\").Vars(seller)\r\n                    If(Or(#seller_id#>0,#seller_id#<0)){\r\n                    }.Else{\r\n                        SetVar(seller_member_name,Address(#seller#))\r\n                    }\r\n                    LinkPage(Class: center text-primary h5 text-bold, Page: profile_view, PageParams: \"v_member_id=#seller#\"){\r\n                        If(#seller_image_id#>0){\r\n                            Image(Src: Binary().ById(#seller_image_id#), Class: img-circle mr)\r\n                        }.Else{\r\n                            Div(Class: fa icon-user fa-2x mr)\r\n                        }\r\n                        Div(){#seller_member_name#}\r\n                    }\r\n                }\r\n            }.Custom(_date_creation){\r\n                DateTime(#date_creation#, DD.MM.YYYY)\r\n            }.Custom(_date_start){\r\n                DateTime(#date_start#, DD.MM.YY) / DateTime(#date_end#, DD.MM.YY)\r\n            }.Custom(_date_end){\r\n            }.Custom(_amount_starting){\r\n                Div(Body:Money(#amount_starting#))\r\n            }.Custom(_stps){\r\n                If(#type_bargain# == 1){\r\n                    Div(Class:h6, Body:Money(#order_min#) / Money(#order_max#))\r\n                }\r\n                If(#type_bargain# == 2){\r\n                    Div(Class:h6, Body:\"-\")\r\n                }\r\n            }.Custom(_amount_final){\r\n                SetVar(status_index, Calculate(#status# + 1))\r\n                SetVar(status_class,AppParam(App: #application_id#, Name: lots_status_classes, Index: #status_index#))\r\n                If(#type_bargain# == 1){\r\n                    Div(#status_class#){\r\n                        Money(#amount_max#)\r\n                    }\r\n                }\r\n                If(#type_bargain# == 2){\r\n                    Div(#status_class#){\r\n                        Money(#amount_starting#)\r\n                    }\r\n                }   \r\n            }.Custom(_status){\r\n                SetVar(status_index, Calculate(#status# + 1))\r\n                SetVar(status_class,AppParam(App: #application_id#, Name: lots_status_classes, Index: #status_index#))\r\n                Div(#status_class#){\r\n                    AppParam(App: #application_id#, Name: lots_status, Index: #status_index#)\r\n                }\r\n            }.Custom(_actions){\r\n                SetVar(track_id,)\r\n                DBFind(lots_tracks).Where(\"lot_id=#id# and key_id=#key_id# and deleted=0\").Vars(track)\r\n                Div(text-right text-nowrap){\r\n                    If(#r_role_name#==\"Buyer\"){\r\n                        If(#status#==2){\r\n                            Button(Class: btn btn-primary, Body: Ставка, Page: lots_view,PageParams:\"Id=#id#\")\r\n                        }.ElseIf(#status#==1){\r\n                            If(#track_id#>0){\r\n                                Button(Class: btn btn-default, Body: $lots_unsubscribe$, Page: lots_list, Contract: lots_BuyerAction, Params: \"Action=track_reject,Id=#id#\")\r\n                            }.Else{\r\n                                Button(Class: btn btn-primary, Body: $lots_subscribe$, Page: lots_list, Contract: lots_BuyerAction, Params: \"Action=track_accept,Id=#id#\")\r\n                            }\r\n                        }\r\n                    }.ElseIf(And(#seller#==#key_id#,#r_role_name#==\"Seller\")){\r\n                        If(#isMobile# == 0){\r\n                            If(#status#<1){\r\n                                Button(Class: btn btn-default fa fa-edit mr-sm, Page: lots_edit, PageParams: \"Id=#id#\")\r\n                                Button(Class: btn btn-danger fa fa-trash, Page: lots_list, Contract: lots_Delete, Params: \"Id=#id#\").Alert($lots_delete_auction$, $lots_yes$, $lots_no$)\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                If(#status#==4){\r\n                    Div(){\r\n                        LinkPage(Body: Договор, Page: lots_view_contract, PageParams: \"Id=#id#\")\r\n                    }\r\n                }\r\n                If(#status#==0){\r\n                    Div(){\r\n                        LinkPage(Body: Просмотр, Page: lots_view, PageParams: \"Id=#id#\")\r\n                    }\r\n                }\r\n            }.Order(\"id DESC\")\r\n            Div(row){\r\n                Div(col-md-12){\r\n                    If(#lots_count#>0){\r\n                        Div(table-responsive){\r\n                            Table(src_lots,\"ID=id,$lots_name$=_name,$photo$=_photo,$seller$=_seller,Начало / Окончание=_date_start,$amount_starting$=_amount_starting,Шаг (Min/Max)=_stps,$amount_final$=_amount_final,$lots_status$=_status,=_actions\")\r\n                        }\r\n                    }.Else{\r\n                        Div(text-center h3){\r\n                            LangRes(lots_not_found)\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            If(GetVar(Search)){\r\n                Div(row){\r\n                    Div(col-md-12 mt-lg){\r\n                        Div(text-center){\r\n                            Button(Body: LangRes(show_all), Class: btn btn-primary, Page: lots_list)\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }.Style(\r\n            th,td {text-align:center;}\r\n            .img-circle {height: 30px;width: 30px; border: 1px solid #5A5D63;}\r\n            .center {display:flex; align-items:center;}\r\n            .photo {height: 80px; max-width: 120px;}\r\n        )\r\n    }\r\n}",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "lots_mobile",
            "Conditions": "true",
            "Value": "DBFind(applications).Columns(\"id\").Where(\"name='Trading Platform' AND deleted=0\").Vars(application)\r\nDBFind(roles).Where(\"id=#role_id#\").Columns(\"role_name\").Vars(r)\r\nSetTitle(Торги)\r\nIf(#isMobile# == 1){\r\n    Div(Class: list-group-item){\r\n        Button(Body: Dev Button 2, Class: btn btn-primary, Page: lots_mobile)\r\n    }\r\n    Div(Class: list-group-item){\r\n        Button(Body: Обновить список лотов, Class: btn btn-primary, Page: lots_mobile)\r\n    }\r\n}\r\n\r\nDiv(content-wrapper){\r\n    SetVar(Where,\"deleted=0\").(rejected_status,5)\r\n    If(GetVar(Search)){\r\n        If(GetVar(Status)){\r\n            SetVar(Where,\"deleted=0 and name='#Search#' and status=#Status#\")\r\n        }.Else{\r\n            SetVar(Where,\"deleted=0 and name='#Search#'\")\r\n        }\r\n    }.Else{\r\n        If(GetVar(Status)){\r\n            SetVar(Where,\"deleted=0 and status=#Status#\")\r\n        }\r\n        SetVar(Search,)\r\n    }\r\n    \r\n    Div(text-right){\r\n        Data(status_icons, \"Icon\"){\r\n            fa fa-hourglass-start\r\n            fa fa-hourglass-half\r\n            fa fa-hourglass-end\r\n            fa fa-check\r\n            fa fa-times\r\n        }\r\n    }\r\n    Div(Class: col-xs-12 col-md-12){\r\n        DBFind(lots, src_lots).Where(\"#Where#\").Count(lots_count).Limit(100)\r\n        ForList(Source: src_lots){\r\n            Div(Class: form-group){\r\n                Div(Class: col-md-6 col-xs-6){\r\n                    Div(Class: list-group-item){\r\n                        LinkPage(Class: text-primary text-bold, Page: lots_view, PageParams: \"Id=#id#\", Body: #name#)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "lots_reject",
            "Conditions": "true",
            "Value": "Div(){\r\n    If(And(#Id#>0,#role_id#==1,#NotificId#>0)){\r\n        Form(form-group){\r\n            Div(form-group){\r\n                Input(Name:Comment, Type:textarea)\r\n            }\r\n            Div(text-left){\r\n                Button(Body: \"Отклонить\", Page: lots_view, Contract: lots_AdminAction, Params: \"Action=reject,Id=#Id#,NotificId=#NotificId#\", PageParams: \"Id=#Id#\", Class: btn btn-danger pull-right)\r\n                Button(Body: \"Отмена\", Page: lots_view, PageParams: \"Id=#Id#,notific_id=#NotificId#\", Class: btn btn-default pull-left)\r\n            }\r\n        } \r\n    }.Else{\r\n        Button(Body: \"Отмена\", Page: lots_view, PageParams: \"Id=#Id#,notific_id=#NotificId#\", Class: btn btn-default pull-left)\r\n    }\r\n}",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "lots_upload_photo",
            "Conditions": "true",
            "Value": "If(GetVar(Id)){}.Else{SetVar(Id,)}\r\n\r\nForm(content-wrapper){\r\n    Div(form-group){\r\n        If(#isMobile# == 0){\r\n            Input(Name: Photo, Type: file)\r\n        }.Else{\r\n            ImageInput(Name: Photo, Type: file)\r\n        }\r\n        \r\n    }\r\n    Div(form-group){\r\n        Button(Body: $lots_back$, Class: btn btn-default, Page: lots_edit, PageParams: \"Id=#Id#,TypeId=#TypeId#,CatId=#CatId#\")\r\n        Button(Body: \"Готово\", Class: btn btn-primary pull-right, Page: lots_edit, PageParams: \"Id=#Id#,TypeId=#TypeId#,CatId=#CatId#\", Contract: LotsUploadPhoto, Params: \"LotId=#Id#\")\r\n    }\r\n}",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "lots_view",
            "Conditions": "true",
            "Value": "DBFind(applications).Columns(\"id\").Where(\"name='Trading Platform' AND deleted=0\").Vars(application)\r\nDBFind(roles).Where(\"id=#role_id#\").Columns(\"role_name\").Vars(r)\r\nIf(#notific_id#>0){\r\n    DBFind(notifications).Columns(\"id,page_params->lot_id\").Where(\"id=#notific_id#\").Vars(note)\r\n    If(#note_id#>0){\r\n        SetVar(Id,#note_page_params_lot_id#)\r\n    }\r\n}.Else{\r\n    SetVar(notific_id,)\r\n}\r\nSetVar(date_format,\"DD.MM.YY HH:MI\")\r\nDiv(content-wrapper){\r\n    Div(breadcrumb){\r\n        LinkPage($lots_list$, lots_list)\r\n        Span(/,mh)\r\n        Span(Class: text-muted, Body: $lots_view$)\r\n    }\r\n\r\n    If(GetVar(Id)){\r\n        DBFind(lots,lot).Where(\"id=#Id#\").Vars(lot)\r\n        DBFind(lots_types,src_type).Where(\"deleted=0 and id=#lot_lots_type_id#\").Vars(type)\r\n        DBFind(roles).Columns(\"id,role_name\").Where(\"id=#role_id#\").Vars(r)\r\n        DBFind(lots_tracks).Where(\"lot_id=#Id# and key_id=#key_id# and deleted=0\").Vars(track)\r\n\r\n        Div(row){\r\n            Div(col-sm-10 col-sm-offset-1 col-lg-8 col-lg-offset-2){\r\n                Form(panel panel-default){\r\n                    Div(panel-heading text-center){\r\n                        If(#lot_deleted#==1){\r\n                            Div(Class: h2 text-danger, Body: LangRes(lot_deleted))\r\n                        }\r\n                        Div(Class: h3, Body: #lot_name#)\r\n                    }\r\n                    Div(panel-body){\r\n                        Div(text-center){\r\n                            Image(Src: Binary().ById(#lot_photo#), Class:big_photo mb-lg)\r\n                        }\r\n                        Div(list-group-item text-center){\r\n                            Div(row t4){\r\n                                Div(col-md-6 col-xs-4 text-right text-bold){\r\n                                    Статус торгов\r\n                                }\r\n                                SetVar(status_index, Calculate(#lot_status# + 1))\r\n                                SetVar(status_class,AppParam(App: #application_id#, Name: lots_status_classes, Index: #status_index#))\r\n                                Div(col-md-6 col-xs-8 text-left text-uppercase #status_class#){\r\n                                    Strong(AppParam(App: #application_id#, Name: lots_status, Index: #status_index#))\r\n                                }\r\n                                If(#lot_comment#!=\"\"){\r\n                                    Div(text-muted){\r\n                                        #lot_comment#\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                            If(#lot_status#==4){\r\n                                Div(){\r\n                                    LinkPage(Body: Договор, Page: lots_view_contract, PageParams: \"Id=#Id#\")\r\n                                }\r\n                            }\r\n                        }\r\n                        Div(text-center){\r\n                            If(And(#status_index#==1,#role_id#==1,#notific_id#>0)){\r\n                                Div(form-group text-left){\r\n                                    Button(Body: \"Отклонить\", Page: lots_reject, PageParams: \"NotificId=#notific_id#,Id=#Id#\", Class: btn btn-danger).Popup(Width: 40, Header: \"Пожалуйста укажите причину отказа\")\r\n                                    Button(Body: \"Принять\", Page: lots_view, Contract: lots_AdminAction, Params: \"Action=accept,Id=#Id#,NotificId=#notific_id#,Comment=\", Class: btn btn-success pull-right, PageParams: \"Id=#Id#\")\r\n                                }\r\n                            }.ElseIf(And(#r_role_name#==\"Buyer\",#notific_id#>0)){\r\n                                Div(form-group text-left){\r\n                                    Button(Body: \"Не интересует\", Page: lots_list, Contract: lots_BuyerAction, Params: \"Action=track_reject,Id=#Id#,NotificId=#notific_id#\", Class: btn btn-default)\r\n                                    Button(Body: \"Отслеживать\", Page: lots_list, Params: \"Action=track_accept,NotificId=#notific_id#,Id=#Id#\",PageParams: \"Id=#Id#\", Contract: lots_BuyerAction, Class: btn btn-success pull-right)\r\n                                }\r\n                            }\r\n                        }\r\n                        Div(form-group){\r\n                            Div(list-group-item text-center){\r\n                                Div(row mt-sm t4){\r\n                                    Div(col-md-6 col-xs-4 text-bold text-right){\r\n                                        ID\r\n                                    }\r\n                                    Div(col-md-6 col-xs-8 text-left){\r\n                                        #lot_id#\r\n                                    }\r\n                                }\r\n\r\n                                Div(row mt-sm t4){\r\n                                    Div(col-md-6 col-xs-4 text-bold text-right){\r\n                                        LangRes(lots_description)\r\n                                    }\r\n                                    Div(col-md-6 col-xs-8 text-left){\r\n                                        #lot_description#\r\n                                    }\r\n                                }\r\n\r\n                                Div(row mt-sm t4){\r\n                                    Div(col-md-6 col-xs-4 mt-sm text-bold text-right){\r\n                                        LangRes(seller)\r\n                                    }\r\n                                    Div(col-md-6 col-xs-8 text-left){\r\n                                        DBFind(members).Columns(\"id,member_name,image_id\").Where(\"id=#lot_seller#\").Vars(seller)\r\n                                        If(Or(#seller_id#>0,#seller_id#<0)){\r\n                                        }.Else{\r\n                                            SetVar(seller_member_name,Address(#lot_seller#))\r\n                                        }\r\n                                        LinkPage(Class: center text-primary h5 text-bold, Page: profile_view, PageParams: \"v_member_id=#lot_seller#\"){\r\n                                            If(#seller_image_id#>0){\r\n                                                Image(Src: Binary().ById(#seller_image_id#), Class: img-circle mr)\r\n                                            }.Else{\r\n                                                Span(Class: fa icon-user fa-2x mr)\r\n                                            }\r\n                                            Span(#seller_member_name#)\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                            Div(list-group-item text-center){\r\n                                Div(row mt-sm t4){\r\n                                    Div(col-md-6 col-xs-4 text-bold text-right){\r\n                                        LangRes(date_creation)\r\n                                    }\r\n                                    Div(col-md-6 col-xs-8 text-left){\r\n                                        DateTime(#lot_date_creation#, DD.MM.YYYY HH:MI)\r\n                                    }\r\n                                }\r\n                                Div(row mt-sm t4){\r\n                                    Div(col-md-6 col-xs-4 text-bold text-right){\r\n                                        LangRes(lots_date_start)\r\n                                    }\r\n                                    Div(col-md-6 col-xs-8 text-left){\r\n                                        DateTime(#lot_date_start#, DD.MM.YYYY HH:MI)\r\n                                    }\r\n                                }\r\n                                Div(row mt-sm t4){\r\n                                    Div(col-md-6 col-xs-4 text-bold text-right){\r\n                                        LangRes(lots_date_end)\r\n                                    }\r\n                                    Div(col-md-6 col-xs-8 text-left){\r\n                                        DateTime(#lot_date_end#, DD.MM.YYYY HH:MI)\r\n                                    }\r\n                                }\r\n                            }\r\n                            Div(list-group-item text-center){\r\n                                If(#lot_type_bargain# == 2){\r\n                                    Div(row mt-sm t4){\r\n                                        Div(col-md-6 col-xs-4 text-bold text-right){\r\n                                            Span(Body: \"Цена\")\r\n                                        }\r\n                                        Div(col-md-6 col-xs-8 text-left){\r\n                                            Money(#lot_amount_starting#)\r\n                                        }\r\n                                    }\r\n                                }.Else{\r\n                                    Div(row mt-sm t4){\r\n                                        Div(col-md-6 col-xs-4 text-bold text-right){\r\n                                            Span(\"Тип торга\")\r\n                                        }\r\n                                        Div(col-md-6 col-xs-8 text-left){\r\n                                            Span(Body: AppParam(App:#application_id#, Name:bargain_type, Index: #lot_type_bargain#))\r\n                                        }\r\n                                    }\r\n\r\n                                    Div(row mt-sm t4){\r\n                                        Div(col-md-6 col-xs-4 text-bold text-right){\r\n                                            LangRes(amount_starting)\r\n                                        }\r\n                                        Div(col-md-6 col-xs-8 text-left){\r\n                                            Money(#lot_amount_starting#)\r\n                                        }\r\n                                    }\r\n\r\n                                    DBFind(Name: buyers, Source: src_buyers).Where(\"lot_id = #Id#\").Order(amount DESC, id ASC).Vars(i_rate)\r\n                                    Div(row mt-sm t4){\r\n                                        Div(col-md-6 col-xs-4 text-bold text-right){\r\n                                            LangRes(order_min)\r\n                                        }\r\n                                        Div(col-md-6 col-xs-8 text-left){\r\n                                            If(#i_rate_amount# > 0){\r\n                                                SetVar(rate_min,Calculate(Exp:#i_rate_amount#+#lot_order_min#,Type:money))\r\n                                                Money(#rate_min#)\r\n                                            }.Else{\r\n                                                SetVar(rate_min,Calculate(Exp:#lot_amount_starting#+#lot_order_min#,Type:money))\r\n                                                Money(#rate_min#)\r\n                                            }\r\n                                        }\r\n                                    }\r\n\r\n                                    Div(row mt-sm t4){\r\n                                        Div(col-md-6 col-xs-4 text-bold text-right){\r\n                                            LangRes(order_max)\r\n                                        }\r\n                                        Div(col-md-6 col-xs-8 text-left){\r\n                                            If(#i_rate_amount# > 0){\r\n                                                SetVar(rate_max,Calculate(Exp:#i_rate_amount#+#lot_order_max#,Type:money))\r\n                                                Money(#rate_max#)\r\n                                            }.Else{\r\n                                                SetVar(rate_max,Calculate(Exp:#lot_amount_starting#+#lot_order_max#,Type:money))\r\n                                                Money(#rate_max#)\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                    If(And(#lot_status#==2,#status_index#>2,#lot_type_bargain# == 1)){\r\n                                        Div(list-group-item text-center){\r\n                                            Div(row){\r\n                                                Div(col-md-12 mt-sm text-center){\r\n                                                    Span(Class: h4, Body: $lots_bets$)\r\n                                                }\r\n                                                DBFind(Name: buyers, Source: src_buyers).Where(\"lot_id = #Id#\").Order(amount DESC, id ASC).Custom(custom_buyer_id){\r\n                                                    Div(text-left){\r\n                                                        DBFind(members).Columns(\"id,member_name,image_id\").Where(\"id=#buyer_id#\").Vars(member)\r\n                                                        If(Or(#member_id#>0,#member_id#<0)){\r\n                                                        }.Else{\r\n                                                            SetVar(member_member_name,Address(#buyer_id#))\r\n                                                        }\r\n                                                        LinkPage(Class: text-center text-primary h5 text-bold, Page: profile_view, PageParams: \"v_member_id=#buyer_id#\"){\r\n                                                            If(#member_image_id#>0){\r\n                                                                Image(Src: Binary().ById(#member_image_id#), Class: img-circle mr)\r\n                                                            }.Else{\r\n                                                                Span(Class: fa icon-user fa-2x mr)\r\n                                                            }\r\n                                                            Span(#member_member_name#)\r\n                                                        }\r\n                                                    }\r\n                                                }.Custom(custom_amount){\r\n                                                    Money(#amount#)\r\n                                                }.Custom(id_vot){\r\n                                                    If(#id#>0){\r\n                                                        #id#\r\n                                                    }\r\n                                                }.Custom(percent_money){\r\n                                                    Money(#percentrate#)\r\n                                                }.Custom(rate__date){\r\n                                                    DateTime(#rate_date#,#date_format#)\r\n                                                }.Count(ggggg)\r\n                                                If(#ggggg# > 0){\r\n                                                    Table(src_buyers, \"ID ставки=id_vot,Покупатель=custom_buyer_id,Время ставки=rate__date,Комиссия=percent_money,Ставка=custom_amount\")\r\n                                                }.Else{\r\n                                                    Span(\"Ставок нет\")\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                            If(#lot_contract_id#>0){\r\n                                Div(list-group-item text-center){\r\n                                    Div(row mt-sm t4){\r\n                                        Div(col-md-12){\r\n                                            DBFind(binaries, src_binaries).Where(\"id=#lot_contract_id#\")\r\n                                            Table(Source: src_binaries, \"$lots_contract$=data\")\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                            If(And(#lot_status#==2,#r_role_name#==\"Buyer\",#lot_type_bargain# == 1)){\r\n                                Div(list-group-item text-center){\r\n                                    Div(row mt-sm){\r\n                                        Div(col-md-12){\r\n                                            If(#isMobile#==0){\r\n                                                Div(input-group){\r\n                                                    Div(input-group-addon){\r\n                                                        Span(Class: h4,Body:\"Ставка\")\r\n                                                    }\r\n                                                    Input(Name: StepRate,Type: number)\r\n                                                    Div(input-group-btn){\r\n                                                        DBFind(\"buyers\").Where(\"lot_id = #Id#\").Order(\"amount DESC\").Vars(rate_hight_)\r\n                                                        If(#rate_hight__buyer_id# == #key_id#){\r\n                                                            Button(Class: btn btn-success pull-right disabled,Body: \"Сделать ставку\")\r\n                                                        }.Else{\r\n                                                            Button(Class: btn btn-success pull-right,Body: \"Сделать ставку\",Contract:AuctionProcess,Page:lots_view,Params:\"step_rate=Val(StepRate),lot_id=#Id#\",PageParams: \"Id=#Id#\")\r\n                                                        }\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }.Style(padding-top:10px;)\r\n                                }\r\n                            }\r\n                            If(#lot_status# >= 3){\r\n                                Div(list-group-item text-center){\r\n                                    Div(row){\r\n                                        Div(col-md-12 mt-sm text-center){\r\n                                            Span(Class: h4, Body: $lots_bets$)\r\n                                        }\r\n                                        DBFind(Name: buyers, Source: src_buyers).Where(\"lot_id = #Id#\").Order(amount DESC, id ASC).Custom(custom_buyer_id){\r\n                                            Div(text-left){\r\n                                                DBFind(members).Columns(\"id,member_name,image_id\").Where(\"id=#buyer_id#\").Vars(member)\r\n                                                If(Or(#member_id#>0,#member_id#<0)){\r\n                                                }.Else{\r\n                                                    SetVar(member_member_name,Address(#buyer_id#))\r\n                                                }\r\n                                                LinkPage(Class: center text-primary h5 text-bold, Page: profile_view, PageParams: \"v_member_id=#buyer_id#\"){\r\n                                                    If(#member_image_id#>0){\r\n                                                        Image(Src: Binary().ById(#member_image_id#), Class: img-circle mr)\r\n                                                    }.Else{\r\n                                                        Span(Class: fa icon-user fa-2x mr)\r\n                                                    }\r\n                                                    Span(#member_member_name#)\r\n                                                }\r\n                                            }\r\n                                        }.Custom(custom_amount){\r\n                                            Money(#amount#)\r\n                                        }.Custom(custom_status){\r\n                                            If(#status# == -1){\r\n                                                Span(Class: text-danger, Body: \"Отказ\")\r\n                                            }\r\n                                            DBFind(\"buyers\").Where(\"buyer_id = #lot_buyer# and lot_id = #Id#\").Vars(win_).Order(\"amount DESC\")\r\n                                            If(And(#status# == 0, #lot_buyer# == #buyer_id#, #id# == #win__id#)){\r\n                                                Span(Class: text-warning, Body: \"Ожидание подписи\")\r\n                                            }.ElseIf(#status# == 0){\r\n                                                Span(Body: \"Претендент\")\r\n                                            }\r\n                                            If(#status# == 1){\r\n                                                Span(Class: text-success, Body: \"Победитель\")\r\n                                            }\r\n                                        }.Custom(percent_money){\r\n                                            Money(#percentrate#)\r\n                                        }.Custom(rate__date){\r\n                                            DateTime(#rate_date#,#date_format#)\r\n                                        }\r\n                                        Table(src_buyers, \"ID=id,Покупатель=custom_buyer_id,Время ставки=rate__date,Комиссия=percent_money,Ставка=custom_amount,Статус=custom_status\").Style(padding-left:10px;)\r\n                                    }\r\n                                }\r\n                            }\r\n                            If(And(#lot_status#==2,#status_index#>2,#lot_type_bargain# == 2)){\r\n                                Div(list-group-item text-center){\r\n                                    Div(row){\r\n                                        Div(col-md-12 mt-sm text-center){\r\n                                            Span(Class: h4, Body: $lots_bets$)\r\n                                        }\r\n                                        DBFind(Name: buyers, Source: src_buyers).Where(\"lot_id = #Id#\").Order(id ASC).Custom(custom_buyer_id){\r\n                                            Div(text-left){\r\n                                                DBFind(members).Columns(\"id,member_name,image_id\").Where(\"id=#buyer_id#\").Vars(member)\r\n                                                If(Or(#member_id#>0,#member_id#<0)){\r\n                                                }.Else{\r\n                                                    SetVar(member_member_name,Address(#buyer_id#))\r\n                                                }\r\n                                                LinkPage(Class: text-center text-primary h5 text-bold, Page: profile_view, PageParams: \"v_member_id=#buyer_id#\"){\r\n                                                    If(#member_image_id#>0){\r\n                                                        Image(Src: Binary().ById(#member_image_id#), Class: img-circle mr)\r\n                                                    }.Else{\r\n                                                        Span(Class: fa icon-user fa-2x mr)\r\n                                                    }\r\n                                                    Span(#member_member_name#)\r\n                                                }\r\n                                            }\r\n                                        }.Custom(custom_amount){\r\n                                            Money(#amount#)\r\n                                        }.Custom(id_vot){\r\n                                            If(#id#>0){\r\n                                                #id#\r\n                                            }\r\n                                        }.Custom(percent_money){\r\n                                            Money(#percentrate#)\r\n                                        }.Custom(rate__date){\r\n                                            DateTime(#rate_date#,#date_format#)\r\n                                        }\r\n                                        Table(src_buyers, \"ID ставки=id_vot,Покупатель=custom_buyer_id,Время ставки=rate__date,Комиссия=percent_money,Ставка=custom_amount\")\r\n                                    }\r\n                                }\r\n                            }\r\n                            If(And(#lot_status#==2,#r_role_name#==\"Buyer\",#lot_type_bargain# == 2)){\r\n                                If(#isMobile# == 0){\r\n                                    Div(list-group-item text-center){\r\n                                        Div(row mt-sm){\r\n                                            Div(col-md-12 col-xs-12){\r\n                                                DBFind(\"buyers\").Where(\"buyer_id = #key_id# and lot_id = #Id#\").Vars(rate_).Order(\"id\")\r\n                                                If(#rate__id# > 0){\r\n                                                \r\n                                                    Button(Class: btn btn-success pull-right disabled,Body: \"Купить\")\r\n                                                }.Else{\r\n                                                    Button(Class: btn btn-success pull-right, Body: \"Купить\",Contract:AuctionProcess,Page:lots_view,Params:\"step_rate=0,lot_id=#Id#\",PageParams: \"Id=#Id#\")\r\n                                                }\r\n                                                Button(Class: btn btn-default pull-right, Body: \"Назад\",Page:lots_list)\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                                If(#isMobile# == 1){\r\n                                    Div(list-group-item text-center){\r\n                                        Div(input-group-addon){\r\n                                            Div(col-md-12 col-xs-12){\r\n                                                DBFind(\"buyers\").Where(\"buyer_id = #key_id# and lot_id = #Id#\").Vars(rate_).Order(\"id\")\r\n                                                If(#rate__id# > 0){\r\n                                                \r\n                                                    Button(Class: btn btn-success pull-right disabled,Body: \"Купить\")\r\n                                                }.Else{\r\n                                                    Button(Class: btn btn-success pull-right, Body: \"Купить\",Contract:AuctionProcess,Page:lots_view,Params:\"step_rate=0,lot_id=#Id#\",PageParams: \"Id=#Id#\")\r\n                                                }\r\n                                                Button(Class: btn btn-default pull-right, Body: \"Назад\",Page:lots_list)\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                            Div(mt-lg text-center){\r\n                                If(#isMobile# == 1){\r\n                                    If(And(#lot_status#==2,#r_role_name#==\"Buyer\",#lot_type_bargain# == 1)){\r\n                                        Div(Class: col-md-12 col-xs-12){\r\n                                            Div(input-group-addon){\r\n                                                Div(Class: col-md-12 col-xs-12){\r\n                                                    Div(Class: list-group-item){\r\n                                                        Span(Class: h4 mt-sm, Body:\"Ставка\")\r\n                                                    }\r\n                                                    Div(Class: list-group-item){\r\n                                                        Input(Name: StepRate, Type: number)\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                            Div(input-group-addon){\r\n                                                Div(Class: form-group){\r\n                                                    DBFind(\"buyers\").Where(\"lot_id = #Id#\").Order(\"amount DESC\").Vars(rate_hight_)\r\n                                                    If(#rate_hight__buyer_id# == #key_id#){\r\n                                                        Button(Class: btn btn-success btn-block disabled,Body: \"Сделать ставку\")\r\n                                                    }.Else{\r\n                                                        Button(Class: btn btn-success btn-block, Body: \"Сделать ставку\",Contract:AuctionProcess,Page:lots_view,Params:\"step_rate=Val(StepRate),lot_id=#Id#\",PageParams: \"Id=#Id#\")\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                                Button(Class: btn btn-link, Body: $lots_view_info$, Page: lots_view_info, PageParams: \"notific_id=#notific_id#,Id=#Id#\").Popup(Header:\"#lot_name#\", Width: 45)\r\n                            }\r\n                        }\r\n                        Div(form-group){\r\n                            If(#lot_deleted#==0) {\r\n                                If(#r_role_name#==\"Buyer\"){\r\n                                    If(\"comment\"==\"пока отключено\"){\r\n                                        Div(list-group-item text-center){\r\n                                            If(#lot_status#==1){\r\n                                                If(#track_id#>0){\r\n                                                    Button(Body: $lots_unsubscribe$, Class: btn btn-default btn-block, Page: lots_view, PageParams: \"Id=#Id#\", Contract: lots_BuyerAction, Params: \"Action=track_reject,Id=#Id#\")\r\n                                                }.Else{\r\n                                                    Button(Body: $lots_subscribe$, Class: btn btn-primary btn-block, Page: lots_view,PageParams: \"Id=#Id#\", Contract: lots_BuyerAction, Params: \"Action=track_accept,Id=#Id#\")\r\n                                                }\r\n                                            }.ElseIf(#lot_status#>1){\r\n                                                Button(Class: btn btn-primary btn-block, Body: $lots_bid$, Page: lots_list)\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }.ElseIf(#r_role_name#==\"Seller\"){\r\n                                    If(And(#lot_seller#==#key_id#,#lot_status#==0)){\r\n                                        Div(list-group-item text-center){\r\n                                            Button(Class: btn btn-default btn-block, Body: LangRes(lot_edit), Page: lots_edit, PageParams: \"Id=#Id#\")\r\n                                        }\r\n                                        Div(list-group-item text-center){\r\n                                            Button(Class: btn btn-danger btn-block, Body: LangRes(lots_delete), Page: lots_list, Contract: lots_Delete, Params: \"Id=#Id#\").Alert($lots_delete_auction$, $lots_yes$, $lots_no$)\r\n                                        }\r\n                                    }\r\n                                }.Else{\r\n                                    If(\"comment\"==\"ручной запуск отключен. используется выполнение по расписанию (Cron->LotsStatusUpdate)\"){\r\n                                        If(And(#role_id#==1,#lot_status#==1)){\r\n                                            Div(list-group-item text-center){\r\n                                                Button(Class: btn btn-success btn-block, Body: \"Начать торги\", Page: lots_view,Contract: AuctionProccessEdit,Params: \"lot_id=#Id#\",PageParams: \"Id=#Id#\")\r\n                                            }\r\n                                        }.ElseIf(And(#role_id#==1,#lot_status#==2,#lot_type_bargain#==1)){\r\n                                            Div(list-group-item text-center){\r\n                                                Button(Class: btn btn-success btn-block, Body: \"Закончить торги\", Page: lots_view,Contract: AuctionProccessEdit,Params: \"lot_id=#Id#\",PageParams: \"Id=#Id#\")\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}.Style(\r\n    th,td {text-align:center;}\r\n    .t4 {font-size:18px;}\r\n    .img-circle {height: 30px;width: 30px; border: 1px solid #5A5D63;}\r\n    .center {display:flex; align-items:center;}\r\n    .big_photo {height: 300px; max-width: 600px;}\r\n)",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "lots_view_contract",
            "Conditions": "true",
            "Value": "If(#notific_id#>0){\r\n    DBFind(notifications).Columns(\"id,page_params->lot_id\").Where(\"id=#notific_id#\").Vars(notification)\r\n    If(#notification_id#>0){\r\n        SetVar(Id, #notification_page_params_lot_id#)\r\n    }\r\n}\r\nDiv(Class: fullscreen-wrapper){\r\n    If(GetVar(Id)){\r\n        DBFind(Name: lots).Where(\"id=#Id#\").Vars(lot)\r\n        DBFind(Name: members).Where(\"id=#lot_buyer#\").Vars(buyer)\r\n        DBFind(Name: members).Where(\"id=#lot_seller#\").Vars(seller)\r\n\r\n        If(And(GetVar(seller_name_first) == \"\",GetVar(seller_name_middle) == \"\",GetVar(seller_name_last) == \"\")){\r\n            SetVar(seller_name_first, \"не указано\")\r\n        }\r\n        If(And(GetVar(buyer_name_first) == \"\",GetVar(buyer_name_middle) == \"\",GetVar(buyer_name_last) == \"\")){\r\n            SetVar(buyer_name_first, \"не указано\")\r\n        }\r\n        If(GetVar(seller_company_name) == \"\"){\r\n            SetVar(seller_company_name, \"не указано\")\r\n        }\r\n        If(GetVar(buyer_company_name) == \"\"){\r\n            SetVar(buyer_company_name, \"не указано\")\r\n        }\r\n        If(GetVar(seller_company_position) == \"\"){\r\n            SetVar(seller_company_position, \"не указано\")\r\n        }\r\n        If(GetVar(buyer_company_position) == \"\"){\r\n            SetVar(buyer_company_position, \"не указано\")\r\n        }\r\n\r\n        Div(row){\r\n            Div(col-sm-12 col-lg-10 col-lg-offset-1 col-md-12 col-md-offset-1){\r\n                Form(panel panel-default){\r\n                    Div(panel-heading){\r\n                        Div(Class: h1 text-center, Body: Strong(\"Договор купли-продажи по лоту №#lot_id#\"))\r\n                        Div(Body: \" \").Style(padding-top:30px;)\r\n                        Div(Class: row){\r\n                            Div(Class: col-md-6){\r\n                                Div(Class: h3, Body: Strong(\"Продавец\"))\r\n                                Div(Class: h4){\r\n                                    Div(Body: Strong(ФИО:) #seller_name_first# #seller_name_middle# #seller_name_last#)\r\n                                    Div(Body: Strong(Компания:) #seller_company_name#)\r\n                                    Div(Body: Strong(Должность:) #seller_company_position#)\r\n                                }.Style(margin-left:35px; line-height: 1.8;)\r\n                                Div(Body: \" \")\r\n                            }\r\n                            Div(Class: col-md-6){\r\n                                Div(Class: h3, Body: Strong(\"Покупатель\"))\r\n                                Div(Class: h4){\r\n                                    Div(Body: Strong(ФИО:) #buyer_name_first# #buyer_name_middle# #buyer_name_last#)\r\n                                    Div(Body: Strong(Компания:) #buyer_company_name#)\r\n                                    Div(Body: Strong(Должность:) #buyer_company_position#)\r\n                                }.Style(margin-left:35px; line-height: 1.8;)\r\n                                Div(Body: \" \").Style(padding-top:30px;)\r\n                            }\r\n                        }\r\n                        Div(Class: h3, Body: Strong(\"Описание лота\"))\r\n                        Div(Class: h4){\r\n                            Div(Body: Strong(Наименование:) #lot_name#)\r\n                            Div(Body: Strong(Описание:) #lot_description#)\r\n                            Div(Body: Strong(Количество единиц:) #lot_unit_count#)\r\n                            Div(Body: Strong(Вес:) #lot_weight_decimal#)\r\n                            Div(Body: Strong(Ширина:) #lot_width_decimal#)\r\n                            Div(Body: Strong(Высота:) #lot_height_decimal#)\r\n                            Div(Body: Strong(Длина:) #lot_length_decimal#)\r\n                            Div(Body: Strong(Место нахождение:) #lot_location#)\r\n                        }.Style(margin-left:35px; line-height: 1.8;)\r\n                        Div(Body: \" \").Style(padding-top:30px;)\r\n\r\n                        Div(Class: h3 text-ceneter){\r\n                            Strong(Цена:)\r\n                            Span(Class: h3, Body:  Money(#lot_amount_final#)).Style(marging-left: 4px;)\r\n                        }\r\n                        \r\n                        Div(Body: \" \").Style(padding-top:30px;)\r\n\r\n\r\n                        Div(row){\r\n                            Div(col-md-6){\r\n                                If(GetVar(lot_seller_sign)==1){\r\n                                    Div(){\r\n                                        Div(Class: h3, Body: Strong(Продавец:))\r\n                                        Div(Class: h4){ #seller_member_name#}\r\n                                        Div(Class: text_center, Body: #lot_seller_pub#).Style(font-size:11px; padding-top: 10px;)\r\n                                        If(GetVar(lot_date_end)!=\"\"){\r\n                                            Div(Class: h4, Body: Strong(Дата:) DateTime(#lot_date_end#, \"DD-MM-YYYY\"))\r\n                                        }\r\n                                    }\r\n                                    Div(Body: \" \").Style(padding-top:30px;)\r\n                                }\r\n                            }\r\n                            Div(col-md-6){\r\n                                If(GetVar(lot_buyer_sign)==1){\r\n                                    Div(){\r\n                                        Div(Class: h3, Body: Strong(Покупатель:))\r\n                                        Div(Class: h4){#buyer_member_name#}\r\n                                        Div(Class: text_center, Body: #lot_buyer_pub#).Style(font-size:11px; padding-top: 10px;)\r\n                                        If(GetVar(lot_date_sign)!=\"\"){\r\n                                            Div(Class: h4, Body: Strong(Дата:) DateTime( #lot_date_sign#, \"DD-MM-YYYY\"))\r\n                                        }\r\n                                    }\r\n                                    Div(Body: \" \").Style(padding-top:30px;)\r\n                                }\r\n                            }\r\n                        } \r\n\r\n                        If(And(#lot_status#==3,#key_id#==#lot_buyer#,#notific_id#>0)){\r\n                            Div(Body: \" \")\r\n                            Div(form-group text-left){\r\n                                If(#isMobile# == 0){\r\n                                    Input(Type:hidden, Value: #key_buyer_id#, Name: \"buyer_pub\")\r\n                                }\r\n                                Button(Body: \"Отклонить\", Contract: lots_Sign, Params: \"actions=buyer_reject,lot_id=#Id#,notific_id=#notific_id#\", Page: lots_view_contract, PageParams: \"Id=#Id#\", Class: btn btn-danger)\r\n                                Button(Body: \"Подписать\", Contract: lots_Sign, Params: \"actions=buyer_accept,lot_id=#Id#,notific_id=#notific_id#\", Page: lots_view_contract, PageParams: \"Id=#Id#\", Class: btn btn-success pull-right)\r\n                            }\r\n                        }.ElseIf(And(#lot_status#==3,#key_id#==#lot_seller#,#notific_id#>0)){\r\n                            If(#lot_seller_sign#==1){\r\n                            }.Else{\r\n                                Div(Body: \" \")\r\n                                Div(form-group text-left){\r\n                                    If(#isMobile# == 0){\r\n                                        Input(Type: hidden, Value: #key_seller_id#, Name: \"seller_pub\")\r\n                                    }\r\n                                    Button(Body: \"Отклонить\", Contract: lots_Sign, Params: \"actions=seller_reject ,lot_id=#Id#,notific_id=#notific_id#\", Page: lots_view_contract, PageParams: \"Id=#Id#\", Class: btn btn-danger)\r\n                                    Button(Body: \"Подписать\", Contract: lots_Sign, Params: \"actions=seller_accept,lot_id=#Id#,notific_id=#notific_id#\", Page: lots_view_contract, PageParams: \"Id=#Id#\", Class: btn btn-success pull-right)\r\n                                }\r\n                            }\r\n                        }\r\n                    }.Style(padding-left: 120px; padding-right: 120px;)\r\n                }\r\n                Div(panel){\r\n                    If(GetVar(lot_contract_hash)!=\"\"){\r\n                        Div(Class: panel-body h5 text-center, Body: \"Хеш договора - #lot_contract_hash#\")\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "lots_view_info",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "DBFind(applications).Columns(\"id\").Where(\"name='Trading Platform' AND deleted=0\").Vars(application)\r\nDiv(content-wrapper){\r\n    If(GetVar(Id)){\r\n        DBFind(lots,lot).Where(\"id=#Id#\").Vars(lot)\r\n        DBFind(lots_types,src_type).Where(\"deleted=0 and id=#lot_lots_type_id#\").Vars(type)\r\n        SetVar(left_col,\"col-md-4 col-xs-4\")\r\n        SetVar(right_col,\"col-md-8 col-xs-8\")\r\n\r\n        Div(form-group){\r\n            Div(){\r\n                Div(row mt-sm){\r\n                    Div(col-md-4 col-xs-4 mt-sm text-bold text-right){\r\n                        Strong(LangRes(lots_cat))\r\n                    }\r\n                    Div(col-md-8 col-xs-8 text-left mt-sm){\r\n                        AppParam(App: #application_id#, Name: lots_categories, Index: #type_category#)\r\n                    }\r\n                }\r\n                Div(row mt-sm){\r\n                    Div(col-md-4 col-xs-4 mt-sm text-bold text-right){\r\n                        Strong(LangRes(lots_type))\r\n                    }\r\n                    Div(col-md-8 col-xs-8 text-left mt-sm){\r\n                        ForList(src_type){\r\n                            LangRes(#resource_name#)\r\n                        }\r\n                    }\r\n                }\r\n                Div(row mt-sm){\r\n                    Div(col-md-4 col-xs-4 mt-sm text-bold text-right){\r\n                        Strong(LangRes(lots_location))\r\n                    }\r\n                    Div(col-md-4 col-xs-4 text-left mt-sm){\r\n                        Map(Hmap:200, MapType:hybrid, Value:#lot_map_location#)\r\n                        #lot_location#\r\n                    }\r\n                }\r\n                Div(row mt-sm){\r\n                    Div(col-md-4 col-xs-4 mt-sm text-bold text-right){\r\n                        Strong(LangRes(lots_condition))\r\n                    }\r\n                    Div(col-md-8 col-xs-8 text-left mt-sm){\r\n                        AppParam(App:#application_id#, Name:lots_condition, Index:#lot_condition#)\r\n                    }\r\n                }\r\n                ArrayToSource(type_blocks, [#type_lots_params#])\r\n                ForList(type_blocks){\r\n                    Div(Class: col-md-12 col-xs-12){\r\n                        Div(row mt-sm){\r\n                            SetVar(block,AppParam(App:#application_id#, Name:lots_params, Index:#value#))\r\n                            Include(#block#)\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        Div(text-right){\r\n            Button(Class: btn btn-primary, Page: lots_view, PageParams: \"notific_id=#notific_id#,Id=#Id#\", Body: \"Закрыть\")\r\n        }\r\n    }\r\n}",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "mobile_my_lots",
            "Conditions": "true",
            "Value": "Div(content-wrapper){\r\n    If(Or(#v_member_id#>0,#v_member_id#<0)){\r\n    }.Else{\r\n        SetVar(Name: v_member_id, Value: #key_id#)\r\n    }\r\n    DBFind(Name: members, Source: src_member).Columns(\"id,image_id,member_name,name_first,name_middle,name_last,company_name,company_position,member_info->information\").Where(\"id=#v_member_id#\").Vars(prefix)\r\n    DBFind(roles).Where(\"id=#role_id#\").Columns(\"role_name\").Vars(r)\r\n    DBFind(applications).Columns(\"id\").Where(\"name='Trading Platform' AND deleted=0\").Vars(application)\r\n    If(Or(#prefix_id#>0,#prefix_id#<0)){\r\n        If(#isMobile# == 1){\r\n            If(#prefix_id# == #key_id#){\r\n                Div(Class: panel panel-default){\r\n                    If(#r_role_name#==\"Seller\"){\r\n                        Div(Class: panel-heading, Body: Активные лоты)\r\n                        DBFind(lots, src_lots).Count(tettttt).Where(\"seller=#key_id# and deleted=0 and status=2 \").Custom(_photo){\r\n                            Image(Src: Binary().ById(#photo#), Class:photo)\r\n                        }.Custom(_date_creation){\r\n                            DateTime(#date_creation#, DD.MM.YYYY)\r\n                        }.Custom(_date_start){\r\n                            DateTime(#date_start#, DD.MM.YY) \\ DateTime(#date_end#, DD.MM.YY)\r\n                        }.Custom(_date_end){\r\n                            DateTime(#date_end#, DD.MM.YYYY)\r\n                        }.Custom(_amount_starting){\r\n                            Money(#amount_starting#)\r\n                        }.Custom(_stps){\r\n                            If(#type_bargain# == 1){\r\n                                Div(Class:h6, Body:Money(#order_min#) \\ Money(#order_max#))\r\n                            }\r\n                            If(#type_bargain# == 2){\r\n                                Div(Class:h6, Body:\"-\")\r\n                            }\r\n                        }.Custom(_amount_final){\r\n                            SetVar(status_index, Calculate(#status# + 1))\r\n                            SetVar(status_class,AppParam(App: #application_id#, Name: lots_status_classes, Index: #status_index#))\r\n                            If(#type_bargain# == 1){\r\n                                Div(#status_class#){\r\n                                    Money(#amount_max#)\r\n                                }\r\n                            }\r\n                            If(#type_bargain# == 2){\r\n                                Div(#status_class#){\r\n                                    Money(#amount_starting#)\r\n                                }\r\n                            }\r\n                        }.Custom(_seller){\r\n                            Div(text-nowrap){\r\n                                DBFind(members).Columns(\"id,member_name,image_id\").Where(\"id=#seller#\").Vars(seller)\r\n                                If(Or(#seller_id#>0,#seller_id#<0)){\r\n                                }.Else{\r\n                                    SetVar(seller_member_name,Address(#seller#))\r\n                                }\r\n                                LinkPage(Class: center text-primary h5 text-bold, Page: profile_view, PageParams: \"v_member_id=#seller#\"){\r\n                                    If(#seller_image_id#>0){\r\n                                        Image(Src: Binary().ById(#seller_image_id#), Class: img-circle mr)\r\n                                    }.Else{\r\n                                        Div(Class: fa icon-user fa-2x mr)\r\n                                    }\r\n                                    Div(){#seller_member_name#}\r\n                                }\r\n                            }\r\n                        }.Custom(_name){\r\n                            Div(text-left){\r\n                                LinkPage(Class: text-primary h5 text-bold, Page: lots_view, PageParams: \"Id=#id#\", Body: #name#)\r\n                            }\r\n                        }\r\n                        Div(list-group-item text-center){\r\n                            Div(table-responsive){\r\n                                If(#tettttt#>0){\r\n                                    Table(src_lots,\"ID=id,Название=_name,Продавец=_seller,Начало \\ Окончание=_date_start,Стартовая цена=_amount_starting,Шаг (Min\\Max)=_stps,Цена=_amount_final\")\r\n                                }.Else{\r\n                                    Span(Лотов нет)\r\n                                }\r\n                            }.Style(\r\n                                th,td {text-align:center;}\r\n                                .img-circle {height: 30px;width: 30px; border: 1px solid #5A5D63;}\r\n                                .center {display:flex; align-items:center;}\r\n                                .photo {height: 30px; width: 30px;}\r\n                            )\r\n                        }\r\n                    }\r\n                    If(#r_role_name#==\"Buyer\") {\r\n                        Div(Class: panel-heading, Body: Активные лоты)\r\n                        DBFind(lots, src_lots).Count(tettttt2).Where(\"deleted=0 and status=2\").Custom(_bid){\r\n                            Form(pull-right){\r\n                                If(#type_bargain#==1){\r\n                                    If(#isMobile# == 0){\r\n                                        Div(input-group){\r\n                                            Input(Сlass: form-control, Name: StepRate,Type: number)\r\n                                            Div(input-group-btn){\r\n                                                DBFind(\"buyers\").Where(\"lot_id = #id#\").Order(\"amount DESC\").Vars(rate_hight_)\r\n                                                If(#rate_hight__buyer_id# == #key_id#){\r\n                                                    Button(Body: Сделать ставку, Class: btn btn-success disabled)\r\n                                                }.Else{\r\n                                                    Button(Body: Сделать ставку, Class: btn btn-success, Contract: AuctionProcess,Page:mobile_my_lots, Params:\"step_rate=Val(StepRate),lot_id=#id#\",PageParams: \"Id=#id#\")\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                    If(#isMobile# == 1){\r\n                                        Div(Class: col-md-12 col-xs-12){\r\n                                            Div(input-group-addon){\r\n                                                Div(Class: col-md-12 col-xs-12){\r\n                                                    Div(Class: list-group-item){\r\n                                                        Input(Name: StepRate, Type: number)\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                            Div(input-group-addon){\r\n                                                Div(Class: form-group){\r\n                                                    DBFind(\"buyers\").Where(\"lot_id = #id#\").Order(\"amount DESC\").Vars(rate_hight_)\r\n                                                    If(#rate_hight__buyer_id# == #key_id#){\r\n                                                        Button(Body: Сделать ставку, Class: btn btn-success disabled)\r\n                                                    }.Else{\r\n                                                        Button(Body: Сделать ставку, Class: btn btn-success, Contract: AuctionProcess,Page:mobile_my_lots, Params:\"step_rate=Val(StepRate),lot_id=#id#\",PageParams: \"Id=#id#\")\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                                If(And(#type_bargain#==2,#status#==2)){\r\n                                    Button(Class: btn btn-success pull-right,Body: \"Купить\",Contract:AuctionProcess,Page:lots_view,Params:\"step_rate=0,lot_id=#id#\",PageParams: \"Id=#id#\")\r\n                                }\r\n                            }\r\n                        }.Custom(_name){\r\n                            Div(text-left){\r\n                                LinkPage(Class: text-primary h5 text-bold, Page: lots_view, PageParams: \"Id=#id#\", Body: #name#)\r\n                            }\r\n                        }.Custom(_photo){\r\n                            Image(Src: Binary().ById(#photo#), Class:photo)\r\n                        }.Custom(_date_creation){\r\n                            DateTime(#date_creation#, DD.MM.YYYY)\r\n                        }.Custom(_date_start){\r\n                            DateTime(#date_start#, DD.MM.YY) \\ DateTime(#date_end#, DD.MM.YY)\r\n                        }.Custom(_date_end){\r\n                            DateTime(#date_end#, DD.MM.YYYY)\r\n                        }.Custom(_stps){\r\n                            If(#type_bargain# == 1){\r\n                                Div(Class:h6, Body:Money(#order_min#) \\ Money(#order_max#))\r\n                            }\r\n                            If(#type_bargain# == 2){\r\n                                Div(Class:h6, Body:\"-\")\r\n                            }\r\n                        }.Custom(_amount_starting){\r\n                            Money(#amount_starting#)\r\n                        }.Custom(_seller){\r\n                            Div(text-nowrap){\r\n                                DBFind(members).Columns(\"id,member_name,image_id\").Where(\"id=#seller#\").Vars(seller)\r\n                                If(Or(#seller_id#>0,#seller_id#<0)){\r\n                                }.Else{\r\n                                    SetVar(seller_member_name,Address(#seller#))\r\n                                }\r\n                                LinkPage(Class: center text-primary h5 text-bold, Page: profile_view, PageParams: \"v_member_id=#seller#\"){\r\n                                    If(#seller_image_id#>0){\r\n                                        Image(Src: Binary().ById(#seller_image_id#), Class: img-circle mr)\r\n                                    }.Else{\r\n                                        Div(Class: fa icon-user fa-2x mr)\r\n                                    }\r\n                                    Div(){#seller_member_name#}\r\n                                }\r\n                            }\r\n                        }.Custom(_amount_final){\r\n                            SetVar(status_index, Calculate(#status# + 1))\r\n                            SetVar(status_class,AppParam(App: #application_id#, Name: lots_status_classes, Index: #status_index#))\r\n                            If(#type_bargain# == 1){\r\n                                Div(#status_class#){\r\n                                    Money(#amount_max#)\r\n                                }\r\n                            }\r\n                            If(#type_bargain# == 2){\r\n                                Div(#status_class#){\r\n                                    Money(#amount_starting#)\r\n                                }\r\n                            }\r\n                        }\r\n                        Div(list-group-item text-center){\r\n                            Div(table-responsive){\r\n                                If(#tettttt2#>0){\r\n                                    Table(src_lots,\"ID=id,Название=_name,Продавец=_seller,Начало \\ Окончание=_date_start,Стартовая цена=_amount_starting,Шаг (Min\\Max)=_stps,Цена=_amount_final,Ставка=_bid\")\r\n                                }.Else{\r\n                                    Span(Лотов нет)\r\n                                }\r\n                            }.Style(\r\n                                th,td {text-align:center;}\r\n                                .img-circle {height: 30px;width: 30px; border: 1px solid #5A5D63;}\r\n                                .center {display:flex; align-items:center;}\r\n                                .photo {height: 30px; width: 30px;}\r\n                            )\r\n                        }\r\n                    }\r\n                }\r\n                Div(Class: panel panel-default) {\r\n                    Div(Class: panel-heading, Body: Завершенные лоты)\r\n                    If(#r_role_name#==\"Seller\") {\r\n                        DBFind(lots, src_lots).Count(tettttt).Where(\"seller=#key_id# and deleted=0 and status=4 and seller_sign=1\").Custom(_photo){\r\n                            Image(Src: Binary().ById(#photo#), Class:photo)\r\n                        }.Custom(_date_creation){\r\n                            DateTime(#date_creation#, DD.MM.YYYY)\r\n                        }.Custom(_date_start){\r\n                            DateTime(#date_start#, DD.MM.YY) \\ DateTime(#date_end#, DD.MM.YY)\r\n                        }.Custom(_date_end){\r\n                            DateTime(#date_end#, DD.MM.YYYY)\r\n                        }.Custom(_amount_starting){\r\n                            Money(#amount_starting#)\r\n                        }.Custom(_stps){\r\n                            If(#type_bargain# == 1){\r\n                                Div(Class:h6, Body:Money(#order_min#) \\ Money(#order_max#))\r\n                            }\r\n                            If(#type_bargain# == 2){\r\n                                Div(Class:h6, Body:\"-\")\r\n                            }\r\n                        }.Custom(_amount_final){\r\n                            SetVar(status_index, Calculate(#status# + 1))\r\n                            SetVar(status_class,AppParam(App: #application_id#, Name: lots_status_classes, Index: #status_index#))\r\n                            If(#type_bargain# == 1){\r\n                                Div(#status_class#){\r\n                                    Money(#amount_max#)\r\n                                }\r\n                            }\r\n                            If(#type_bargain# == 2){\r\n                                Div(#status_class#){\r\n                                    Money(#amount_starting#)\r\n                                }\r\n                            }\r\n                        }.Custom(_seller){\r\n                            Div(text-nowrap){\r\n                                DBFind(members).Columns(\"id,member_name,image_id\").Where(\"id=#seller#\").Vars(seller)\r\n                                If(Or(#seller_id#>0,#seller_id#<0)){\r\n                                }.Else{\r\n                                    SetVar(seller_member_name,Address(#seller#))\r\n                                }\r\n                                LinkPage(Class: center text-primary h5 text-bold, Page: profile_view, PageParams: \"v_member_id=#seller#\"){\r\n                                    If(#seller_image_id#>0){\r\n                                        Image(Src: Binary().ById(#seller_image_id#), Class: img-circle mr)\r\n                                    }.Else{\r\n                                        Div(Class: fa icon-user fa-2x mr)\r\n                                    }\r\n                                    Div(){#seller_member_name#}\r\n                                }\r\n                            }\r\n                        }.Custom(_name){\r\n                            Div(text-left){\r\n                                LinkPage(Class: text-primary h5 text-bold, Page: lots_view, PageParams: \"Id=#id#\", Body: #name#)\r\n                            }\r\n                        }.Custom(_status){\r\n                            SetVar(status_index, Calculate(#status# + 1))\r\n                            SetVar(status_class,AppParam(App: #application_id#, Name: lots_status_classes, Index: #status_index#))\r\n                            Div(#status_class#){\r\n                                AppParam(App: #application_id#, Name: lots_status, Index: #status_index#)\r\n                                SetVar(status_index, Calculate(#status# + 1))\r\n                            }\r\n                        }.Custom(_actions){\r\n                            If(#status#==4){\r\n                                Div(){\r\n                                    LinkPage(Body: Договор, Page: lots_view_contract, PageParams: \"Id=#id#\")\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    If(#r_role_name#==\"Buyer\") {\r\n                        DBFind(lots, src_lots).Count(tettttt).Where(\"buyer=#key_id# and deleted=0 and status=4 and buyer_sign=1\").Custom(_photo){\r\n                            Image(Src: Binary().ById(#photo#), Class:photo)\r\n                        }.Custom(_date_creation){\r\n                            DateTime(#date_creation#, DD.MM.YYYY)\r\n                        }.Custom(_date_start){\r\n                            DateTime(#date_start#, DD.MM.YY) \\ DateTime(#date_end#, DD.MM.YY)\r\n                        }.Custom(_date_end){\r\n                            DateTime(#date_end#, DD.MM.YYYY)\r\n                        }.Custom(_amount_starting){\r\n                            Money(#amount_starting#)\r\n                        }.Custom(_stps){\r\n                            If(#type_bargain# == 1){\r\n                                Div(Class:h6, Body:Money(#order_min#) \\ Money(#order_max#))\r\n                            }\r\n                            If(#type_bargain# == 2){\r\n                                Div(Class:h6, Body:\"-\")\r\n                            }\r\n                        }.Custom(_amount_final){\r\n                            SetVar(status_index, Calculate(#status# + 1))\r\n                            SetVar(status_class,AppParam(App: #application_id#, Name: lots_status_classes, Index: #status_index#))\r\n                            If(#type_bargain# == 1){\r\n                                Div(#status_class#){\r\n                                    Money(#amount_max#)\r\n                                }\r\n                            }\r\n                            If(#type_bargain# == 2){\r\n                                Div(#status_class#){\r\n                                    Money(#amount_starting#)\r\n                                }\r\n                            }\r\n                        }.Custom(_seller){\r\n                            Div(text-nowrap){\r\n                                DBFind(members).Columns(\"id,member_name,image_id\").Where(\"id=#seller#\").Vars(seller)\r\n                                If(Or(#seller_id#>0,#seller_id#<0)){\r\n                                }.Else{\r\n                                    SetVar(seller_member_name,Address(#seller#))\r\n                                }\r\n                                LinkPage(Class: center text-primary h5 text-bold, Page: profile_view, PageParams: \"v_member_id=#seller#\"){\r\n                                    If(#seller_image_id#>0){\r\n                                        Image(Src: Binary().ById(#seller_image_id#), Class: img-circle mr)\r\n                                    }.Else{\r\n                                        Div(Class: fa icon-user fa-2x mr)\r\n                                    }\r\n                                    Div(){#seller_member_name#}\r\n                                }\r\n                            }\r\n                        }.Custom(_name){\r\n                            Div(text-left){\r\n                                LinkPage(Class: text-primary h5 text-bold, Page: lots_view, PageParams: \"Id=#id#\", Body: #name#)\r\n                            }\r\n                        }.Custom(_status){\r\n                            SetVar(status_index, Calculate(#status# + 1))\r\n                            SetVar(status_class,AppParam(App: #application_id#, Name: lots_status_classes, Index: #status_index#))\r\n                            Div(#status_class#){\r\n                                AppParam(App: #application_id#, Name: lots_status, Index: #status_index#)\r\n                            }\r\n                        }.Custom(_actions){\r\n                            If(#status#==4){\r\n                                Div(){\r\n                                    LinkPage(Body: Договор, Page: lots_view_contract, PageParams: \"Id=#id#\")\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    If(#r_role_name#==\"Admin\") {\r\n                        DBFind(lots, src_lots).Count(tettttt).Where(\"deleted=0 or deleted=1 and status=4\").Custom(_photo){\r\n                            Image(Src: Binary().ById(#photo#), Class:photo)\r\n                        }.Custom(_date_creation){\r\n                            DateTime(#date_creation#, DD.MM.YYYY)\r\n                        }.Custom(_date_start){\r\n                            DateTime(#date_start#, DD.MM.YY) \\ DateTime(#date_end#, DD.MM.YY)\r\n                        }.Custom(_date_end){\r\n                            DateTime(#date_end#, DD.MM.YYYY)\r\n                        }.Custom(_amount_starting){\r\n                            Money(#amount_starting#)\r\n                        }.Custom(_stps){\r\n                            If(#type_bargain# == 1){\r\n                                Div(Class:h6, Body:Money(#order_min#) \\ Money(#order_max#))\r\n                            }\r\n                            If(#type_bargain# == 2){\r\n                                Div(Class:h6, Body:\"-\")\r\n                            }\r\n                        }.Custom(_amount_final){\r\n                            SetVar(status_index, Calculate(#status# + 1))\r\n                            SetVar(status_class,AppParam(App: #application_id#, Name: lots_status_classes, Index: #status_index#))\r\n                            If(#type_bargain# == 1){\r\n                                Div(#status_class#){\r\n                                    Money(#amount_max#)\r\n                                }\r\n                            }\r\n                            If(#type_bargain# == 2){\r\n                                Div(#status_class#){\r\n                                    Money(#amount_starting#)\r\n                                }\r\n                            }\r\n                        }.Custom(_seller){\r\n                            Div(text-nowrap){\r\n                                DBFind(members).Columns(\"id,member_name,image_id\").Where(\"id=#seller#\").Vars(seller)\r\n                                If(Or(#seller_id#>0,#seller_id#<0)){\r\n                                }.Else{\r\n                                    SetVar(seller_member_name,Address(#seller#))\r\n                                }\r\n                                LinkPage(Class: center text-primary h5 text-bold, Page: profile_view, PageParams: \"v_member_id=#seller#\"){\r\n                                    If(#seller_image_id#>0){\r\n                                        Image(Src: Binary().ById(#seller_image_id#), Class: img-circle mr)\r\n                                    }.Else{\r\n                                        Div(Class: fa icon-user fa-2x mr)\r\n                                    }\r\n                                    Div(){#seller_member_name#}\r\n                                }\r\n                            }\r\n                        }.Custom(_name){\r\n                            Div(text-left){\r\n                                LinkPage(Class: text-primary h5 text-bold, Page: lots_view, PageParams: \"Id=#id#\", Body: #name#)\r\n                            }\r\n                        }.Custom(_status){\r\n                            SetVar(status_index, Calculate(#status# + 1))\r\n                            SetVar(status_class,AppParam(App: #application_id#, Name: lots_status_classes, Index: #status_index#))\r\n                            Div(#status_class#){\r\n                                AppParam(App: #application_id#, Name: lots_status, Index: #status_index#)\r\n                            }\r\n                        }.Custom(_actions){\r\n                            If(#status#==4){\r\n                                Div(){\r\n                                    LinkPage(Body: Договор, Page: lots_view_contract, PageParams: \"Id=#id#\")\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(list-group-item text-center){\r\n                        Div(table-responsive){\r\n                            If(#tettttt#>0){\r\n                                Table(src_lots,\"ID=id,Название=_name,Продавец=_seller,Начало \\ Окончание=_date_start,Стартовая цена=_amount_starting,Шаг (Min\\Max)=_stps,Цена=_amount_final,Статус=_status,=_actions\")\r\n                            }.Else{\r\n                                Span(Лотов нет)\r\n                            }\r\n                        }.Style(\r\n                            th,td {text-align:center;}\r\n                            .img-circle {height: 30px;width: 30px; border: 1px solid #5A5D63;}\r\n                            .center {display:flex; align-items:center;}\r\n                            .photo {height: 30px; width: 30px;}\r\n                        )\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "platform_requests",
            "Conditions": "true",
            "Value": "Div(content-wrapper){\r\n    SetTitle($platform_requests$)\r\n    DBFind(Name: platform_requests, Source: platform_requests).Where(\"status = 0\").Custom(button){Button(Body: Принять, Class: btn btn-success, Contract: platform_Acceptance, Params:\"member_id=#member_id#, rname=#role#, requestID=#id#\")Button(Body: Отклонить, Class: btn btn-danger, Contract: platform_Decline, Params:\"id=#id#\")}\r\n    Form(panel panel-primary){\r\n        Div(panel-body){\r\n            Div(row){\r\n                Div(col-md-12){\r\n                    Table(Source: platform_requests, Columns: \"Имя=name_first,Фамилия=name_middle,Отчество=name_last,Профиль=member_name,ID=member_id,Компания=company_name,Должность=company_position,Роль=role,Решение=button\")\r\n                }\r\n            }\r\n        }\r\n    }\r\n}",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "platform_role_acceptance",
            "Conditions": "true",
            "Value": "Div(content-wrapper){\t\r\n\tDBFind(Name: notifications, Source: src_notific).Columns(\"page_params->request_id,sender->image_id,sender->member_id,sender->member_name,page_params->role\").Where(\"id = #notific_id#\").Vars(notific)\r\n    \r\n    If(#prefix_image_id#>0){\r\n        DBFind(Name: binaries, Source: src_binaries).Columns(\"id,data\").Where(\"id=#notific_sender_image_id#\").Vars(img)\r\n    }\r\n    \r\n    Div(row){\r\n        Div(col-sm-8 col-sm-offset-2 col-lg-6 col-lg-offset-3){\r\n            Form(panel panel-default){\r\n                Div(panel-heading text-center){\r\n                    Span(Class: h3, Body: Новый запрос на присвоение роли)\r\n                }\r\n                Div(panel-body){\r\n                    Div(form-group){\r\n                        Div(row){\r\n                            DBFind(Name: members, Source: src_member).Columns(\"id,image_id,member_name,name_first,name_middle,name_last,company_name,company_position,member_info->information\").Where(\"id=#notific_sender_member_id#\").Vars(prefix)\r\n                            Div(col-md-12 mt-sm text-center){\r\n\t\t\t\t\t\t\t\tIf(#prefix_image_id#>0){\r\n\t\t\t\t\t\t\t\t\tImage(Src: Binary().ById(#prefix_image_id#), Class: img-circle).Style(width: 80px; border: 1px solid #5A5D63;)\r\n\t\t\t\t\t\t\t\t}.Else{\r\n\t\t\t\t\t\t\t\t\tSpan(Class: fa icon-user fa-5x)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tDiv(m0 h3 text-bold){#notific_sender_member_name#}\r\n                                \r\n                                Div(Class: panel-heading, Body: Профиль кандидата)\r\n                                    Div(Class: list-group-item) {\r\n                                        Div(Class: row df f-valign) {\r\n                                            Div(Class: text-center) {\r\n                                                Label(Body: ID кандидата:)Span(Class: h5, Body: \" #prefix_id#\")\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                    Div(Class: list-group-item) {\r\n                                        Div(Class: row df f-valign) {\r\n                                            Div(Class: text-center) {\r\n                                                Label(Body: Системное имя:)Span(Class: h5, Body: \" #prefix_member_name#\")\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                    If(#prefix_name_first#>0){\r\n                                        Div(Class: list-group-item) {\r\n                                            Div(Class: row df f-valign) {\r\n                                            Div(Class: text-center) {\r\n                                                    Label(Body: Имя:)Span(Class: h5, Body: \" #prefix_name_first#\")\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                    If(#prefix_name_middle#>0){\r\n                                        Div(Class: list-group-item) {\r\n                                            Div(Class: row df f-valign) {\r\n                                            Div(Class: col-md-3 mt-sm text-center) {\r\n                                                    Label(Body: Фамилия:)Span(Class: h5, Body: \" #prefix_name_middle#\")\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                    If(#prefix_name_last#>0){\r\n                                        Div(Class: list-group-item) {\r\n                                            Div(Class: row df f-valign) {\r\n                                            Div(Class: text-center) {\r\n                                                    Label(Body: Отчество:)Span(Class: h5, Body: \" #prefix_name_last#\")\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                    If(#prefix_company_name#>0){\r\n                                        Div(Class: list-group-item) {\r\n                                            Div(Class: row df f-valign) {\r\n                                            Div(Class: text-center) {\r\n                                                    Label(Body: Компания:)Span(Class: h5, Body: \" #prefix_company_name#\")\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                    If(#prefix_company_position#>0){\r\n                                        Div(Class: list-group-item) {\r\n                                            Div(Class: row df f-valign) {\r\n                                                Div(Class: col-md-3 mt-sm text-center) {\r\n                                                    Label(Body: Должность:)Span(Class: h5, Body: \" #prefix_company_position#\")\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                    If(#prefix_member_info_information#>0){\r\n                                        Div(Class: list-group-item) {\r\n                                            Div(Class: row df f-valign) {\r\n                                                Div(Class: text-center) {\r\n                                                    Label(Body: О себе:)Span(Class: h5, Body: \" #prefix_member_info_information#\")\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(list-group-item text-center){\r\n                        If(#notific_page_params_role# == Buyer){\r\n                            Div(text-muted m0 h5, Body: Одобрить на роль \"Покупатель\")\r\n                        }\r\n                        If(#notific_page_params_role# == Seller){\r\n                            Div(text-muted m0 h5, Body: Одобрить на роль \"Продавец\")\r\n                        }\r\n                        If(And(#notific_page_params_role# != Buyer,#notific_page_params_role# != Seller)){\r\n                            Div(text-muted m0 h5, Body: \"Place role here as param\")\r\n                                Span(Class: h5 text-bold, Body: #notific_page_params_role#)\r\n                        }\r\n                    }\r\n\t\t\t\t\tDiv(list-group-item text-center){\r\n                        Button(Class: btn btn-success, Body: Принять, Contract: platform_Acceptance, Page: roles_list,  Params: \"rname=#notific_page_params_role#, member_id=#notific_sender_member_id#, notific_id=#notific_id#\")\r\n                        Button(Class: btn btn-danger, Body: Отказать, Contract: platform_Decline, Page: roles_list, Params: \"rname=#notific_page_params_role#, member_id=#notific_sender_member_id#, notific_id=#notific_id#\")\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "platform_role_fail",
            "Conditions": "true",
            "Value": "Div(content-wrapper){\r\n    Div(row){\r\n        Div(col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3){\r\n            Div(text-center){\r\n                If(#isMobile# == 0){\r\n                    Span(Class: icon-flag fa-5x text-danger)\r\n                }.Else{\r\n                    P(Class: text-danger text-center,Body: \"В запросе на присвоение роли отказано\")\r\n                }\r\n            }\r\n            Div(text-center){\r\n                Button(Class: btn btn-danger, Body: Отказано, Contract: notifications_Close, Page: profile_view, Params: \"notific_id=#notific_id#\")\r\n            }\r\n        }    \r\n    }\r\n}",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "platform_role_selection",
            "Conditions": "true",
            "Value": "Form(){\r\n    Div(row){\r\n        Div(col-md-3 mt-sm text-right){\r\n            Label(For: role){\r\n                Span(Body: \"Роль\")\r\n            }\r\n        }\r\n        Div(col-md-9 mc-sm text-left){\r\n            Div(form-group){\r\n                Data(roles,\"id,Roles,ru_roles\"){\r\n                    3,Buyer,Покупатель\r\n                    4,Seller,Продавец\r\n                }\r\n                Select(role,roles,ru_roles,Roles,Buyer)\r\n            }\r\n        }\r\n    }\r\n    Div(row){\r\n        Div(col-md-12 mc-sm text-center){\r\n            Button(Body: Закрыть, Class: btn btn-danger, Page: profile_view)\r\n            Button(Body: Подать, Class: btn btn-success, Contract: PlatformSingup, Page: profile_view)\r\n        }\r\n    }\r\n}",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "platform_role_success",
            "Conditions": "true",
            "Value": "Div(content-wrapper){\r\n    Div(row){\r\n        Div(col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3){\r\n            Div(text-center){\r\n                If(#isMobile# == 0){\r\n                    Span(Class: icon-check fa-5x text-success)\r\n                    P(Class: text-success,Body: \"Вы были добавлены в роль, авторизуйтесь заново с новой ролью\")\r\n                }.Else{\r\n                    P(Class: text-success,Body: \"Вы были добавлены в роль, авторизуйтесь заново с новой ролью\")\r\n                }\r\n                Button(Class: btn btn-success, Body: Успешно!, Contract: notifications_Close, Page: profile_view, Params: \"notific_id=#notific_id#\")\r\n            }\r\n        }\r\n    }\r\n}",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "platform_singup",
            "Conditions": "true",
            "Value": "Div(content-wrapper){\r\n    SetTitle($platform_singup$)\r\n    Div(breadcrumb){\r\n        LinkPage(\"Профиль\", profile_view)\r\n        Span(/).Style(margin-right: 10px; margin-left: 10px;)\r\n        Span(Class: text-muted, Body: $platform_singup$)\r\n    }\r\n    Div(row){\r\n        Div(col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3){\r\n            Form(panel panel-primary){\r\n                Div(panel-heading, Body: \"Регистрация\")\r\n                Div(panel-body){\r\n                If(And(#role_id#==4,#role_id#==3)){\r\n                        P(Body: \"Вам не требуется регистрация, поскольку вам доступны обе роли!\")\r\n                    }.Else{\r\n                    Div(list-group-item){\r\n                        Div(row){\r\n                            Div(col-md-3 mt-sm text-right){\r\n                                Label(For: name_first){\r\n                                    Span(Body: \"Имя\")\r\n                                    Span(Class: text-danger, Body:*)\r\n                                }\r\n                            }\r\n                            Div(col-md-9 mc-sm text-left){\r\n                                Input(Name: name_first).Validate(minLength:3, maxLength:60)\r\n                                InputErr(Name: name_first, minLength: $validate_name_first$, maxLength: $validate_name_first$)\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(list-group-item){\r\n                        Div(row){\r\n                            Div(col-md-3 mt-sm text-right){\r\n                                Label(For: name_middle){\r\n                                    Span(Body: \"Фамилия\")\r\n                                    Span(Class: text-danger, Body:*)\r\n                                }\r\n                            }\r\n                            Div(col-md-9 mc-sm text-left){\r\n                                Input(Name: name_middle).Validate(minLength:3, maxLength:60)\r\n                                InputErr(Name: name_middle, minLength: $validate_name_middle$, maxLength: $validate_name_middle$)\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(list-group-item){\r\n                        Div(row){\r\n                            Div(col-md-3 mt-sm text-right){\r\n                                Label(For: name_last){\r\n                                    Span(Body: \"Отчество\")\r\n                                    Span(Class: text-danger, Body:*)\r\n                                }\r\n                            }\r\n                            Div(col-md-9 mc-sm text-left){\r\n                                Input(Name: name_last).Validate(minLength:3, maxLength:60)\r\n                                InputErr(Name: name_last, minLength: $validate_name_last$, maxLength: $validate_name_last$)\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(list-group-item){\r\n                        Div(row){\r\n                            Div(col-md-3 mt-sm text-right){\r\n                                Label(For: company_name){\r\n                                    Span(Body: \"Компания\")\r\n                                    Span(Class: text-danger, Body:*)\r\n                                }\r\n                            }\r\n                            Div(col-md-9 mc-sm text-left){\r\n                                Input(Name: company_name).Validate(minLength:3, maxLength:60)\r\n                                InputErr(Name: company_name, minLength: $validate_company_name$, maxLength: $validate_company_name$)\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(list-group-item){\r\n                        Div(row){\r\n                            Div(col-md-3 mt-sm text-right){\r\n                                Label(For: company_position){\r\n                                    Span(Body: \"Должность\")\r\n                                    Span(Class: text-danger, Body:*)\r\n                                }\r\n                            }\r\n                            Div(col-md-9 mc-sm text-left){\r\n                                Input(Name: company_position).Validate(minLength:3, maxLength:60)\r\n                                InputErr(Name: company_position, minLength: $validate_company_position$, maxLength: $validate_company_position$)\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(list-group-item){\r\n                        Div(row){\r\n                            Div(col-md-3 mt-sm text-right){\r\n                                Label(For: member_name){\r\n                                    Span(Body: \"Профиль\")\r\n                                    Span(Class: text-danger, Body:*)\r\n                                }\r\n                            }\r\n                            Div(col-md-9 mc-sm text-left){\r\n                                DBFind(Name: members, Source: src_member).Columns(\"id,member_name,image_id,member_info->information\").Where(\"id=#key_id#\").Vars(prefix)\r\n                                   If(Or(#prefix_id#>0,#prefix_id#<0)){\r\n                                    Input(Name: member_name, Value: #prefix_member_name#, Disabled: true)\r\n                                }\r\n                            }\r\n                        }\r\n                    }  \r\n                    Div(list-group-item){\r\n                        Div(row){\r\n                            Div(col-md-3 mt-sm text-right){\r\n                                Label(For: role){\r\n                                    Span(Body: \"Роль\")\r\n                                    Span(Class: text-danger, Body:*)\r\n                                }\r\n                            }\r\n                            Div(col-md-9 mc-sm text-left){\r\n                                Div(form-group){\r\n                                    Data(roles,\"id,Roles\"){\r\n                                    8,Buyer\r\n                                    9,Seller\r\n                                    }\r\n                                    Select(role, roles, Roles)\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                Div(panel-footer text-right){\r\n                    Button(Body: \"Регистрация\", Class: btn btn-primary, Contract: platform_Singup, Params: \"member_id=#key_id#\")\r\n                }\r\n            }\r\n        }\r\n    }\r\n}",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "profile_add",
            "Conditions": "true",
            "Value": "Div(content-wrapper){\r\n    DBFind(buffer_data).Columns(\"value->id\").Where(\"key='avatar' and member_id=#key_id#\").Vars(avatar)\r\n    If(#avatar_value_id#>0){\r\n        SetVar(AvatarId,#avatar_value_id#)\r\n    }.Else{\r\n        SetVar(AvatarId,#prefix_image_id#)\r\n    }\r\n\r\n    Div(breadcrumb){\r\n        If(#avatar_value_id#>0){\r\n            Button(Body:Профиль, Page: profile_view, Class: btn btn-link p0, Contract:@1buffer_Manager, Params: \"Action=clean,Key=avatar\")\r\n        }.Else{\r\n            LinkPage(Профиль, profile_view)\r\n        }\r\n        Span(/).Style(margin-right: 10px; margin-left: 10px;)\r\n        Span(Class: text-muted, Body: Редактирование)\r\n    }\r\n\r\n\r\n    Div(row){\r\n        Div(col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3){\r\n            Form(panel panel-primary){\r\n                Div(panel-heading, Body: Редактирование профиля)\r\n                Div(panel-body){\r\n                    Div(list-group-item){\r\n                        Div(row){\r\n                            Div(col-md-3 mt-sm text-right){\r\n                                Label(For: name_first){\r\n                                    Span(Body: Имя)\r\n                                    Span(Class: text-danger, Body:*)\r\n                                }\r\n                            }\r\n                            Div(col-md-9 mc-sm text-left){\r\n                                Input(Name: name_first).Validate(minLength:3, maxLength:60)\r\n                                InputErr(Name: name_first, Value: \"#prefix_name_first#\", minLength: \"Значение не может быть менее 3-х букв!\", maxLength: \"Значение не может быть более 60-ти букв!\")\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(list-group-item){\r\n                        Div(row){\r\n                            Div(col-md-3 mt-sm text-right){\r\n                                Label(For: name_middle){\r\n                                    Span(Body: Фамилия)\r\n                                    Span(Class: text-danger, Body:*)\r\n                                }\r\n                            }\r\n                            Div(col-md-9 mc-sm text-left){\r\n                                Input(Name: name_middle).Validate(minLength:3, maxLength:60)\r\n                                InputErr(Name: name_middle, Value: \"#prefix_name_middle#\" minLength: \"Значение не может быть менее 3-х букв!\", maxLength: \"Значение не может быть более 60-ти букв!\")\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(list-group-item){\r\n                        Div(row){\r\n                            Div(col-md-3 mt-sm text-right){\r\n                                Label(For: name_last){\r\n                                    Span(Body: Отчество)\r\n                                    Span(Class: text-danger, Body:*)\r\n                                }\r\n                            }\r\n                            Div(col-md-9 mc-sm text-left){\r\n                                Input(Name: name_last).Validate(minLength:3, maxLength:60)\r\n                                InputErr(Name: name_last, Value: \"#prefix_name_last#\", minLength: \"Значение не может быть менее 3-х букв!\", maxLength: \"Значение не может быть более 60-ти букв!\")\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(list-group-item){\r\n                        Div(row){\r\n                            Div(col-md-3 mt-sm text-right){\r\n                                Label(For: company_name){\r\n                                    Span(Body: Компания)\r\n                                    Span(Class: text-danger, Body:*)\r\n                                }\r\n                            }\r\n                            Div(col-md-9 mc-sm text-left){\r\n                                Input(Name: company_name).Validate(minLength:3, maxLength:60)\r\n                                InputErr(Name: company_name, Value: \"#prefix_company_name#\", minLength: \"Значение не может быть менее 3-х букв!\", maxLength: \"Значение не может быть более 60-ти букв!\")\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(list-group-item){\r\n                        Div(row){\r\n                            Div(col-md-3 mt-sm text-right){\r\n                                Label(For: company_position){\r\n                                    Span(Body: Должность)\r\n                                    Span(Class: text-danger, Body:*)\r\n                                }\r\n                            }\r\n                            Div(col-md-9 mc-sm text-left){\r\n                                Input(Name: company_position).Validate(minLength:3, maxLength:60)\r\n                                InputErr(Name: company_position, Value: \"#prefix_company_position#\", minLength: \"Значение не может быть менее 3-х букв!\", maxLength: \"Значение не может быть более 60-ти букв!\")\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(list-group-item){\r\n                        Div(row){\r\n                            Div(col-md-3 mt-sm text-right){\r\n                                Label(For: member_name){\r\n                                    Span(Body: Системное имя)\r\n                                    Span(Class: text-danger, Body:*)\r\n                                }\r\n                            }\r\n                            Div(col-md-9 mc-sm text-left){\r\n                                If(Or(#prefix_id#>0,#prefix_id#<0)){\r\n                                    Input(Name: member_name, Value: #prefix_member_name#, Disabled: true)\r\n                                }.Else{\r\n                                    Input(Name: member_name).Validate(minLength:5, maxLength:20)\r\n                                    InputErr(Name: member_name, minLength: \"Значение не может быть менее 5-ти букв!\", maxLength: \"Значение не может быть более 20-ти букв!\")\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    If(#isMobile# == 0){\r\n                        Div(list-group-item){\r\n                            Div(row){\r\n                                Div(col-md-3 mt-sm text-right){\r\n                                    Strong(Аватар)\r\n                                }\r\n                                Div(col-md-9 mc-sm text-left){\r\n                                    If(#AvatarId#>0){\r\n                                        Image(Src:Binary().ById(#AvatarId#), Class: big_photo)\r\n                                    }\r\n                                    Div(mt-sm){\r\n                                        If(#AvatarId#>0){\r\n                                            Button(Body: \"Загрузить новый аватар\", Page: profile_upload_photo, PageParams: \"From=add\", Class: btn btn-link p0).Popup(45, \"Загрузка изображения\")\r\n                                        }.Else{\r\n                                            Button(Body: \"Загрузить аватар\", Page:  profile_upload_photo, PageParams: \"From=add\", Class: btn btn-link p0).Popup(45, \"Загрузка изображения\")\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(list-group-item){\r\n                        Div(row){\r\n                            Div(col-md-3 mt-lg text-right){\r\n                                Label(For: information){\r\n                                    Span(Body: Информация)\r\n                                }\r\n                            }\r\n                            Div(col-md-9 mc-sm text-left){\r\n                                If(GetVar(prefix_member_info_information)){\r\n                                    Input(Name: information, Type: textarea, Value: #prefix_member_info_information#)\r\n                                }.Else{\r\n                                    Input(Name: information, Type: textarea)\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                Div(panel-footer text-right){\r\n                    Button(Body: Отправить, Class: btn btn-primary, Contract: Profile_Edit, Page: profile_view, Params: \"ismobile=#isMobile#,member_id=#key_id#,image_id=#AvatarId#\").Alert(Text: Хотите внести изменения?, ConfirmButton: Да, CancelButton: Нет, Icon: question)\r\n                }\r\n            }\r\n        }\r\n    }\r\n}.Style(\r\n    .big_photo {height: 300px; max-width: 100%;}\r\n)",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "profile_edit",
            "Conditions": "ContractAccess(\"@1EditPage\")",
            "Value": "Div(content-wrapper){\r\n    DBFind(members, src_member).Columns(\"id,image_id,member_name,name_first,name_middle,name_last,company_name,company_position,member_info->information\").Where(\"id=#key_id#\").Vars(prefix)\r\n    If(Or(#prefix_id#>0,#prefix_id#<0)){\r\n    }.Else{\r\n        SetVar(prefix_member_name,)\r\n    }\r\n    DBFind(buffer_data).Columns(\"value->id\").Where(\"key='avatar' and member_id=#key_id#\").Vars(avatar)\r\n    If(#avatar_value_id#>0){\r\n        SetVar(AvatarId,#avatar_value_id#)\r\n    }.Else{\r\n        SetVar(AvatarId,#prefix_image_id#)\r\n    }\r\n\r\n    Div(breadcrumb){\r\n        If(#avatar_value_id#>0){\r\n            Button(Body:Профиль, Page: profile_view, Class: btn btn-link p0, Contract:@1buffer_Manager, Params: \"Action=clean,Key=avatar\")\r\n        }.Else{\r\n            LinkPage(Профиль, profile_view)\r\n        }\r\n        Span(/).Style(margin-right: 10px; margin-left: 10px;)\r\n        Span(Class: text-muted, Body: Редактирование)\r\n    }\r\n    Div(row){\r\n        Div(col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3){\r\n            Form(panel panel-primary){\r\n                Div(panel-heading, Body: Редактирование профиля)\r\n                Div(panel-body){\r\n                    Div(list-group-item){\r\n                        Div(row){\r\n                            Div(col-md-3 col-xs-3 mt-sm text-right){\r\n                                Label(For: name_first){\r\n                                    Span(Body: Имя)\r\n                                    Span(Class: text-danger, Body:*)\r\n                                }\r\n                            }\r\n                            Div(col-md-9 col-xs-9 mc-sm text-left){\r\n                                Input(Name: name_first, Value: \"#prefix_name_first#\").Validate(minLength:3, maxLength:60)\r\n                                InputErr(Name: name_first, Value: \"#prefix_name_first#\", minLength: \"Значение не может быть менее 3-х букв!\", maxLength: \"Значение не может быть более 60-ти букв!\")\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(list-group-item){\r\n                        Div(row){\r\n                            Div(col-md-3 col-xs-3 mt-sm text-right){\r\n                                Label(For: name_middle){\r\n                                    Span(Body: Фамилия)\r\n                                    Span(Class: text-danger, Body:*)\r\n                                }\r\n                            }\r\n                            Div(col-md-9 col-xs-9 mc-sm text-left){\r\n                                Input(Name: name_middle, Value: \"#prefix_name_middle#\").Validate(minLength:3, maxLength:60)\r\n                                InputErr(Name: name_middle, Value: \"#prefix_name_middle#\" minLength: \"Значение не может быть менее 3-х букв!\", maxLength: \"Значение не может быть более 60-ти букв!\")\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(list-group-item){\r\n                        Div(row){\r\n                            Div(col-md-3 col-xs-3 mt-sm text-right){\r\n                                Label(For: name_last){\r\n                                    Span(Body: Отчество)\r\n                                    Span(Class: text-danger, Body:*)\r\n                                }\r\n                            }\r\n                            Div(col-md-9 col-xs-9 mc-sm text-left){\r\n                                Input(Name: name_last, Value: \"#prefix_name_last#\").Validate(minLength:3, maxLength:60)\r\n                                InputErr(Name: name_last, Value: \"#prefix_name_last#\", minLength: \"Значение не может быть менее 3-х букв!\", maxLength: \"Значение не может быть более 60-ти букв!\")\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(list-group-item){\r\n                        Div(row){\r\n                            Div(col-md-3 col-xs-3 mt-sm text-right){\r\n                                Label(For: company_name){\r\n                                    Span(Body: Компания)\r\n                                    Span(Class: text-danger, Body:*)\r\n                                }\r\n                            }\r\n                            Div(col-md-9 col-xs-9 mc-sm text-left){\r\n                                Input(Name: company_name, Value: \"#prefix_company_name#\").Validate(minLength:3, maxLength:60)\r\n                                InputErr(Name: company_name, Value: \"#prefix_company_name#\", minLength: \"Значение не может быть менее 3-х букв!\", maxLength: \"Значение не может быть более 60-ти букв!\")\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(list-group-item){\r\n                        Div(row){\r\n                            Div(col-md-3 col-xs-3 mt-sm text-right){\r\n                                Label(For: company_position){\r\n                                    Span(Body: Должность)\r\n                                    Span(Class: text-danger, Body:*)\r\n                                }\r\n                            }\r\n                            Div(col-md-9 col-xs-9 mc-sm text-left){\r\n                                Input(Name: company_position, Value: \"#prefix_company_position#\").Validate(minLength:3, maxLength:60)\r\n                                InputErr(Name: company_position, Value: \"#prefix_company_position#\", minLength: \"Значение не может быть менее 3-х букв!\", maxLength: \"Значение не может быть более 60-ти букв!\")\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(list-group-item){\r\n                        Div(row){\r\n                            Div(col-md-3 col-xs-3 mt-sm text-right){\r\n                                Label(For: member_name){\r\n                                    Span(Body: Системное имя)\r\n                                    Span(Class: text-danger, Body:*)\r\n                                }\r\n                            }\r\n                            Div(col-md-9 col-xs-9 mc-sm text-left){\r\n                                If(Or(#prefix_id#>0,#prefix_id#<0)){\r\n                                    Input(Name: member_name, Value: #prefix_member_name#, Disabled: true)\r\n                                }.Else{\r\n                                    Input(Name: member_name).Validate(minLength:5, maxLength:20)\r\n                                    InputErr(Name: member_name, minLength: \"Значение не может быть менее 5-ти букв!\", maxLength: \"Значение не может быть более 20-ти букв!\")\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    If(#isMobile# == 0){\r\n                        Div(list-group-item){\r\n                            Div(row){\r\n                                Div(col-md-3 col-xs-3 mt-sm text-right){\r\n                                    Strong(Аватар)\r\n                                }\r\n                                Div(col-md-9 col-xs-9 mc-sm text-left){\r\n                                    If(#AvatarId#>0){\r\n                                        Image(Src:Binary().ById(#AvatarId#), Class: big_photo)\r\n                                    }\r\n                                    Div(mt-sm){\r\n                                        If(#AvatarId#>0){\r\n                                            Button(Body: \"Загрузить новый аватар\", Page: profile_upload_photo, Class: btn btn-link p0).Popup(45, \"Загрузка изображения\")\r\n                                        }.Else{\r\n                                            Button(Body: \"Загрузить аватар\", Page:  profile_upload_photo, Class: btn btn-link p0).Popup(45, \"Загрузка изображения\")\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(list-group-item){\r\n                        Div(row){\r\n                            Div(col-md-3 mt-lg text-right){\r\n                                Label(For: information){\r\n                                    Span(Body: Информация)\r\n                                }\r\n                            }\r\n                            Div(col-md-9 col-xs-9 mc-sm text-left){\r\n                                If(GetVar(prefix_member_info_information)){\r\n                                    Input(Name: information, Type: textarea, Value: #prefix_member_info_information#)\r\n                                }.Else{\r\n                                    Input(Name: information, Type: textarea)\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                Div(panel-footer text-right){\r\n                    Button(Body: Отправить, Class: btn btn-primary, Contract: Profile_Edit, Page: profile_view, Params: \"ismobile=#isMobile#,member_id=#key_id#,image_id=#AvatarId#\").Alert(Text: Хотите внести изменения?, ConfirmButton: Да, CancelButton: Нет, Icon: question)\r\n                }\r\n            }\r\n        }\r\n    }\r\n}.Style(\r\n    .big_photo {height: 300px; max-width: 100%;}\r\n)",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "profile_upload_photo",
            "Conditions": "true",
            "Value": "SetVar(redirect_page,profile_edit)\r\nIf(#From#==\"add\"){\r\n    SetVar(redirect_page,profile_add)\r\n}\r\n\r\nForm(content-wrapper){\r\n    Div(form-group){\r\n        Input(Name: Photo, Type: file)\r\n    }\r\n    Div(form-group){\r\n        Button(Body: \"Назад\", Class: btn btn-default, Page: #redirect_page#)\r\n        Button(Body: \"Готово\", Class: btn btn-primary pull-right, Page: #redirect_page#, Contract: ProfileUploadPhoto)\r\n    }\r\n}",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "profile_view",
            "Conditions": "ContractAccess(\"@1EditPage\")",
            "Value": "Div(content-wrapper){\r\n    If(Or(#v_member_id#>0,#v_member_id#<0)){\r\n    }.Else{\r\n        SetVar(Name: v_member_id, Value: #key_id#)\r\n    }\r\n    DBFind(Name: members, Source: src_member).Columns(\"id,image_id,member_name,name_first,name_middle,name_last,company_name,company_position,member_info->information\").Where(\"id=#v_member_id#\").Vars(prefix)\r\n    DBFind(roles).Where(\"id=#role_id#\").Columns(\"role_name\").Vars(r)\r\n    DBFind(applications).Columns(\"id\").Where(\"name='Trading Platform' AND deleted=0\").Vars(application)\r\n    If(Or(#prefix_id#>0,#prefix_id#<0)){\r\n        Div(row){\r\n            Div(Class: col-sm-3 mt-sm text-center){\r\n                If(#prefix_image_id#>0){\r\n                    Image(Src: Binary().ById(#prefix_image_id#)).Style(margin-bottom: 15px; height: 220px; border: 1px solid #5A5D63;)\r\n                }.Else{\r\n                    Span(Class: fa icon-user fa-5x text-primary).Style(margin-bottom: 15px;)\r\n                }\r\n            }\r\n            Div(Class: col-md-4 col-xs-4 mt-sm){\r\n\r\n                Div(Class: panel panel-primary) {\r\n                    Div(Class: list-group-item text-left) {\r\n                        Span(Class: text-bold h4, Body: Системное имя:)Span(Class: h4, Body: \"#prefix_member_name#\").Style(margin-left: 5px;)\r\n                    }\r\n                    If(#prefix_name_first# != \"\"){\r\n                        Div(Class: list-group-item text-left) {\r\n                            Span(Class: text-bold, Body: Имя:)Span(Class: h5, Body: \"#prefix_name_first#\").Style(margin-left: 5px;)\r\n                        }\r\n                    }\r\n                    If(#prefix_name_middle# != \"\"){\r\n                        Div(Class: list-group-item text-left) {\r\n                            Span(Class: text-bold, Body: Фамилия:)Span(Class: h5, Body: \"#prefix_name_middle#\").Style(margin-left: 5px;)\r\n                        }\r\n                    }\r\n                    If(#prefix_name_last# != \"\"){\r\n                        Div(Class: list-group-item text-left) {\r\n                            Span(Class: text-bold, Body: Отчество:)Span(Class: h5, Body: \"#prefix_name_last#\").Style(margin-left: 5px;)\r\n                        }\r\n                    }\r\n                    If(#prefix_company_name# != \"\"){\r\n                        Div(Class: list-group-item text-left) {\r\n                            Span(Class: text-bold, Body: Компания:)Span(Class: h5, Body: \"#prefix_company_name#\").Style(margin-left: 5px;)\r\n                        }\r\n                    }\r\n                    If(#prefix_company_position# != \"\"){\r\n                        Div(Class: list-group-item text-left) {\r\n                            Span(Class: text-bold, Body: Должность:)Span(Class: h5, Body: \"#prefix_company_position#\").Style(margin-left: 5px;)\r\n                        }\r\n                    }\r\n                    If(#prefix_id# == #key_id#){\r\n                        Div(Class: panel-footer text-center) {\r\n                            Button(Class: btn btn-link, Page: profile_edit, Body: Редактировать)\r\n                        }\r\n                    }\r\n                }.Style(height: 310px;)\r\n            }\r\n            Div(Class: col-md-5 col-xs-5 mt-sm){\r\n                Div(Class: panel panel-primary){\r\n                    DBFind(Name: roles_participants, Source: src_check).Columns(\"id\").Where(\"member->member_id='#v_member_id#' and deleted=0\").Vars(check)\r\n                    If(#check_id#>0){\r\n                        Div(Class: list-group-item text-left) {\r\n                            Span(Class: text-bold h4, Body: Текущая роль:)Span(Class: h4){\r\n                                If(#r_role_name#==\"Seller\"){\r\n                                    LangRes(Продавец)\r\n                                }\r\n                                If(#r_role_name#==\"Buyer\"){\r\n                                    LangRes(Покупатель)\r\n                                }\r\n                                If(#r_role_name#==\"Admin\"){\r\n                                    LangRes(Администратор)\r\n                                }\r\n                            }.Style(margin-left: 5px;)\r\n                        }\r\n                        DBFind(Name: keys, Source: src_keys).Where(\"id=#v_member_id#\").Vars(tokens)\r\n                        Div(Class: list-group-item text-left) {\r\n                            Span(Class: text-bold, Body: Аккаунт:)Span(Class: h5, Body: Address(#tokens_id#)).Style(margin-left: 5px;)\r\n                        }\r\n                        Div(Class: list-group-item text-left) {\r\n                            SetVar(dd, Money(#tokens_amount#))\r\n                            Span(Class: text-bold, Body: Баланс:)Span(Class: h5, Body: Calculate(#dd#,money,0)).Style(margin-left: 5px;)\r\n                        }\r\n                        Div(Class: list-group-item text-left) {\r\n                            Span(Class: text-bold, Body: Депозит:)Span(Class: h5, Body: Money(#tokens_deposit#)).Style(margin-left: 5px;)\r\n                        }\r\n                        DBFind(Name: roles_participants, Source: src_roles).Columns(\"role->id,role->name\").Where(\"member->member_id='#v_member_id#' and deleted=0\").Order(\"id\")\r\n                        Div(Class: list-group-item) {\r\n                            Div(Class: row df f-valign) {\r\n                                Div(Class: text-center) {\r\n                                    Label(Body: Роли:)\r\n                                    ForList(src_roles){\r\n                                        LinkPage(Page: roles_view, PageParams: \"v_role_id=#role.id#\"){\r\n                                            Span(Class: h5, Body: LangRes(#role.name#)).Style(margin-left: 5px; margin-right: 5px;)\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    If(#prefix_id# == #key_id#){\r\n                        Div(Class: panel-footer text-center) {\r\n                            DBFind(Name: roles_participants, Source: src_roles).Columns(\"role->id,role->name\").Where(\"member->member_id='#v_member_id#' and deleted=0\").Vars(valid)\r\n                            If(And(#valid_role_name#==\"Seller\",#valid_role_name#==\"Buyer\")){\r\n                            }.Else{\r\n                                Button(Class: btn btn-link, Page: platform_role_selection, Body: Подать заявку на роль).Popup(35, Выбор роли)\r\n                            }\r\n                            Button(Class: btn btn-link, Page: tokens_transfer, Body: Перевод средств).Popup(50, Укажите адресата)\r\n                        }\r\n                    }\r\n                }.Style(height: 310px;)\r\n            }\r\n        }\r\n        If(#isMobile# == 0){\r\n            If(#prefix_id# == #key_id#){\r\n                Div(Class: panel panel-default){\r\n                    If(#r_role_name#==\"Seller\"){\r\n                        Div(Class: panel-heading, Body: Активные лоты)\r\n                        DBFind(lots, src_lots).Count(tettttt).Where(\"seller=#key_id# and deleted=0 and status=2 \").Custom(_photo){\r\n                            Image(Src: Binary().ById(#photo#), Class:photo)\r\n                        }.Custom(_date_creation){\r\n                            DateTime(#date_creation#, DD.MM.YYYY)\r\n                        }.Custom(_date_start){\r\n                            DateTime(#date_start#, DD.MM.YY) / DateTime(#date_end#, DD.MM.YY)\r\n                        }.Custom(_date_end){\r\n                            DateTime(#date_end#, DD.MM.YYYY)\r\n                        }.Custom(_amount_starting){\r\n                            Money(#amount_starting#)\r\n                        }.Custom(_stps){\r\n                            If(#type_bargain# == 1){\r\n                                Div(Class:h6, Body:Money(#order_min#) / Money(#order_max#))\r\n                            }\r\n                            If(#type_bargain# == 2){\r\n                                Div(Class:h6, Body:\"-\")\r\n                            }\r\n                        }.Custom(_amount_final){\r\n                            SetVar(status_index, Calculate(#status# + 1))\r\n                            SetVar(status_class,AppParam(App: #application_id#, Name: lots_status_classes, Index: #status_index#))\r\n                            If(#type_bargain# == 1){\r\n                                Div(#status_class#){\r\n                                    Money(#amount_max#)\r\n                                }\r\n                            }\r\n                            If(#type_bargain# == 2){\r\n                                Div(#status_class#){\r\n                                    Money(#amount_starting#)\r\n                                }\r\n                            }\r\n                        }.Custom(_seller){\r\n                            Div(text-nowrap){\r\n                                DBFind(members).Columns(\"id,member_name,image_id\").Where(\"id=#seller#\").Vars(seller)\r\n                                If(Or(#seller_id#>0,#seller_id#<0)){\r\n                                }.Else{\r\n                                    SetVar(seller_member_name,Address(#seller#))\r\n                                }\r\n                                LinkPage(Class: center text-primary h5 text-bold, Page: profile_view, PageParams: \"v_member_id=#seller#\"){\r\n                                    If(#seller_image_id#>0){\r\n                                        Image(Src: Binary().ById(#seller_image_id#), Class: img-circle mr)\r\n                                    }.Else{\r\n                                        Div(Class: fa icon-user fa-2x mr)\r\n                                    }\r\n                                    Div(){#seller_member_name#}\r\n                                }\r\n                            }\r\n                        }.Custom(_name){\r\n                            Div(text-left){\r\n                                LinkPage(Class: text-primary h5 text-bold, Page: lots_view, PageParams: \"Id=#id#\", Body: #name#)\r\n                            }\r\n                        }\r\n                        Div(list-group-item text-center){\r\n                            Div(table-responsive){\r\n                                If(#tettttt#>0){\r\n                                    Table(src_lots,\"ID=id,Название=_name,Продавец=_seller,Начало / Окончание=_date_start,Стартовая цена=_amount_starting,Шаг (Min/Max)=_stps,Цена=_amount_final\")\r\n                                }.Else{\r\n                                    Span(Лотов нет)\r\n                                }\r\n                            }.Style(\r\n                                th,td {text-align:center;}\r\n                                .img-circle {height: 30px;width: 30px; border: 1px solid #5A5D63;}\r\n                                .center {display:flex; align-items:center;}\r\n                                .photo {height: 30px; width: 30px;}\r\n                            )\r\n                        }\r\n                    }\r\n                    If(#r_role_name#==\"Buyer\") {\r\n                        Div(Class: panel-heading, Body: Активные лоты)\r\n                        DBFind(lots, src_lots).Count(tettttt2).Where(\"deleted=0 and status=2\").Custom(_bid){\r\n                            Form(pull-right){\r\n                                If(#type_bargain#==1){\r\n                                    If(#isMobile# == 0){\r\n                                        Div(input-group){\r\n                                            Input(Сlass: form-control, Name: StepRate,Type: number)\r\n                                            Div(input-group-btn){\r\n                                                DBFind(\"buyers\").Where(\"lot_id = #id#\").Order(\"amount DESC\").Vars(rate_hight_)\r\n                                                If(#rate_hight__buyer_id# == #key_id#){\r\n                                                    Button(Body: Сделать ставку, Class: btn btn-success disabled)\r\n                                                }.Else{\r\n                                                    Button(Body: Сделать ставку, Class: btn btn-success, Contract: AuctionProcess,Page:profile_view, Params:\"step_rate=Val(StepRate),lot_id=#id#\",PageParams: \"Id=#id#\")\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                    If(#isMobile# == 1){\r\n                                        Div(Class: col-md-12 col-xs-12){\r\n                                            Div(input-group-addon){\r\n                                                Div(Class: col-md-12 col-xs-12){\r\n                                                    Div(Class: list-group-item){\r\n                                                        Input(Name: StepRate, Type: number)\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                            Div(input-group-addon){\r\n                                                Div(Class: form-group){\r\n                                                    DBFind(\"buyers\").Where(\"lot_id = #id#\").Order(\"amount DESC\").Vars(rate_hight_)\r\n                                                    If(#rate_hight__buyer_id# == #key_id#){\r\n                                                        Button(Body: Сделать ставку, Class: btn btn-success disabled)\r\n                                                    }.Else{\r\n                                                        Button(Body: Сделать ставку, Class: btn btn-success, Contract: AuctionProcess,Page:profile_view, Params:\"step_rate=Val(StepRate),lot_id=#id#\",PageParams: \"Id=#id#\")\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                                If(And(#type_bargain#==2,#status#==2)){\r\n                                    Button(Class: btn btn-success pull-right,Body: \"Купить\",Contract:AuctionProcess,Page:lots_view,Params:\"step_rate=0,lot_id=#id#\",PageParams: \"Id=#id#\")\r\n                                }\r\n                            }\r\n                        }.Custom(_name){\r\n                            Div(text-left){\r\n                                LinkPage(Class: text-primary h5 text-bold, Page: lots_view, PageParams: \"Id=#id#\", Body: #name#)\r\n                            }\r\n                        }.Custom(_photo){\r\n                            Image(Src: Binary().ById(#photo#), Class:photo)\r\n                        }.Custom(_date_creation){\r\n                            DateTime(#date_creation#, DD.MM.YYYY)\r\n                        }.Custom(_date_start){\r\n                            DateTime(#date_start#, DD.MM.YY) / DateTime(#date_end#, DD.MM.YY)\r\n                        }.Custom(_date_end){\r\n                            DateTime(#date_end#, DD.MM.YYYY)\r\n                        }.Custom(_stps){\r\n                            If(#type_bargain# == 1){\r\n                                Div(Class:h6, Body:Money(#order_min#) / Money(#order_max#))\r\n                            }\r\n                            If(#type_bargain# == 2){\r\n                                Div(Class:h6, Body:\"-\")\r\n                            }\r\n                        }.Custom(_amount_starting){\r\n                            Money(#amount_starting#)\r\n                        }.Custom(_seller){\r\n                            Div(text-nowrap){\r\n                                DBFind(members).Columns(\"id,member_name,image_id\").Where(\"id=#seller#\").Vars(seller)\r\n                                If(Or(#seller_id#>0,#seller_id#<0)){\r\n                                }.Else{\r\n                                    SetVar(seller_member_name,Address(#seller#))\r\n                                }\r\n                                LinkPage(Class: center text-primary h5 text-bold, Page: profile_view, PageParams: \"v_member_id=#seller#\"){\r\n                                    If(#seller_image_id#>0){\r\n                                        Image(Src: Binary().ById(#seller_image_id#), Class: img-circle mr)\r\n                                    }.Else{\r\n                                        Div(Class: fa icon-user fa-2x mr)\r\n                                    }\r\n                                    Div(){#seller_member_name#}\r\n                                }\r\n                            }\r\n                        }.Custom(_amount_final){\r\n                            SetVar(status_index, Calculate(#status# + 1))\r\n                            SetVar(status_class,AppParam(App: #application_id#, Name: lots_status_classes, Index: #status_index#))\r\n                            If(#type_bargain# == 1){\r\n                                Div(#status_class#){\r\n                                    Money(#amount_max#)\r\n                                }\r\n                            }\r\n                            If(#type_bargain# == 2){\r\n                                Div(#status_class#){\r\n                                    Money(#amount_starting#)\r\n                                }\r\n                            }\r\n                        }\r\n                        Div(list-group-item text-center){\r\n                            Div(table-responsive){\r\n                                If(#tettttt2#>0){\r\n                                    Table(src_lots,\"ID=id,Название=_name,Продавец=_seller,Начало / Окончание=_date_start,Стартовая цена=_amount_starting,Шаг (Min/Max)=_stps,Цена=_amount_final,Ставка=_bid\")\r\n                                }.Else{\r\n                                    Span(Лотов нет)\r\n                                }\r\n                            }.Style(\r\n                                th,td {text-align:center;}\r\n                                .img-circle {height: 30px;width: 30px; border: 1px solid #5A5D63;}\r\n                                .center {display:flex; align-items:center;}\r\n                                .photo {height: 30px; width: 30px;}\r\n                            )\r\n                        }\r\n                    }\r\n                }\r\n                Div(Class: panel panel-default) {\r\n                    Div(Class: panel-heading, Body: Завершенные лоты)\r\n                    If(#r_role_name#==\"Seller\") {\r\n                        DBFind(lots, src_lots).Count(tettttt).Where(\"seller=#key_id# and deleted=0 and status=4 and seller_sign=1\").Custom(_photo){\r\n                            Image(Src: Binary().ById(#photo#), Class:photo)\r\n                        }.Custom(_date_creation){\r\n                            DateTime(#date_creation#, DD.MM.YYYY)\r\n                        }.Custom(_date_start){\r\n                            DateTime(#date_start#, DD.MM.YY) / DateTime(#date_end#, DD.MM.YY)\r\n                        }.Custom(_date_end){\r\n                            DateTime(#date_end#, DD.MM.YYYY)\r\n                        }.Custom(_amount_starting){\r\n                            Money(#amount_starting#)\r\n                        }.Custom(_stps){\r\n                            If(#type_bargain# == 1){\r\n                                Div(Class:h6, Body:Money(#order_min#) / Money(#order_max#))\r\n                            }\r\n                            If(#type_bargain# == 2){\r\n                                Div(Class:h6, Body:\"-\")\r\n                            }\r\n                        }.Custom(_amount_final){\r\n                            SetVar(status_index, Calculate(#status# + 1))\r\n                            SetVar(status_class,AppParam(App: #application_id#, Name: lots_status_classes, Index: #status_index#))\r\n                            If(#type_bargain# == 1){\r\n                                Div(#status_class#){\r\n                                    Money(#amount_max#)\r\n                                }\r\n                            }\r\n                            If(#type_bargain# == 2){\r\n                                Div(#status_class#){\r\n                                    Money(#amount_starting#)\r\n                                }\r\n                            }\r\n                        }.Custom(_seller){\r\n                            Div(text-nowrap){\r\n                                DBFind(members).Columns(\"id,member_name,image_id\").Where(\"id=#seller#\").Vars(seller)\r\n                                If(Or(#seller_id#>0,#seller_id#<0)){\r\n                                }.Else{\r\n                                    SetVar(seller_member_name,Address(#seller#))\r\n                                }\r\n                                LinkPage(Class: center text-primary h5 text-bold, Page: profile_view, PageParams: \"v_member_id=#seller#\"){\r\n                                    If(#seller_image_id#>0){\r\n                                        Image(Src: Binary().ById(#seller_image_id#), Class: img-circle mr)\r\n                                    }.Else{\r\n                                        Div(Class: fa icon-user fa-2x mr)\r\n                                    }\r\n                                    Div(){#seller_member_name#}\r\n                                }\r\n                            }\r\n                        }.Custom(_name){\r\n                            Div(text-left){\r\n                                LinkPage(Class: text-primary h5 text-bold, Page: lots_view, PageParams: \"Id=#id#\", Body: #name#)\r\n                            }\r\n                        }.Custom(_status){\r\n                            SetVar(status_index, Calculate(#status# + 1))\r\n                            SetVar(status_class,AppParam(App: #application_id#, Name: lots_status_classes, Index: #status_index#))\r\n                            Div(#status_class#){\r\n                                AppParam(App: #application_id#, Name: lots_status, Index: #status_index#)\r\n                                SetVar(status_index, Calculate(#status# + 1))\r\n                            }\r\n                        }.Custom(_actions){\r\n                            If(#status#==4){\r\n                                Div(){\r\n                                    LinkPage(Body: Договор, Page: lots_view_contract, PageParams: \"Id=#id#\")\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    If(#r_role_name#==\"Buyer\") {\r\n                        DBFind(lots, src_lots).Count(tettttt).Where(\"buyer=#key_id# and deleted=0 and status=4 and buyer_sign=1\").Custom(_photo){\r\n                            Image(Src: Binary().ById(#photo#), Class:photo)\r\n                        }.Custom(_date_creation){\r\n                            DateTime(#date_creation#, DD.MM.YYYY)\r\n                        }.Custom(_date_start){\r\n                            DateTime(#date_start#, DD.MM.YY) / DateTime(#date_end#, DD.MM.YY)\r\n                        }.Custom(_date_end){\r\n                            DateTime(#date_end#, DD.MM.YYYY)\r\n                        }.Custom(_amount_starting){\r\n                            Money(#amount_starting#)\r\n                        }.Custom(_stps){\r\n                            If(#type_bargain# == 1){\r\n                                Div(Class:h6, Body:Money(#order_min#) / Money(#order_max#))\r\n                            }\r\n                            If(#type_bargain# == 2){\r\n                                Div(Class:h6, Body:\"-\")\r\n                            }\r\n                        }.Custom(_amount_final){\r\n                            SetVar(status_index, Calculate(#status# + 1))\r\n                            SetVar(status_class,AppParam(App: #application_id#, Name: lots_status_classes, Index: #status_index#))\r\n                            If(#type_bargain# == 1){\r\n                                Div(#status_class#){\r\n                                    Money(#amount_max#)\r\n                                }\r\n                            }\r\n                            If(#type_bargain# == 2){\r\n                                Div(#status_class#){\r\n                                    Money(#amount_starting#)\r\n                                }\r\n                            }\r\n                        }.Custom(_seller){\r\n                            Div(text-nowrap){\r\n                                DBFind(members).Columns(\"id,member_name,image_id\").Where(\"id=#seller#\").Vars(seller)\r\n                                If(Or(#seller_id#>0,#seller_id#<0)){\r\n                                }.Else{\r\n                                    SetVar(seller_member_name,Address(#seller#))\r\n                                }\r\n                                LinkPage(Class: center text-primary h5 text-bold, Page: profile_view, PageParams: \"v_member_id=#seller#\"){\r\n                                    If(#seller_image_id#>0){\r\n                                        Image(Src: Binary().ById(#seller_image_id#), Class: img-circle mr)\r\n                                    }.Else{\r\n                                        Div(Class: fa icon-user fa-2x mr)\r\n                                    }\r\n                                    Div(){#seller_member_name#}\r\n                                }\r\n                            }\r\n                        }.Custom(_name){\r\n                            Div(text-left){\r\n                                LinkPage(Class: text-primary h5 text-bold, Page: lots_view, PageParams: \"Id=#id#\", Body: #name#)\r\n                            }\r\n                        }.Custom(_status){\r\n                            SetVar(status_index, Calculate(#status# + 1))\r\n                            SetVar(status_class,AppParam(App: #application_id#, Name: lots_status_classes, Index: #status_index#))\r\n                            Div(#status_class#){\r\n                                AppParam(App: #application_id#, Name: lots_status, Index: #status_index#)\r\n                            }\r\n                        }.Custom(_actions){\r\n                            If(#status#==4){\r\n                                Div(){\r\n                                    LinkPage(Body: Договор, Page: lots_view_contract, PageParams: \"Id=#id#\")\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    If(#r_role_name#==\"Admin\") {\r\n                        DBFind(lots, src_lots).Count(tettttt).Where(\"deleted=0 or deleted=1 and status=4\").Custom(_photo){\r\n                            Image(Src: Binary().ById(#photo#), Class:photo)\r\n                        }.Custom(_date_creation){\r\n                            DateTime(#date_creation#, DD.MM.YYYY)\r\n                        }.Custom(_date_start){\r\n                            DateTime(#date_start#, DD.MM.YY) / DateTime(#date_end#, DD.MM.YY)\r\n                        }.Custom(_date_end){\r\n                            DateTime(#date_end#, DD.MM.YYYY)\r\n                        }.Custom(_amount_starting){\r\n                            Money(#amount_starting#)\r\n                        }.Custom(_stps){\r\n                            If(#type_bargain# == 1){\r\n                                Div(Class:h6, Body:Money(#order_min#) / Money(#order_max#))\r\n                            }\r\n                            If(#type_bargain# == 2){\r\n                                Div(Class:h6, Body:\"-\")\r\n                            }\r\n                        }.Custom(_amount_final){\r\n                            SetVar(status_index, Calculate(#status# + 1))\r\n                            SetVar(status_class,AppParam(App: #application_id#, Name: lots_status_classes, Index: #status_index#))\r\n                            If(#type_bargain# == 1){\r\n                                Div(#status_class#){\r\n                                    Money(#amount_max#)\r\n                                }\r\n                            }\r\n                            If(#type_bargain# == 2){\r\n                                Div(#status_class#){\r\n                                    Money(#amount_starting#)\r\n                                }\r\n                            }\r\n                        }.Custom(_seller){\r\n                            Div(text-nowrap){\r\n                                DBFind(members).Columns(\"id,member_name,image_id\").Where(\"id=#seller#\").Vars(seller)\r\n                                If(Or(#seller_id#>0,#seller_id#<0)){\r\n                                }.Else{\r\n                                    SetVar(seller_member_name,Address(#seller#))\r\n                                }\r\n                                LinkPage(Class: center text-primary h5 text-bold, Page: profile_view, PageParams: \"v_member_id=#seller#\"){\r\n                                    If(#seller_image_id#>0){\r\n                                        Image(Src: Binary().ById(#seller_image_id#), Class: img-circle mr)\r\n                                    }.Else{\r\n                                        Div(Class: fa icon-user fa-2x mr)\r\n                                    }\r\n                                    Div(){#seller_member_name#}\r\n                                }\r\n                            }\r\n                        }.Custom(_name){\r\n                            Div(text-left){\r\n                                LinkPage(Class: text-primary h5 text-bold, Page: lots_view, PageParams: \"Id=#id#\", Body: #name#)\r\n                            }\r\n                        }.Custom(_status){\r\n                            SetVar(status_index, Calculate(#status# + 1))\r\n                            SetVar(status_class,AppParam(App: #application_id#, Name: lots_status_classes, Index: #status_index#))\r\n                            Div(#status_class#){\r\n                                AppParam(App: #application_id#, Name: lots_status, Index: #status_index#)\r\n                            }\r\n                        }.Custom(_actions){\r\n                            If(#status#==4){\r\n                                Div(){\r\n                                    LinkPage(Body: Договор, Page: lots_view_contract, PageParams: \"Id=#id#\")\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(list-group-item text-center){\r\n                        Div(table-responsive){\r\n                            If(#tettttt#>0){\r\n                                Table(src_lots,\"ID=id,Название=_name,Продавец=_seller,Начало / Окончание=_date_start,Стартовая цена=_amount_starting,Шаг (Min/Max)=_stps,Цена=_amount_final,Статус=_status,=_actions\")\r\n                            }.Else{\r\n                                Span(Лотов нет)\r\n                            }\r\n                        }.Style(\r\n                            th,td {text-align:center;}\r\n                            .img-circle {height: 30px;width: 30px; border: 1px solid #5A5D63;}\r\n                            .center {display:flex; align-items:center;}\r\n                            .photo {height: 30px; width: 30px;}\r\n                        )\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }.Else{\r\n        Div(row){\r\n            Div(col-sm-8 col-xs-8 col-sm-offset-2 col-lg-6 col-lg-offset-3){\r\n                Form(panel panel-primary){\r\n                    Div(list-group-item){\r\n                        P(Class: text-center text-bold h4 m0, Body: LangRes(user_info))\r\n                        Div(panel-body){\r\n                            Div(form-group){\r\n                                Div(row){\r\n                                    Div(col-md-12 mt-sm text-center){\r\n                                        If(Or(#prefix_id#>0,#prefix_id#<0)){\r\n                                            If(#prefix_id# == #key_id#){\r\n                                                Button(Class: btn btn-link, Page: profile_edit, PageParams: \"v_member_id=#key_id#\"){\r\n                                                    If(#prefix_image_id#>0){\r\n                                                        Image(Src: Binary().ById(#prefix_image_id#), Class: img-circle).Style(width: 80px; border: 1px solid #5A5D63;)\r\n                                                    }.Else{\r\n                                                        Span(Class: fa icon-user fa-5x text-primary)\r\n                                                    }\r\n                                                    Div(m0 h4 text-bold){#prefix_member_name#}\r\n                                                }\r\n                                            }.Else{\r\n                                                If(#prefix_image_id#>0){\r\n                                                    Image(Src: Binary().ById(#prefix_image_id#), Class: img-circle).Style(width: 80px; border: 1px solid #5A5D63;)\r\n                                                }.Else{\r\n                                                    Span(Class: fa icon-user fa-5x)\r\n                                                }\r\n                                                Div(m0 h4 text-bold){#prefix_member_name#}\r\n                                            }\r\n                                            Div(Class: h5 text-muted m0, Body: #prefix_member_info_information#)\r\n                                        }.Else{\r\n                                            Button(Class: btn btn-link, Page: profile_add){\r\n                                                Span(Class: h4 text-bold, Body: LangRes(editing_profile))\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                            Div(list-group-item text-center){\r\n                                Div(text-muted m0 h5, Body: LangRes(roles))\r\n                                DBFind(Name: roles_participants, Source: src_check).Columns(\"id\").Where(\"member->member_id='#v_member_id#' and deleted=0\").Vars(check)\r\n                                If(#check_id#>0){\r\n                                    DBFind(Name: roles_participants, Source: src_roles).Columns(\"role->id,role->name\").Where(\"member->member_id='#v_member_id#' and deleted=0\").Order(\"id\")\r\n                                    ForList(src_roles){\r\n                                        Span(){\r\n                                            LinkPage(Page: roles_view, PageParams: \"v_role_id=#role.id#\"){\r\n                                                Span(Class: h5, Body: \"#role.name#\")\r\n                                            }\r\n                                        }.Style(margin-right: 6px; margin-left: 6px;)\r\n                                    }\r\n                                }.Else{\r\n                                    Span(LangRes(no))\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "role_test",
            "Conditions": "true",
            "Value": "Span(#role_id#)",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "testtest",
            "Conditions": "true",
            "Value": "Div(Class: content-wrapper){\r\n    Div(Class: col-md-12 col-xs-8){\r\n        Span(texe-center){\r\n            text-test\r\n        }.Style(\r\n            font-size: 20px;\r\n        )\r\n    }\r\n}",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "view_lots_start_auction",
            "Conditions": "true",
            "Value": "Div(Class: content-wrapper){\r\n    Div(row){\r\n        Div(col-sm-10 col-sm-offset-1 col-lg-6 col-lg-offset-3){\r\n            Form(panel panel-primary){\r\n                Div(panel-heading text-center){\r\n                    DBFind(\"notifications\").Columns(\"id,page_params->lot_id,page_params->rate_broken\").WhereId(#notific_id#).Vars(src)\r\n                    DBFind(\"lots\").WhereId(#src_page_params_lot_id#).Vars(lot_)\r\n                    DBFind(roles).Columns(\"id,role_name\").Where(\"id=#role_id#\").Vars(r)\r\n                    If(#src_page_params_lot_id#>0){\r\n                        DBFind(lots_tracks).Where(\"lot_id=#src_page_params_lot_id# and key_id=#key_id# and deleted=0\").Vars(track)\r\n                    }\r\n                    If(Or(#lot__status#==3,#lot__status#==5)){\r\n                        Span(Class:h4 text-bold,Body:Аукцион закончен)\r\n                    }.ElseIf(#src_page_params_rate_broken# == 1){\r\n                        Span(Class:h4 text-bold,Body:Ваша ставка перебита)\r\n                    }.Else{\r\n                        Span(Class:h4 text-bold,Body:Объявление о начале аукциона)\r\n                    }\r\n                }\r\n                Div(panel-body){\r\n                    Div(row){\r\n                        Div(form-group){\r\n                            Div(list-group-item text-center){\r\n                                Image(Src: Binary().ById(#lot__photo#), Class:big_photo mb-lg)\r\n                                Div(row mt-sm t4){\r\n                                    Div(col-md-6 text-right){\r\n                                        Span(\"Лот ID\")\r\n                                    }\r\n                                    Div(col-md-6 text-left){\r\n                                        #lot__id#\r\n                                    }\r\n                                }\r\n                                Div(row mt-sm t4){\r\n                                    Div(col-md-6 text-right){\r\n                                        Span(\"Название\")\r\n                                    }\r\n                                    Div(col-md-6 text-left){\r\n                                        #lot__name#\r\n                                    }\r\n                                }\r\n                                Div(row mt-sm t4){\r\n                                    Div(col-md-6 text-right){\r\n                                        LangRes(lots_date_start)\r\n                                    }\r\n                                    Div(col-md-6 text-left){\r\n                                        DateTime(#lot__date_start#, DD.MM.YYYY HH:MI)\r\n                                    }\r\n                                }\r\n                                Div(row mt-sm t4){\r\n                                    Div(col-md-6 text-right){\r\n                                        LangRes(lots_date_end)\r\n                                    }\r\n                                    Div(col-md-6 text-left){\r\n                                        DateTime(#lot__date_end#, DD.MM.YYYY HH:MI)\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(panel-footer text-right){\r\n                        If(#track_id#>0){\r\n                            Button(Body: $lots_unsubscribe$, Class: btn btn-default pull-left, Page: lots_list, PageParams: \"Id=#Id#\", Contract: lots_BuyerAction, Params: \"Action=track_reject,Id=#Id#\")\r\n                        }\r\n                        Button(Class:btn btn-primary, Body:\"Перейти к аукциону\",Contract:notifications_Close,Params:\"notific_id=#notific_id#\",Page:lots_view,PageParams:\"Id=#src_page_params_lot_id#\")\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}.Style(\r\n    .big_photo {height: 300px; max-width: 600px;}\r\n)",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Name": "lots_Close",
            "Conditions": "true",
            "Value": "contract lots_Close {\r\n    data {\r\n        id int\r\n    }\r\n    conditions {\r\n        $lot = DBFind(\"lots\").Columns(\"id,seller,deleted,type_bargain,name,description,seller_sign\").WhereId($id).Row()\r\n        if !$lot {\r\n            warning \"Не удается закрыть лот: лот не найден\"\r\n        }\r\n        if $lot[\"deleted\"] == 1 {\r\n            warning \"Не удается закрыть лот: лот удален\"\r\n        }\r\n    }\r\n    action {\r\n        var buyer, params map\r\n        if $lot[\"type_bargain\"] == 2 {\r\n            buyer = DBFind(\"buyers\").Columns(\"id,buyer_id,amount\").Where(\"lot_id = ? and status = 0\", $id).Order(\"id ASC\").Row()\r\n        }else{\r\n            buyer = DBFind(\"buyers\").Columns(\"id,buyer_id,amount\").Where(\"lot_id = ? and status = 0\", $id).Order(\"amount DESC, id ASC\").Row()\r\n        }\r\n        params[\"lot_id\"] = $id\r\n        if !buyer {\r\n            DBUpdate(\"lots\", $id, \"status\", 5)\r\n            var reject_lot_notif array\r\n            reject_lot_notif = DBFind(\"notifications\").Where(\"page_params->lot_id=? and closed=0\", $id)\r\n            var i int\r\n            while i < Len(reject_lot_notif) {\r\n                var p map\r\n                p = reject_lot_notif[i]\r\n                notifications_Close(\"notific_id\",Int(p[\"id\"]))\r\n                i=i+1\r\n            }\r\n            notifications_Send(\"member_id,sender,text_header,page_name,params_map\", $lot[\"seller\"], 1, \"Лот не продан: нет покупателей\", \"lots_view\", JSONEncode(params))\r\n        }else{\r\n            var contract_text string buyer_member, seller_member map\r\n            buyer_member = DBFind(\"members\").Columns(\"member_name\").WhereId(Int(buyer[\"buyer_id\"])).Row()\r\n            seller_member = DBFind(\"members\").Columns(\"member_name\").WhereId(Int($lot[\"seller\"])).Row()\r\n            contract_text = Sprintf(\"Договор купли-продажи по лоту № %v\\n\", $lot[\"id\"])\r\n\r\n            contract_text = contract_text + \"\\nПродавец\\n\"\r\n            contract_text = contract_text + Sprintf(\"Имя: %v\\n\", seller_member[\"member_name\"])\r\n\r\n            contract_text = contract_text + \"\\nПокупатель\\n\"\r\n            contract_text = contract_text + Sprintf(\"Имя: %v\\n\", buyer_member[\"member_name\"])\r\n\r\n            contract_text = contract_text + \"\\nОписание лота\\n\"\r\n            contract_text = contract_text + Sprintf(\"Наименование: %v\\n\", $lot[\"name\"])\r\n            contract_text = contract_text + Sprintf(\"Описание: %v\\n\", $lot[\"description\"])\r\n            DBUpdate(\"lots\", $id, \"status,amount_final,buyer,contract_text\", 3, buyer[\"amount\"], buyer[\"buyer_id\"], contract_text)\r\n            if $lot[\"seller_sign\"] != 1 {\r\n                notifications_Send(\"member_id,sender,text_header,page_name,params_map\", $lot[\"seller\"], 1, \"Торги завершены: необходимо подтверждение\", \"lots_view_contract\", JSONEncode(params))\r\n            }else{\r\n                notifications_Send(\"member_id,sender,text_header,page_name,params_map\", buyer[\"buyer_id\"], 1, \"Ваша ставка победила: необходимо подтверждение\", \"lots_view_contract\", JSONEncode(params))\r\n            }\r\n        }\r\n    }\r\n}",
            "Type": "contracts"
        },
        {
            "Name": "AuctionProccessEdit",
            "Conditions": "true",
            "Value": "contract AuctionProccessEdit {\r\n    data {\r\n        lot_id int\r\n    }\r\n    conditions {\r\n        \r\n    }\r\n    action {\r\n        $lot_map = DBFind(\"lots\").Where(\"id=$\", $lot_id).Row()\r\n        if($lot_map[\"status\"] == 1){\r\n            DBUpdate(\"lots\",$lot_id,\"status\",2)\r\n            var buers array\r\n            buers = DBFind(\"lots_tracks\").Where(\"lot_id=? and deleted=0\", $lot_id)\r\n            var i int\r\n            while i < Len(buers) {\r\n                var p map\r\n                p = buers[i]\r\n                $member_id = Int(p[\"key_id\"])\r\n\r\n                var notific_params map\r\n                notific_params[\"lot_id\"] = $lot_id\r\n\r\n                notifications_Send(\"member_id,sender,icon_name,text_header,text_body,page_name,params_map\", $member_id, 1, \"icon icon-envelope\", \"Аукцион начался\", \"Подробнее\", \"view_lots_start_auction\", notific_params)\r\n                i=i+1\r\n            }\r\n        }\r\n        if($lot_map[\"status\"] == 2){\r\n            DBUpdate(\"lots\",$lot_id,\"status\",3)\r\n\r\n            var notific_params map\r\n            notific_params[\"lot_id\"] = $lot_id\r\n\r\n            $member_id = Int($lot_map[\"seller\"])\r\n\r\n            notifications_Send(\"member_id,sender,icon_name,text_header,text_body,page_name,params_map\", $member_id, 1, \"icon icon-envelope\", \"Аукцион закончен\", \"Подробнее\", \"view_lots_start_auction\", notific_params)\r\n            lots_Close (\"id\",$lot_id) \r\n        }\r\n    }\r\n}",
            "Type": "contracts"
        },
        {
            "Name": "LotsStatusUpdate",
            "Conditions": "true",
            "Value": "contract LotsStatusUpdate {\r\n    data {}\r\n    conditions {\r\n        MainCondition()\r\n        $statusWaiting = 1\r\n        $statusBegin = 2\r\n    }\r\n    action {\r\n        var lots array lot map lenLots i int\r\n        lots = DBFind(\"lots\").Where(\"status=? and deleted=0 and date_start<=?\", $statusWaiting, BlockTime()).Columns(\"status,id\")\r\n        lenLots = Len(lots)\r\n\r\n        while i<lenLots{\r\n            lot = lots[i]\r\n            AuctionProccessEdit(\"lot_id\", Int(lot[\"id\"]))\r\n            i=i+1\r\n        }\r\n\r\n        lots = DBFind(\"lots\").Where(\"status=? and deleted=0 and date_end<=?\", $statusBegin, BlockTime()).Columns(\"status,id\")\r\n        lenLots = Len(lots)\r\n        i=0\r\n        while i<lenLots{\r\n            lot = lots[i]\r\n            AuctionProccessEdit(\"lot_id\", Int(lot[\"id\"]))\r\n            i=i+1\r\n        }\r\n    }\r\n}",
            "Type": "contracts"
        },
        {
            "Name": "Cron",
            "Conditions": "true",
            "Value": "contract Cron {\r\n    data {\r\n        time int\r\n    }\r\n    conditions {\r\n        Println($this_contract, $time) // не удалять и не комментировать эту строку!!\r\n        $ff = BlockTime()\r\n        DBInsert(\"cron_test\", \"ts,ff\", $time, $ff)\r\n    }\r\n    action {\r\n        /*\r\n        после этого комментария вставить вызов контракта, который необходимо выполнять интервально\r\n        after this comment, insert a contract call that you want to run at intervals\r\n        */\r\n        LotsStatusUpdate()\r\n    }\r\n}",
            "Type": "contracts"
        },
        {
            "Name": "LotsUploadPhoto",
            "Conditions": "true",
            "Value": "contract LotsUploadPhoto {\r\n    data {\r\n        Photo bytes \"file\"\r\n        LotId string \"optional\"\r\n    }\r\n    conditions {\r\n        $LotId = Int($LotId)\r\n        // if $LotId > 0 {\r\n        //     var photoId int\r\n        //     photoId = Int(DBFind(\"lots\").Where(\"id=? and deleted=0\", $LotId).One(\"photo\"))\r\n        //     $imageName = DBFind(\"binaries\").Where(\"id=?\", photoId).One(\"name\")\r\n        // }else{\r\n        // }\r\n        $imageName = Str($time)\r\n    }\r\n\r\n    action {\r\n        var appId imageId int image map\r\n        appId = Int(DBFind(\"applications\").Where(\"name='Trading Platform' and deleted=0\").One(\"id\"))\r\n        imageId = @1UploadBinary(\"ApplicationId,Name,Data\", appId, $imageName, $Photo)\r\n        image[\"id\"] = imageId\r\n        image[\"lot_id\"] = $LotId\r\n\r\n        @1buffer_Manager(\"Action,Key,Val\", \"set\", \"last_uploaded_image\", JSONEncode(image))\r\n    }\r\n}",
            "Type": "contracts"
        },
        {
            "Name": "PlatformSingup",
            "Conditions": "true",
            "Value": "//This is a test sandbox contact allows you to test the _platform enviroment\r\ncontract PlatformSingup {\r\n    data {\r\n        role string\r\n    }\r\n    conditions {\r\n    }\r\n    action {\r\n        var notific_params map\r\n        notific_params[\"role\"] = $role\r\n        //member_id - is default for second function\r\n        //notifications_Send(\"rid,closure_type,sender,text_header,page_name,params_map\", 1, 0, $sender, \"New request for membership\", \"platform_role_acceptance\", notific_params)\r\n        notifications_Send(\"rid,closure_type,sender,icon_name,text_header,text_body,page_name,params_map\", 1,1,1, \"icon icon-user-follow\", \"Новый запрос для присвоения роли\", \"Подробнее\", \"platform_role_acceptance\", notific_params)\r\n    }\r\n}",
            "Type": "contracts"
        },
        {
            "Name": "ProfileUploadPhoto",
            "Conditions": "true",
            "Value": "contract ProfileUploadPhoto {\r\n    data {\r\n        Photo bytes \"file\"\r\n    }\r\n    conditions {}\r\n\r\n    action {\r\n        var appId imageId int image map\r\n        appId = Int(DBFind(\"applications\").Where(\"name='Trading Platform' and deleted=0\").One(\"id\"))\r\n        imageId = @1UploadBinary(\"ApplicationId,Name,Data\", appId, Str($time), $Photo)\r\n        image[\"id\"] = imageId\r\n\r\n        @1buffer_Manager(\"Action,Key,Val\", \"set\", \"avatar\", JSONEncode(image))\r\n    }\r\n}",
            "Type": "contracts"
        },
        {
            "Name": "Profile_Edit",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "contract Profile_Edit {\r\n    data {\r\n        member_id int\r\n        name_first string\r\n        name_middle string\r\n        name_last string\r\n        company_name string\r\n        company_position string\r\n        member_name string\r\n        image_id string \"optional\"\r\n        information string \"optional\"\r\n        ismobile int \"optional\"\r\n    }\r\n\r\n    conditions {\r\n        if $ismobile == 1 {\r\n            $image_id = 80\r\n        }\r\n        if ($ismobile == 0) {\r\n            if ($image_id == \"#prefix_image_id#\") {\r\n                info(\"You must upload an photo\")\r\n            }\r\n        }\r\n        $image_id = Int($image_id)\r\n        var app_name string\r\n        app_name = \"Basic application\" \r\n\r\n        $member_map = DBFind(\"members\").Where(\"id = $\", $key_id).Row()\r\n        $app_id = DBFind(\"applications\").Where(\"name = $ AND deleted = 0\", app_name).One(\"id\")\r\n\r\n        if !$member_map {\r\n            // check member_name \r\n            $member_id = DBFind(\"members\").Where(\"member_name = $\", $member_name).One(\"id\")\r\n            if $member_id {\r\n                warning \"This member name is busy. Enter another member name, please\"\r\n            }\r\n        }\r\n    }\r\n\r\n    action {\r\n        var memberInfo map\r\n\r\n        if $member_map {\r\n            DBUpdate(\"members\", Int($member_map[\"id\"]), \"member_info->information,image_id,name_first,name_middle,name_last,company_name,company_position\", $information, $image_id,$name_first,$name_middle,$name_last,$company_name,$company_position)\r\n        } else {\r\n            memberInfo[\"information\"] = $information\r\n            DBInsert(\"members\", \"id,member_name,image_id,member_info,name_first,name_middle,name_last,company_name,company_position\", $key_id, $member_name, $image_id, memberInfo,$name_first,$name_middle,$name_last,$company_name,$company_position)\r\n        }\r\n        @1buffer_Manager(\"Action,Key\", \"clean\", \"avatar\")\r\n    }\r\n}",
            "Type": "contracts"
        },
        {
            "Name": "developertest",
            "Conditions": "true",
            "Value": "contract developertest {\r\n    data {\r\n\r\n    }\r\n    conditions {\r\n        warning(\"Ok test\")\r\n    }\r\n    action {\r\n       // DBUpdate(\"lots\",42,\"deleted\",1)\r\n        \r\n        /*var reject_lot_notif array\r\n        reject_lot_notif = DBFind(\"notifications\").Where(\"page_params->lot_id=? and closed=0\", 47)\r\n        var i int\r\n        while i < Len(reject_lot_notif) {\r\n            var p map\r\n            p = reject_lot_notif[i]\r\n            notifications_Close(\"notific_id\",Int(p[\"id\"]))\r\n            i=i+1\r\n        }*/\r\n    }\r\n}",
            "Type": "contracts"
        },
        {
            "Name": "lots_AdminAction",
            "Conditions": "true",
            "Value": "contract lots_AdminAction {\r\n    data {\r\n        Action string\r\n        NotificId int\r\n        Id int\r\n        Comment string \"optional\"\r\n    }\r\n    func notifyBuyers(lotId int, lotName string){\r\n        var rid closureType sender int textHeader pageName string params map\r\n        closureType = 2\r\n        sender = 1\r\n        textHeader = \"Появился новый лот: \" + lotName\r\n        pageName = \"lots_view\"\r\n        params[\"lot_id\"] = lotId\r\n        params[\"note_for\"] = \"buyers\"\r\n        params = JSONEncode(params)\r\n        rid = $buyerRoleId\r\n        notifications_Send(\"rid,closure_type,sender,text_header,page_name,params_map\", rid, closureType, sender, textHeader, pageName, params)\r\n    }\r\n    conditions {\r\n        if $role_id != 1{\r\n            warning \"Access denied\"\r\n        }\r\n        $buyerRoleId = Int(DBFind(\"roles\").Where(\"role_name='Buyer'\").One(\"id\"))\r\n        if $buyerRoleId == 0{\r\n            warning \"'Buyer' role not found\"\r\n        }\r\n        $lot = DBFind(\"lots\").Where(\"id=? and deleted=0\", $Id).Row()\r\n        if !$lot {\r\n            warning \"Lot not found\"\r\n        }\r\n        if $lot[\"status\"] > 1 {\r\n            warning \"Bidding has already begun\"\r\n        }\r\n        if $Action == \"reject\" && Size($Comment) < 1 {\r\n            warning \"Пожалуйста укажите причину отказа\"\r\n        }\r\n    }\r\n\r\n    action {\r\n        if $Action == \"accept\" {\r\n            DBUpdate(\"lots\", $Id, \"status\", 1)\r\n            notifyBuyers($Id, $lot[\"name\"])\r\n        }\r\n        if $Action == \"reject\" {\r\n            DBUpdate(\"lots\", $Id, \"status,comment\", 5, $Comment)\r\n        }\r\n        notifications_Close(\"notific_id\", $NotificId)\r\n    }\r\n}",
            "Type": "contracts"
        },
        {
            "Name": "lots_BuyerAction",
            "Conditions": "true",
            "Value": "contract lots_BuyerAction {\r\n    data {\r\n        Action string\r\n        NotificId string \"optional\"\r\n        Id int\r\n    }\r\n    conditions {\r\n        $NotificId = Int($NotificId)\r\n        if !DBFind(\"roles\").Where(\"role_name='Buyer' and id=?\", $role_id).One(\"id\") {\r\n            warning \"Access denied\"\r\n        }\r\n        $lot = DBFind(\"lots\").Where(\"id=?\", $Id).Row()\r\n        if !$lot {\r\n            warning \"Lot not found\"\r\n        }\r\n        $track = DBFind(\"lots_tracks\").Where(\"key_id=? and lot_id=?\", $key_id, $Id).Row()\r\n    }\r\n\r\n    action {\r\n        if $Action == \"track_accept\" {\r\n            if !$track {\r\n                DBInsert(\"lots_tracks\", \"key_id,lot_id\", $key_id, $Id)\r\n            }else{\r\n                DBUpdate(\"lots_tracks\", Int($track[\"id\"]), \"deleted\", 0)\r\n            }\r\n        }\r\n        if $Action == \"track_reject\" {\r\n            if $track {\r\n                DBUpdate(\"lots_tracks\", Int($track[\"id\"]), \"deleted\", 1)\r\n            }\r\n        }\r\n        if $NotificId>0{\r\n            notifications_Close(\"notific_id\", $NotificId)\r\n        }\r\n    }\r\n}",
            "Type": "contracts"
        },
        {
            "Name": "AuctionProcess",
            "Conditions": "true",
            "Value": "contract AuctionProcess {\r\n    data {\r\n        step_rate money\r\n        lot_id int\r\n    }\r\n    func storeHistory(id int){\r\n        var vars map\r\n        vars[\"step_rate\"] = $step_rate\r\n        vars[\"lot_id\"] = $lot_id\r\n        DBInsert(lots_blocks, \"block_id,block_time,txhash,contract_name,contract_params,lot_id\", $block_id, $block_time, $txhash, $this_contract, vars, id)\r\n    }\r\n    conditions {\r\n        $lot_map = DBFind(\"lots\").Where(\"id=$\", $lot_id).Row()\r\n        if ($lot_map[\"type_bargain\"] == 1){\r\n            if (Money($lot_map[\"amount_max\"]) == Money(0)){\r\n                if ($step_rate < Money($lot_map[\"amount_starting\"])){\r\n                    info(\"Ставка не может быть меньше текущей\")\r\n                }\r\n                if ($step_rate < Money($lot_map[\"amount_starting\"]) + Money($lot_map[\"order_min\"])){\r\n                    info(\"Шаг меньше минимального\")\r\n                }\r\n                if ($step_rate > Money($lot_map[\"amount_starting\"]) + Money($lot_map[\"order_max\"])){\r\n                    info(\"Шаг больше максимального\")\r\n                }\r\n            }\r\n            if (Money($lot_map[\"amount_max\"]) > Money(0)){\r\n                if ($step_rate < Money($lot_map[\"amount_max\"])){\r\n                    info(\"Ставка не может быть меньше текущей\")\r\n                }\r\n                if ($step_rate < Money($lot_map[\"amount_max\"]) + Money($lot_map[\"order_min\"])){\r\n                    info(\"Шаг меньше минимального\")\r\n                }\r\n                if ($step_rate > Money($lot_map[\"amount_max\"]) + Money($lot_map[\"order_max\"])){\r\n                    info(\"Шаг больше максимального\")\r\n                }\r\n            }\r\n        }\r\n        if ($lot_map[\"type_bargain\"] == 2){\r\n            $step_rate = Money($lot_map[\"amount_starting\"])\r\n        }\r\n        \r\n        var percentrate money\r\n        percentrate = $step_rate / Money(100)\r\n    \r\n        var checkamount money\r\n        checkamount = Money(DBFind(\"keys\").Where(\"id = ?\",$key_id).One(\"amount\"))\r\n        \r\n        //$checksumm = DBFind(\"buyers\").Where(\"lot_id=$ and buyer_id=$\",$lot_id,$key_id).Order(\"id DESC\").One(\"amount\")\r\n        $checksumm = DBFind(\"buyers\").Where(\"lot_id=$ and buyer_id=$\",$lot_id,$key_id).Order(\"amount DESC\").One(\"amount\")\r\n        $checkdep = Money(DBFind(\"keys\").Where(\"id = ?\",$key_id).One(\"deposit\"))\r\n        \r\n        if ($lot_map[\"type_bargain\"] == 2){\r\n            if(percentrate + $step_rate + $checkdep > checkamount){\r\n                info(\"На счету недостаточно средств\")\r\n            }\r\n        }\r\n        \r\n        if ($lot_map[\"type_bargain\"] == 1){\r\n            if (Money($lot_map[\"amount_max\"]) == Money(0)){\r\n                if(percentrate + $step_rate + $checkdep > checkamount){\r\n                    info(\"На счету недостаточно средств\")\r\n                }\r\n            }\r\n            if (Money($lot_map[\"amount_max\"]) > Money(0)){\r\n                if(!$checksumm){\r\n                    if(percentrate + $step_rate + $checkdep > checkamount){\r\n                        info(\"На счету недостаточно средств\")\r\n                    }\r\n                }\r\n                if(Money($checksumm) > Money(0)){\r\n                    if(Money(percentrate)+ Money($checkdep) + (Money($step_rate) - Money($checksumm)) > Money(checkamount)){\r\n                        info(\"На счету недостаточно средств\")\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    action {\r\n        var percentrate money\r\n        percentrate = $step_rate / Money(100)\r\n\r\n        if ($lot_map[\"type_bargain\"] == 1){\r\n            if (Money($lot_map[\"amount_max\"]) == Money(0)){\r\n                DBUpdate(\"keys\",$key_id,\"+deposit\",$step_rate)\r\n                DBUpdate(\"lots\",$lot_id,\"amount_max\",$step_rate)\r\n                DBInsert(\"buyers\",\"amount,lot_id,buyer_id,percentrate,timestamp rate_date\",$step_rate,$lot_id,$key_id,percentrate,$block_time)\r\n\r\n                DBInsert(\"dep_user_list\",\"amount,lot_id,member_id\",$step_rate,$lot_id,$key_id)\r\n            }\r\n            if (Money($lot_map[\"amount_max\"]) > Money(0)){\r\n\r\n                $user_map = DBFind(\"buyers\").Where(\"buyer_id=$ and lot_id=$\",$key_id,$lot_id).Row()\r\n                var secondrate money\r\n\r\n                if($user_map[\"buyer_id\"]){\r\n                    secondrate = $step_rate - Money($checksumm)\r\n                }\r\n                if(!$user_map[\"buyer_id\"]){\r\n                    secondrate = $step_rate\r\n                }\r\n                //notific of a high rate\r\n                $send_notif_rate_broken = DBFind(\"buyers\").Where(\"lot_id=$\",$lot_id).Order(\"amount DESC\").One(\"buyer_id\")\r\n                var notific_params map\r\n                notific_params[\"lot_id\"] = $lot_id\r\n                notific_params[\"rate_broken\"] = 1\r\n                notifications_Send(\"member_id,sender,icon_name,text_header,text_body,page_name,params_map\", Int($send_notif_rate_broken), 1, \"icon icon-envelope\", \"Ваша ставка перебита\", \"Подробнее\", \"view_lots_start_auction\", notific_params)\r\n\r\n                DBUpdate(\"keys\",$key_id,\"+deposit\",secondrate)\r\n                DBUpdate(\"lots\",$lot_id,\"amount_max\",$step_rate)\r\n                DBInsert(\"buyers\",\"amount,lot_id,buyer_id,percentrate,timestamp rate_date\",$step_rate,$lot_id,$key_id,percentrate,$block_time)\r\n\r\n                $dep_check = DBFind(\"dep_user_list\").Where(\"lot_id=$ and member_id=$\",$lot_id,$key_id).Row()\r\n                if(!$dep_check[\"member_id\"]){\r\n                    DBInsert(\"dep_user_list\",\"amount,lot_id,member_id\",$step_rate,$lot_id,$key_id)\r\n                }\r\n                if($dep_check[\"member_id\"]){\r\n                    DBUpdate(\"dep_user_list\",Int($dep_check[\"id\"]),\"amount\",$step_rate)\r\n                } \r\n            }\r\n            DBUpdate(\"keys\",$key_id,\"-amount\", percentrate)\r\n            DBUpdate(\"keys\", Int(EcosysParam(\"founder_account\")) ,\"+amount\", percentrate)\r\n        }\r\n\r\n        if ($lot_map[\"type_bargain\"] == 2){\r\n            DBUpdate(\"keys\",$key_id,\"-amount\", percentrate)\r\n            DBUpdate(\"keys\", Int(EcosysParam(\"founder_account\")),\"+amount\", percentrate)\r\n            DBUpdate(\"keys\",$key_id,\"+deposit\",$step_rate)\r\n            DBInsert(\"buyers\",\"amount,lot_id,buyer_id,percentrate,timestamp rate_date\",$step_rate,$lot_id,$key_id,percentrate,$block_time)\r\n            //DBInsert(\"dep_user_list\",\"lot_id,member_id,amount\",$lot_id,$key_id,$step_rate)\r\n\r\n\t\t\tDBUpdate(\"lots\",$lot_id,\"status\",3)\r\n\r\n            var notific_params map\r\n            notific_params[\"lot_id\"] = $lot_id\r\n\r\n            $member_id = Int($lot_map[\"seller\"])\r\n\r\n            notifications_Send(\"member_id,sender,icon_name,text_header,text_body,page_name,params_map\", $member_id, 1, \"icon icon-envelope\", \"Аукцион закончен\", \"Подробнее\", \"view_lots_start_auction\", notific_params)\r\n            lots_Close (\"id\",$lot_id)\r\n        }\r\n        storeHistory($lot_id)\r\n    }\r\n}",
            "Type": "contracts"
        },
        {
            "Name": "lots_Delete",
            "Conditions": "true",
            "Value": "contract lots_Delete {\r\n    data {\r\n        Id int\r\n    }\r\n    func closeNotes(){\r\n        var notes array i lenNotes int note map\r\n        notes = DBFind(\"notifications\").Where(\"page_params->lot_id=?\", $Id).Columns(\"id\")\r\n        lenNotes = Len(notes)\r\n        while i<lenNotes{\r\n            note = notes[i]\r\n            notifications_Close(\"notific_id\", Int(note[\"id\"]))\r\n            i=i+1\r\n        }\r\n    }\r\n    func removeTracks(){\r\n        var tracks array i lenTracks int track map\r\n        tracks = DBFind(\"lots_tracks\").Where(\"lot_id=?\", $Id).Columns(\"id\")\r\n        lenTracks = Len(tracks)\r\n        while i<lenTracks{\r\n            track = tracks[i]\r\n            DBUpdate(\"lots_tracks\", Int(track[\"id\"]), \"deleted\", 1)\r\n            i=i+1\r\n        }\r\n    }\r\n    conditions {\r\n        var lot map\r\n        lot = DBFind(\"lots\").Where(\"id=? and deleted=0\", $Id).Row()\r\n        if !lot {\r\n            warning \"Lot not found\"\r\n        }\r\n        if lot[\"status\"] > 0 && lot[\"status\"] != 5 {\r\n            warning \"You cannot delete a confirmed lot\"\r\n        }\r\n        if lot[\"seller\"] != $key_id {\r\n            warning \"You are not owner of the lot\"\r\n        }\r\n    }\r\n\r\n    action {\r\n        DBUpdate(\"lots\", $Id, \"deleted\", 1)\r\n        closeNotes()\r\n        removeTracks()\r\n    }\r\n}",
            "Type": "contracts"
        },
        {
            "Name": "lots_InstallTypes",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "contract lots_InstallTypes {\r\n    data {}\r\n    func insertType(res,cat,params string){\r\n        if !DBFind(\"lots_types\").Where(\"deleted=0 and resource_name=?\", res).Row(){\r\n            DBInsert(\"lots_types\", \"resource_name,category,lots_params\", res, cat, params)\r\n        }\r\n    }\r\n    action {\r\n        // App Param \"lots_params\"\r\n        // 1. lots_dimensions: габариты (длинна / высота / ширина)\r\n        // 2. lots_weight: вес (кг/тонн)\r\n        // 3. lots_weight2: вес (кг/тонн/литры)\r\n        // 4. lots_counts: количество (шт.)\r\n\r\n        insertType(\"lots_type01\",\"1\", \"1,2,4\")\r\n        insertType(\"lots_type02\",\"2\", \"1,2,4\")\r\n        insertType(\"lots_type03\",\"2\", \"1,2,4\")\r\n        insertType(\"lots_type04\",\"3\", \"1,2,4\")\r\n        insertType(\"lots_type05\",\"3\", \"1,2,4\")\r\n        insertType(\"lots_type06\",\"3\", \"1,2,4\")\r\n        insertType(\"lots_type07\",\"4\", \"1,2,4\")\r\n        insertType(\"lots_type08\",\"4\", \"1,2,4\")\r\n        insertType(\"lots_type09\",\"4\", \"1,2,4\")\r\n        insertType(\"lots_type10\",\"4\", \"1,2,4\")\r\n        insertType(\"lots_type11\",\"4\", \"1,2,4\")\r\n        insertType(\"lots_type12\",\"4\", \"1,2,4\")\r\n        insertType(\"lots_type13\",\"5\", \"1,2,4\")\r\n        insertType(\"lots_type14\",\"5\", \"1,2,4\")\r\n        insertType(\"lots_type15\",\"5\", \"1,2,4\")\r\n        insertType(\"lots_type16\",\"5\", \"1,2,4\")\r\n        insertType(\"lots_type17\",\"6\", \"4\")\r\n        insertType(\"lots_type18\",\"6\", \"4\")\r\n        insertType(\"lots_type19\",\"6\", \"4\")\r\n        insertType(\"lots_type20\",\"6\", \"4\")\r\n        insertType(\"lots_type21\",\"6\", \"4\")\r\n        insertType(\"lots_type22\",\"7\", \"1,3,4\")\r\n        insertType(\"lots_type23\",\"7\", \"1,3,4\")\r\n        insertType(\"lots_type24\",\"7\", \"1,3,4\")\r\n        insertType(\"lots_type25\",\"7\", \"1,3,4\")\r\n        insertType(\"lots_type26\",\"7\", \"1,3,4\")\r\n        insertType(\"lots_type27\",\"8\", \"1,2,4\")\r\n        insertType(\"lots_type28\",\"9\", \"1,2,4\")\r\n        insertType(\"lots_type29\",\"10\", \"1,2,4\")\r\n        insertType(\"lots_type30\",\"10\", \"1,2,4\")\r\n        insertType(\"lots_type31\",\"10\", \"1,2,4\")\r\n        insertType(\"lots_type32\",\"10\", \"1,2,4\")\r\n        insertType(\"lots_type33\",\"11\", \"1,2,4\")\r\n        insertType(\"lots_type34\",\"11\", \"1,2,4\")\r\n        insertType(\"lots_type35\",\"11\", \"1,2,4\")\r\n        insertType(\"lots_type36\",\"12\", \"1,2,4\")\r\n        insertType(\"lots_type37\",\"12\", \"1,2,4\")\r\n        insertType(\"lots_type38\",\"12\", \"1,2,4\")\r\n        insertType(\"lots_type39\",\"13\", \"1,2,4\")\r\n        insertType(\"lots_type40\",\"13\", \"1,2,4\")\r\n        insertType(\"lots_type41\",\"13\", \"1,2,4\")\r\n        insertType(\"lots_type42\",\"13\", \"1,2,4\")\r\n        insertType(\"lots_type43\",\"13\", \"1,2,4\")\r\n        insertType(\"lots_type44\",\"13\", \"1,2,4\")\r\n        insertType(\"lots_type45\",\"13\", \"1,2,4\")\r\n\r\n    }\r\n}",
            "Type": "contracts"
        },
        {
            "Name": "lots_SellerAction",
            "Conditions": "true",
            "Value": "contract lots_SellerAction {\r\n    data {\r\n        Action string\r\n        Id string \"optional\"\r\n        PhotoId int\r\n        TypeId int\r\n        Name string\r\n        Description string\r\n        DateStart string \"date\"\r\n        TimeStart string \"date\"\r\n        DateEnd string \"date\"\r\n        TimeEnd string \"date\"\r\n        TypeBargain int\r\n        AmountStarting money\r\n        OrderMin string \"optional\"\r\n        OrderMax string \"optional\"\r\n\r\n        Location string\r\n        Condition int\r\n\r\n        Count int\r\n        Weight string \"optional\"\r\n        WeightType string \"optional\"\r\n        Length string \"optional\"\r\n        Width string \"optional\"\r\n        Height string \"optional\"\r\n    }\r\n    func trimZeroTime(s string) string{\r\n        if Contains(s, \"T00:00:00Z\"){\r\n            s = s Replace(s, \"T00:00:00Z\", \"\")\r\n        }\r\n        return s\r\n    }\r\n    func appendAll(items ...)array{\r\n        return items\r\n    }\r\n    func safeFloat(s string)float{\r\n        if s {\r\n            return Float(s)\r\n        }\r\n        return 0.0\r\n    }\r\n    func notifyAdmin(lotId int){\r\n        var rid closureType sender int textHeader pageName string params map\r\n        closureType = 2\r\n        sender = 1\r\n        textHeader = \"Новый лот: требуется подтверждение\"\r\n        pageName = \"lots_view\"\r\n        params[\"lot_id\"] = lotId\r\n        params[\"lot_status\"] = 0\r\n        params = JSONEncode(params)\r\n        rid = 1\r\n        notifications_Send(\"rid,closure_type,sender,text_header,page_name,params_map\", rid, closureType, sender, textHeader, pageName, params)\r\n    }\r\n    func storeHistory(id int){\r\n        var vars map\r\n        vars[\"Action\"] = $Action\r\n        vars[\"Id\"] = $Id\r\n        vars[\"PhotoId\"] = $PhotoId\r\n        vars[\"TypeId\"] = $TypeId\r\n        vars[\"Name\"] = $Name\r\n        vars[\"Description\"] = $Description\r\n        vars[\"DateStart\"] = $DateStart\r\n        vars[\"TimeStart\"] = $TimeStart\r\n        vars[\"DateEnd\"] = $DateEnd\r\n        vars[\"TimeEnd\"] = $TimeEnd\r\n        vars[\"TypeBargain\"] = $TypeBargain\r\n        vars[\"AmountStarting\"] = $AmountStarting\r\n        vars[\"OrderMin\"] = $OrderMin\r\n        vars[\"OrderMax\"] = $OrderMax\r\n        vars[\"Location\"] = $Location\r\n        vars[\"Condition\"] = $Condition\r\n        vars[\"Count\"] = $Count\r\n        vars[\"Weight\"] = $Weight\r\n        vars[\"WeightType\"] = $WeightType\r\n        vars[\"Length\"] = $Length\r\n        vars[\"Width\"] = $Width\r\n        vars[\"Height\"] = $Height\r\n        DBInsert(lots_blocks, \"block_id,block_time,txhash,contract_name,contract_params,lot_id\", $block_id, $block_time, $txhash, $this_contract, vars, id)\r\n    }\r\n    conditions {\r\n        if $PhotoId == 0{\r\n            warning \"Пожалуйста добавьте изображение лота\"\r\n        }\r\n        if $TypeBargain == 1 {\r\n            if ($OrderMin == \"\") {\r\n                info(\"Минимальная ставка не указана\")\r\n            }\r\n            if ($OrderMax == \"\") {\r\n                info(\"Максимальная ставка не указана\")\r\n            }\r\n            if $OrderMin == Money(0) {\r\n                info(\"Минимальная ставка не указана\")\r\n            }\r\n            if $OrderMax == Money(0) {\r\n                info(\"Максимальная ставка не указана\")\r\n            }\r\n            $OrderMin = Money($OrderMin) * Money(1000000000000000000)\r\n            $OrderMax = Money($OrderMax) * Money(1000000000000000000)\r\n        }\r\n        $Id = Int($Id)\r\n        if !($Action == \"create\" || $Action == \"edit\") {\r\n            warning \"Lot: unknown action\"\r\n        }\r\n        if $Action == \"create\" {\r\n            RoleConditions(\"role\", \"Seller\")\r\n        }else{\r\n            $lot = DBFind(\"lots\").Where(\"id=? and deleted=0\", $Id).Row()\r\n\r\n            if !$lot {\r\n                warning \"Lot not found\"\r\n            }\r\n            if $lot[\"status\"] > 0 {\r\n                warning \"You cannot edit a confirmed lot\"\r\n            }\r\n            if $lot[\"seller\"] != $key_id {\r\n                warning \"You are not owner of the lot\"\r\n            }\r\n\r\n        }\r\n\r\n        $mapLocation = JSONDecode($Location)\r\n        $Location = $mapLocation[\"address\"]\r\n        $Weight = safeFloat($Weight)\r\n        $WeightType = Int($WeightType)\r\n        $Length = safeFloat($Length)\r\n        $Width = safeFloat($Width)\r\n        $Height = safeFloat($Height)\r\n\r\n        if $OrderMin > $OrderMax {\r\n            warning \"Минимальная ставка больше максимальной\"\r\n        }\r\n        $dateStart = Sprintf(\"%v %v\", trimZeroTime($DateStart), $TimeStart)\r\n        $dateEnd = Sprintf(\"%v %v\", trimZeroTime($DateEnd), $TimeEnd)\r\n        $catId = Int(DBFind(\"lots_types\").Where(\"id=?\", $TypeId).One(\"category\"))\r\n    }\r\n\r\n    action {\r\n        var fields string args array id int\r\n        if $TypeBargain == 1 {\r\n            args = appendAll($Name, $Description, $PhotoId, $dateStart, $dateEnd, $AmountStarting, $OrderMin, $OrderMax, 0, $Count, $Weight, $WeightType, $Length, $Width, $Height, $TypeId, $catId, $Location, $Condition, $TypeBargain,$mapLocation)\r\n            fields = \"name,description,photo,date_start,date_end,amount_starting,order_min,order_max,contract_id,unit_count,weight_decimal,weight_type,length_decimal,width_decimal,height_decimal,lots_type_id,category,location,condition,type_bargain,map_location\"\r\n        }\r\n        if $TypeBargain == 2 {\r\n            args = appendAll($Name, $Description, $PhotoId, $dateStart, $dateEnd, $AmountStarting, 0, $Count, $Weight, $WeightType, $Length, $Width, $Height, $TypeId, $catId, $Location, $Condition, $TypeBargain,$mapLocation)\r\n            fields = \"name,description,photo,date_start,date_end,amount_starting,contract_id,unit_count,weight_decimal,weight_type,length_decimal,width_decimal,height_decimal,lots_type_id,category,location,condition,type_bargain,map_location\"\r\n        }\r\n        @1buffer_Manager(\"Action,Key\", \"clean\", \"last_uploaded_image\")\r\n        if $Action == \"create\"{\r\n            fields = Sprintf(\"%v,timestamp date_creation,seller\", fields)\r\n            args = Append(args,$block_time)\r\n            args = Append(args,$key_id)\r\n            id = DBInsert(\"lots\", fields, args...)\r\n            notifyAdmin(id)\r\n            storeHistory(id)\r\n            return\r\n        }\r\n        if $Action == \"edit\"{\r\n            DBUpdate(\"lots\", $Id, fields, args...)\r\n            return\r\n        }\r\n    }\r\n}",
            "Type": "contracts"
        },
        {
            "Name": "lots_Sign",
            "Conditions": "true",
            "Value": "contract lots_Sign {\r\n    data {\r\n        lot_id int\r\n        actions string\r\n        notific_id string \"optional\"\r\n    }\r\n    conditions {\r\n        $notific_id = Int($notific_id)\r\n        $lot = DBFind(\"lots\").Where(\"id=?\", $lot_id).Row()\r\n        if !$lot {\r\n            warning \"Не удается подписать контракт: лот не найден\"\r\n        }\r\n        if $lot[\"status\"] != 3 {\r\n            warning \"Не удается подписать контракт: контракт уже подписан\"\r\n        }\r\n        $user = DBFind(\"keys\").WhereId($key_id).Row()\r\n        $lot = JSONDecode(JSONEncode($lot))\r\n    }\r\n    func storeHistory(id int){\r\n        var vars map\r\n        vars[\"lot_id\"] = $lot_id\r\n        vars[\"actions\"] = $actions\r\n        vars[\"notific_id\"] = $notific_id\r\n        DBInsert(lots_blocks, \"block_id,block_time,txhash,contract_name,contract_params,lot_id\", $block_id, $block_time, $txhash, $this_contract, vars, id)\r\n    }\r\n    action {\r\n        var params map\r\n        params[\"lot_id\"] = $lot_id\r\n\r\n        if $actions == \"buyer_accept\" {\r\n            if $lot[\"buyer\"] == $key_id {\r\n                //info($lot[\"type_bargain\"])\r\n                notifications_Send(\"member_id,sender,text_header,page_name,params_map\", $lot[\"seller\"], 1, \"Покупатель подписал контракт\", \"lots_view_contract\", JSONEncode(params))\r\n                var buyer map\r\n                buyer = DBFind(\"buyers\").Columns(\"id,amount,buyer_id\").Where(\"lot_id=? and buyer_id=? and status != -1\", $lot_id, $lot[\"buyer\"]).Order(\"amount DESC\").Row()\r\n                DBUpdate(\"buyers\", Int(buyer[\"id\"]), \"status\", 1)\r\n                \r\n                DBUpdate(\"keys\", Int($lot[\"seller\"]), \"+amount\", buyer[\"amount\"])\r\n                DBUpdate(\"keys\", Int($lot[\"buyer\"]), \"-amount\", buyer[\"amount\"])\r\n                \r\n                if $lot[\"type_bargain\"] == 2 {\r\n                    DBUpdate(\"keys\", Int(buyer[\"buyer_id\"]), \"-deposit\", buyer[\"amount\"])\r\n                }\r\n                if $lot[\"type_bargain\"] == 1 {\r\n                    var buyers array i int\r\n                    buyers = DBFind(\"buyers\").Columns(\"id,amount,buyer_id\").Where(\"lot_id=?\", $lot_id)\r\n                    while i < Len(buyers) {\r\n                        var buyer map\r\n                        buyer = buyers[i]\r\n                        $dep_check = DBFind(\"dep_user_list\").Where(\"lot_id=$ and member_id=$\",$lot_id,buyer[\"buyer_id\"]).Row()\r\n                        DBUpdate(\"keys\",Int($dep_check[\"member_id\"]),\"-deposit\",$dep_check[\"amount\"])\r\n                        DBUpdate(\"dep_user_list\",Int($dep_check[\"id\"]),\"amount\",0)\r\n                        i = i + 1\r\n                    }\r\n                }\r\n                var contract_hash string\r\n                contract_hash = Sha256($lot[\"contract_text\"])\r\n                $lot[\"contract_text\"] = Sprintf(\"%v \\n Подпись покупателя: %v \\n Дата подписания: %v\", $lot[\"contract_text\"], Sha256($user[\"pub\"]), \" \")\r\n                $lot[\"contract_text\"] = Sprintf(\"%v \\n [%v]\", $lot[\"contract_text\"], contract_hash)\r\n                DBUpdate(\"lots\", $lot_id, \"status,contract_text,contract_hash,buyer_sign,buyer_pub,timestamp date_sign\", 4, $lot[\"contract_text\"], contract_hash, 1, Sha256($user[\"pub\"]), $time)\r\n            }\r\n        }\r\n        if $actions == \"buyer_reject\" {\r\n            if $lot[\"buyer\"] == $key_id {\r\n                if $lot[\"type_bargain\"] == 2 {\r\n                    var buyer map\r\n\t\t\t\t    buyer = DBFind(\"buyers\").Columns(\"id,amount,buyer_id\").Where(\"lot_id=? and buyer_id=? and status != -1\", $lot_id, $lot[\"buyer\"]).Order(\"amount DESC\").Row()\r\n                    DBUpdate(\"keys\", Int(buyer[\"buyer_id\"]), \"-deposit\", buyer[\"amount\"])\r\n                }\r\n                if $lot[\"type_bargain\"] == 1 {\r\n                    var buyer map\r\n                    buyer = DBFind(\"buyers\").Columns(\"id,amount,buyer_id\").Where(\"lot_id=? and buyer_id=? and status != -1\", $lot_id, $lot[\"buyer\"]).Order(\"amount DESC\").Row()\r\n                    DBUpdate(\"buyers\", Int(buyer[\"id\"]), \"status\", -1)\r\n                    \r\n                    $dep_check = DBFind(\"dep_user_list\").Where(\"lot_id=$ and member_id=$\",$lot_id,buyer[\"buyer_id\"]).Row()\r\n                    DBUpdate(\"keys\",Int($dep_check[\"member_id\"]),\"-deposit\",$dep_check[\"amount\"])\r\n                    DBUpdate(\"dep_user_list\",Int($dep_check[\"id\"]),\"amount\",0)\r\n                    lots_Close(\"id\", $lot_id)\r\n                }\r\n            }\r\n        }\r\n        if $actions == \"seller_accept\" {\r\n            if $lot[\"seller\"] == $key_id {\r\n                var contract_text string\r\n                contract_text = Sprintf(\"%v \\n Подпись продавца: %v\", $lot[\"contract_text\"], Sha256($user[\"pub\"]))\r\n                DBUpdate(\"lots\", $lot_id, \"seller_sign,seller_pub,contract_text\", 1, Sha256($user[\"pub\"]), contract_text)\r\n                notifications_Send(\"member_id,sender,text_header,page_name,params_map\", $lot[\"buyer\"], 1, \"Продавец подписал контракт\", \"lots_view_contract\", JSONEncode(params))\r\n            }\r\n        }\r\n        if $actions == \"seller_reject\" {\r\n            if $lot[\"seller\"] == $key_id {\r\n                DBUpdate(\"lots\", $lot_id, \"status\", 5)\r\n            }\r\n            if $lot[\"type_bargain\"] == 2 {\r\n                var buyer map\r\n                buyer = DBFind(\"buyers\").Columns(\"id,amount,buyer_id\").Where(\"lot_id=? and buyer_id=? and status != -1\", $lot_id, $lot[\"buyer\"]).Order(\"amount DESC\").Row()\r\n                DBUpdate(\"keys\", Int(buyer[\"buyer_id\"]), \"-deposit\", buyer[\"amount\"])\r\n            }\r\n            if $lot[\"type_bargain\"] == 1 {\r\n                var buyers array i int\r\n                buyers = DBFind(\"buyers\").Columns(\"id,amount,buyer_id\").Where(\"lot_id=?\", $lot_id)\r\n                while i < Len(buyers) {\r\n                    var buyer map\r\n                    buyer = buyers[i]\r\n                    $dep_check = DBFind(\"dep_user_list\").Where(\"lot_id=$ and member_id=$\",$lot_id,buyer[\"buyer_id\"]).Row()\r\n                    DBUpdate(\"keys\",Int($dep_check[\"member_id\"]),\"-deposit\",$dep_check[\"amount\"])\r\n                    DBUpdate(\"dep_user_list\",Int($dep_check[\"id\"]),\"amount\",0)\r\n                    i = i + 1\r\n                }\r\n            }\r\n        }\r\n        if $notific_id > 0{\r\n            notifications_Close(\"notific_id\", $notific_id)\r\n        }\r\n        storeHistory($lot_id)\r\n    }\r\n}",
            "Type": "contracts"
        },
        {
            "Name": "platform_Acceptance",
            "Conditions": "true",
            "Value": "contract platform_Acceptance {\r\n    data {\r\n        rname string\r\n        member_id int\r\n        notific_id int\r\n    }\r\n    func getMemberInfo(kid int) map {\r\n            var res member map\r\n            member = DBFind(\"members\").Where(\"id=?\", kid).Row()\r\n            if member {\r\n                res[\"member_id\"] = member[\"id\"]\r\n                res[\"member_name\"] = member[\"member_name\"]\r\n                res[\"image_id\"] = member[\"image_id\"]\r\n            }else{\r\n                member = DBFind(\"keys\").Where(\"id=?\", kid).Row()\r\n                if member {\r\n                    res[\"member_id\"] = member[\"id\"]\r\n                    res[\"member_name\"] = IdToAddress(Int(member[\"id\"]))\r\n                    res[\"image_id\"] = 0\r\n                }\r\n            }\r\n            return res\r\n        }\r\n    conditions {\r\n        //actually we should find role from \"string\" and check it's RoleID and then transfer string data to RoleID \"int\"\r\n        $rid = DBFind(\"roles\").Columns(\"id,role_name\").Where(\"role_name=?\", $rname).One(\"id\")\r\n        if $rid != nil {\r\n            Println($rname)\r\n        }\r\n        //check role exist\r\n        $role = DBFind(\"roles\").Columns(\"id,deleted,role_type,role_name,image_id,creator->member_id\").Where(\"id=?\", $rid).Row()\r\n        if !$role {\r\n            warning \"Role not found\"\r\n        }\r\n        //check member_id\r\n        if !DBFind(\"keys\").Where(\"id=?\", $member_id).Row() {\r\n            warning \"Key not found\"\r\n        }\r\n        //check if role not deleted\r\n        if $role[\"deleted\"] == 1 {\r\n            warning \"This role has been deleted. The appointment of members is impossible\"\r\n        }\r\n        //special Rules\r\n        var specialRules map prev_contract string stack array\r\n        stack = JSONDecode(JSONEncode($stack))\r\n        prev_contract = stack[0]\r\n        if Len(stack)>2{\r\n            prev_contract = stack[Len(stack)-2]\r\n        }\r\n        specialRules[\"@1sysparams_AcceptValidator\"] = \"Validator\"\r\n        specialRules[\"@1sysparams_DelegateRefresh\"] = \"Delegate\"\r\n        specialRules[\"@1sysparams_CandidateValidatorRequest\"] = \"Candidate for validators\"\r\n        specialRules[\"@1voting_TemplateRun\"] = \"Investor with voting rights\"\r\n        specialRules[\"@1tokenrefund_Start\"] = \"Investor with voting rights\"\r\n        if specialRules[prev_contract] != $role[\"role_name\"] {\r\n            Roles_CheckAccess(\"rid\", $rid)\r\n        }\r\n    }\r\n    action {\r\n        var role member appointer map\r\n        role[\"id\"] = $role[\"id\"]\r\n        role[\"type\"] = $role[\"role_type\"]\r\n        role[\"name\"] = $role[\"role_name\"]\r\n        role[\"image_id\"] = $role[\"image_id\"]\r\n\r\n        member = getMemberInfo($member_id)\r\n        appointer = getMemberInfo($key_id)\r\n\r\n        DBInsert(\"roles_participants\", \"role,member,appointed,timestamp date_created\", role, member, appointer, $block_time)\r\n        DBUpdate(\"notifications\", $notific_id, \"timestamp date_closed,closed\", $block_time, 1)\r\n        DBUpdate(\"keys\", $member_id, \"amount\", \"1010000000000000000000\")\r\n\r\n        var notific_params map\r\n        notific_params[\"role\"] = $rname\r\n        notifications_Send(\"member_id,sender,icon_name,text_header,text_body,page_name,params_map\", $member_id, 1, \"icon icon-user-follow\", \"Ваша заявка на роль была успешно одобрена\", \"Подробнее\", \"platform_role_success\", notific_params)\r\n    }\r\n}",
            "Type": "contracts"
        },
        {
            "Name": "platform_Decline",
            "Conditions": "true",
            "Value": "contract platform_Decline {\r\n    data {\r\n        rname string\r\n        member_id int\r\n        notific_id int\r\n    }\r\n    conditions {\r\n    }\r\n    action {\r\n        var notific_params map\r\n        notific_params[\"role\"] = $rname\r\n        notifications_Send(\"member_id,sender,icon_name,text_header,text_body,page_name,params_map\", $member_id, 1, \"icon icon-user-follow\", \"Ваша заявка на роль была отклонена\", \"Подробнее\", \"platform_role_fail\", notific_params)\r\n        notifications_Close(\"notific_id\", $notific_id)\r\n    }\r\n}",
            "Type": "contracts"
        },
        {
            "Name": "platform_Singup",
            "Conditions": "true",
            "Value": "contract platform_Singup {\r\n    data {\r\n        member_id int\r\n        name_first string\r\n        name_middle string\r\n        name_last string\r\n        company_name string\r\n        company_position string\r\n        member_name string\r\n        role string\r\n    }\r\n    conditions {\r\n        //if member_name & company & company_position, but not id\r\n        //if DBFind(\"platform_requests\").Columns(\"id\").Where(\"member_name = ? and company_name = ? and company_position = ?\", $member_name, $company_name, $company_position).One(\"id\"){\r\n            //warning Sprintf(\"Request from  %v already exists\", $member_name)\r\n        //}\r\n        //?????\r\n    }\r\n    action {\r\n        DBInsert(\"platform_requests\", \"member_id,name_first,name_middle,name_last,company_name,company_position,member_name,role,status\", $member_id, $name_first, $name_middle, $name_last, $company_name, $company_position, $member_name, $role, 0)\r\n    }\r\n}",
            "Type": "contracts"
        }
    ]
}