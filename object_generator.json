{
    "name": "Object generator",
    "data": [
        {
            "Conditions": "ContractAccess(\"@1EditMenu\")",
            "Value": "MenuItem(Title: Og objects, Page: og_objects, Icon:fa fa-list-ul)",
            "Name": "default_menu",
            "Type": "menu"
        },
        {
            "Name": "og_attributes",
            "Trans": "{\"en\":\"Attributes\"}",
            "Type": "languages"
        },
        {
            "Name": "og_back",
            "Trans": "{\"en\":\"Back\",\"ru\":\"Назад\"}",
            "Type": "languages"
        },
        {
            "Name": "og_creator_roles",
            "Trans": "{\"en\":\"Creator roles\"}",
            "Type": "languages"
        },
        {
            "Name": "og_data_input",
            "Trans": "{\"en\":\"Data input\",\"ru\":\"Ввод данных\"}",
            "Type": "languages"
        },
        {
            "Name": "og_data_view",
            "Trans": "{\"en\":\"Data view\",\"ru\":\"Просмотр данных\"}",
            "Type": "languages"
        },
        {
            "Name": "og_deleted",
            "Trans": "{\"en\":\"Deleted\"}",
            "Type": "languages"
        },
        {
            "Name": "og_edit",
            "Trans": "{\"en\":\"Edit\",\"ru\":\"Редактировать\"}",
            "Type": "languages"
        },
        {
            "Name": "og_editor_roles",
            "Trans": "{\"en\":\"Editor roles\"}",
            "Type": "languages"
        },
        {
            "Name": "og_info",
            "Trans": "{\"en\":\"Info\"}",
            "Type": "languages"
        },
        {
            "Name": "og_item_not_found",
            "Trans": "{\"en\":\"Item not found\",\"ru\":\"Объект не найден\"}",
            "Type": "languages"
        },
        {
            "Name": "og_object_edit",
            "Trans": "{\"en\":\"Og object edit\"}",
            "Type": "languages"
        },
        {
            "Name": "og_object_view",
            "Trans": "{\"en\":\"Og object view\"}",
            "Type": "languages"
        },
        {
            "Name": "og_objects",
            "Trans": "{\"en\":\"Og objects\"}",
            "Type": "languages"
        },
        {
            "Name": "og_save",
            "Trans": "{\"en\":\"Save\",\"ru\":\"Сохранить\"}",
            "Type": "languages"
        },
        {
            "Name": "og_statuses",
            "Trans": "{\"en\":\"Statuses\"}",
            "Type": "languages"
        },
        {
            "Name": "og_view",
            "Trans": "{\"en\":\"View\",\"ru\":\"Просмотр\"}",
            "Type": "languages"
        },
        {
            "Name": "og_objects",
            "Columns": "[\n    {\n        \"name\": \"deleted\",\n        \"type\": \"number\",\n        \"conditions\": \"true\"\n    },\n    {\n        \"name\": \"info\",\n        \"type\": \"json\",\n        \"conditions\": \"true\"\n    },\n    {\n        \"name\": \"creator_roles\",\n        \"type\": \"json\",\n        \"conditions\": \"true\"\n    },\n    {\n        \"name\": \"editor_roles\",\n        \"type\": \"json\",\n        \"conditions\": \"true\"\n    },\n    {\n        \"name\": \"statuses\",\n        \"type\": \"json\",\n        \"conditions\": \"true\"\n    },\n    {\n        \"name\": \"attributes\",\n        \"type\": \"json\",\n        \"conditions\": \"true\"\n    }\n]",
            "Permissions": "{\"insert\":\"true\",\"update\":\"true\",\"new_column\":\"true\"}",
            "Type": "tables"
        },
        {
            "Conditions": "true",
            "Value": "DBFind(applications).Columns(\"id\").Where(\"name='Object generator' AND deleted=0\").Vars(application)\r\nSetVar(title,$og_create$).(btn_title,$og_create$).(item_creator_roles,).(item_info,).(item_deleted,).(item_statuses,).(item_attributes,).(item_editor_roles,)\r\nIf(GetVar(Id)){\r\n    DBFind(og_objects).Where(\"id=#Id#\").Vars(item)\r\n    SetVar(title,$og_edit$ ##Id#).(btn_title,$og_save$)\r\n}\r\nSetTitle(#title#)\r\nDiv(content-wrapper){\r\n    Div(breadcrumb){\r\n        LinkPage(Body: $og_objects$, Page: og_objects)\r\n        Span(/, mh)\r\n        Span(#title#, text-muted)\r\n    }\r\n    Div(row){\r\n        Div(col-sm-8 col-sm-offset-2 col-lg-6 col-lg-offset-3){\r\n            Form(panel panel-primary){\r\n                Div(panel-heading){\r\n                    LangRes(og_data_input)\r\n                }\r\n                Div(panel-body){\r\n                    If(GetVar(Id)){\r\n                        Input(Name: Id, Type:hidden, Value: #Id#)\r\n                    }\r\n                    Div(row mt-sm){\r\n                        Div(col-sm-4 mt-sm text-right){\r\n                            LangRes(og_creator_roles)\r\n                        }\r\n                        Div(col-sm-8 text-left){\r\n                            Input(Name: CreatorRoles, Type:textarea, Value: #item_creator_roles#)\r\n                        }\r\n                    }\r\n                    Div(row mt-sm){\r\n                        Div(col-sm-4 mt-sm text-right){\r\n                            LangRes(og_info)\r\n                        }\r\n                        Div(col-sm-8 text-left){\r\n                            Input(Name: Info, Type:textarea, Value: #item_info#)\r\n                        }\r\n                    }\r\n                    Div(row mt-sm){\r\n                        Div(col-sm-4 mt-sm text-right){\r\n                            LangRes(og_deleted)\r\n                        }\r\n                        Div(col-sm-8 text-left){\r\n                            Input(Name: Deleted, Type:number, Value: #item_deleted#)\r\n                        }\r\n                    }\r\n                    Div(row mt-sm){\r\n                        Div(col-sm-4 mt-sm text-right){\r\n                            LangRes(og_statuses)\r\n                        }\r\n                        Div(col-sm-8 text-left){\r\n                            Input(Name: Statuses, Type:textarea, Value: #item_statuses#)\r\n                        }\r\n                    }\r\n                    Div(row mt-sm){\r\n                        Div(col-sm-4 mt-sm text-right){\r\n                            LangRes(og_attributes)\r\n                        }\r\n                        Div(col-sm-8 text-left){\r\n                            Input(Name: Attributes, Type:textarea, Value: #item_attributes#)\r\n                        }\r\n                    }\r\n                    Div(row mt-sm){\r\n                        Div(col-sm-4 mt-sm text-right){\r\n                            LangRes(og_editor_roles)\r\n                        }\r\n                        Div(col-sm-8 text-left){\r\n                            Input(Name: EditorRoles, Type:textarea, Value: #item_editor_roles#)\r\n                        }\r\n                    }\r\n                }\r\n                Div(panel-footer text-right){\r\n                    Button(Body: LangRes(og_back), Page: og_objects, Class: btn btn-default pull-left)\r\n                    Button(Body: #btn_title#, Page: og_objects, Class: btn btn-primary, Contract: OgEdit)\r\n                }\r\n            }\r\n        }\r\n    }\r\n}",
            "Name": "og_object_edit",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Conditions": "true",
            "Value": "\r\nDBFind(applications).Columns(\"id\").Where(\"name='Object generator' AND deleted=0\").Vars(application)\r\nIf(GetVar(Id)){\r\n    DBFind(og_objects).Where(\"id=#Id#\").Vars(item)\r\n}\r\nSetVar(title,$og_view$ ##Id#)\r\nSetTitle(#title#)\r\nDiv(content-wrapper){\r\n    Div(breadcrumb){\r\n        LinkPage(Body: $og_objects$, Page: og_objects)\r\n        Span(/, mh)\r\n        Span(#title#, text-muted)\r\n    }\r\n    If(GetVar(Id)){\r\n        Div(row){\r\n            Div(col-sm-8 col-sm-offset-2 col-lg-6 col-lg-offset-3){\r\n                Div(panel panel-primary){\r\n                    Div(panel-heading){\r\n                        LangRes(og_data_view)\r\n                    }\r\n                    Div(panel-body){\r\n                        Div(row mt-sm){\r\n                            Div(col-sm-4 text-right text-bold){\r\n                                LangRes(og_creator_roles)\r\n                            }\r\n                            Div(col-sm-8 text-left){\r\n                                #item_creator_roles#\r\n                            }\r\n                        }\r\n\r\n                        Div(row mt-sm){\r\n                            Div(col-sm-4 text-right text-bold){\r\n                                LangRes(og_info)\r\n                            }\r\n                            Div(col-sm-8 text-left){\r\n                                #item_info#\r\n                            }\r\n                        }\r\n\r\n                        Div(row mt-sm){\r\n                            Div(col-sm-4 text-right text-bold){\r\n                                LangRes(og_deleted)\r\n                            }\r\n                            Div(col-sm-8 text-left){\r\n                                #item_deleted#\r\n                            }\r\n                        }\r\n\r\n                        Div(row mt-sm){\r\n                            Div(col-sm-4 text-right text-bold){\r\n                                LangRes(og_statuses)\r\n                            }\r\n                            Div(col-sm-8 text-left){\r\n                                #item_statuses#\r\n                            }\r\n                        }\r\n\r\n                        Div(row mt-sm){\r\n                            Div(col-sm-4 text-right text-bold){\r\n                                LangRes(og_attributes)\r\n                            }\r\n                            Div(col-sm-8 text-left){\r\n                                #item_attributes#\r\n                            }\r\n                        }\r\n\r\n                        Div(row mt-sm){\r\n                            Div(col-sm-4 text-right text-bold){\r\n                                LangRes(og_editor_roles)\r\n                            }\r\n                            Div(col-sm-8 text-left){\r\n                                #item_editor_roles#\r\n                            }\r\n                        }\r\n                    }\r\n                    Div(panel-footer text-left){\r\n                        Button(Body: LangRes(og_back), Page: og_objects, Class: btn btn-default)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }.Else{\r\n        Div(h3 text-center){\r\n            LangRes(og_item_not_found)\r\n        }\r\n    }\r\n}",
            "Name": "og_object_view",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Conditions": "true",
            "Value": "DBFind(applications).Columns(\"id\").Where(\"name='Object generator' AND deleted=0\").Vars(application)\r\nSetTitle($og_objects$)\r\nSetVar(page_name,og_objects)\r\nDiv(content-wrapper){\r\n    AddToolButton(Title: Create, Page: og_object_edit, Icon: icon-plus)\r\n\r\n    DBFind(og_objects).Count(count)\r\n    If(#page#>0){\r\n        SetVar(prev_page,Calculate(#page#-1)\r\n    }.Else{\r\n        SetVar(page,0).(prev_page,0)\r\n    }\r\n    SetVar(per_page,25).(off,Calculate(#page#*#per_page#)).(last_page,Calculate(#count#/#per_page#)).(next_page,#last_page#)\r\n    If(#count#>Calculate(#off#+#per_page#)){\r\n        SetVar(next_page,Calculate(#page#+1)\r\n    }\r\n    Div(button-group){\r\n        If(#page#>0){\r\n            Button(Body:\"1\", Class:btn btn-default, Page:#page_name#, PageParams: \"page=0\")\r\n        }.Else{\r\n            Button(Body:\"1\", Class:btn btn-default disabled)\r\n        }\r\n        If(#page#>1){\r\n            Button(Body:Calculate(#prev_page#+1),Class:btn btn-default, Page:#page_name#, PageParams:\"page=#prev_page#\")\r\n        }\r\n        If(And(#page#>0,#page#<#last_page#)){\r\n            Button(Body:Calculate(#page#+1), Class:btn btn-default disabled)\r\n        }\r\n        If(#next_page#<#last_page#){\r\n            Button(Body:Calculate(#next_page#+1),Class:btn btn-default,Page:#page_name#, PageParams:\"page=#next_page#\")\r\n        }\r\n        If(#page#<#last_page#){\r\n            Button(Body:Calculate(#last_page#+1), Class:btn btn-default, Page:#page_name#, PageParams:\"page=#last_page#\")\r\n        }.ElseIf(#last_page#>0){\r\n            Button(Body:Calculate(#last_page#+1), Class:btn btn-default disabled)\r\n        }\r\n    }\r\n    Div(panel panel-primary){\r\n        Div(panel-body){\r\n            Div(table-responsive){\r\n                DBFind(og_objects,src_og_objects).Offset(#off#).Order(id).Custom(_actions){\r\n                    Div(text-right text-nowrap){\r\n                        Button(Class: btn btn-info fa fa-eye mr-sm, Page: og_object_view, PageParams: \"Id=#id#\")\r\n                        Button(Class: btn btn-default fa fa-edit mr-sm, Page: og_object_edit, PageParams: \"Id=#id#\")\r\n                        Button(Class: btn btn-danger fa fa-trash, Page: og_objects, Contract: OgDelete, Params: \"Id=#id#\").Alert($delete_alert$, $yes$, $no$)\r\n                    }\r\n                }\r\n                Table(src_og_objects,\"$og_creator_roles$=creator_roles,$og_info$=info,$og_deleted$=deleted,$og_statuses$=statuses,$og_attributes$=attributes,$og_editor_roles$=editor_roles,=_actions\")\r\n            }\r\n        }\r\n    }\r\n}",
            "Name": "og_objects",
            "Menu": "default_menu",
            "Type": "pages"
        },
        {
            "Conditions": "true",
            "Value": "contract OgDelete {\r\n    data {\r\n        Id int\r\n    }\r\n    conditions {\r\n        if !DBFind(\"og_objects\").Where(\"id=? and deleted=0\", $Id).One(\"id\") {\r\n            warning \"Record not found\"\r\n        }\r\n    }\r\n    action {\r\n        DBUpdate(\"og_objects\", $Id, \"deleted\", $time)\r\n    }\r\n}",
            "Name": "OgDelete",
            "Type": "contracts"
        },
        {
            "Conditions": "true",
            "Value": "contract OgEdit {\r\n    data {\r\n        Id string \"optional\"\r\n        CreatorRoles string\r\n        Info string\r\n        Deleted int\r\n        Statuses string\r\n        Attributes string\r\n        EditorRoles string\r\n    }\r\n    conditions {\r\n        $Id = Int($Id)\r\n        if $Id > 0{\r\n            if !DBFind(\"og_objects\").Where(\"id=?\", $Id).One(\"id\") {\r\n                warning \"Record not found\"\r\n            }\r\n        }\r\n    }\r\n    action {\r\n        if $Id > 0{\r\n            DBUpdate(\"og_objects\", $Id, \"creator_roles,info,deleted,statuses,attributes,editor_roles\",$CreatorRoles,$Info,$Deleted,$Statuses,$Attributes,$EditorRoles)\r\n        }else{\r\n            DBInsert(\"og_objects\", \"creator_roles,info,deleted,statuses,attributes,editor_roles\",$CreatorRoles,$Info,$Deleted,$Statuses,$Attributes,$EditorRoles)\r\n        }\r\n    }\r\n}",
            "Name": "OgEdit",
            "Type": "contracts"
        }
    ]
}